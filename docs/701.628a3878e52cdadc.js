"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[701],{7102:(Yt,Ke,R)=>{R.d(Ke,{ST:()=>W0});var v=R(5e3),N=R(4986),g=R(8306),de=R(8996),he=R(9646),U=R(2122),Ie=R(4482),ze=R(5403);function Se(){return(0,Ie.e)((n,e)=>{let t,i=!1;n.subscribe((0,ze.x)(e,r=>{const s=t;t=r,i&&e.next([s,r]),i=!0}))})}var T,ve=R(8675),Ee=R(4004),Te=R(5026),oe=R(1884),me=R(9300),xe=R(2011),Be=R(9808),te=(R(9169),R(3942)),k=R(5861),P=R(9681),W=R(4859),ae=R(1877),Q=R(2090),qe="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},$={},ge=ge||{},re=qe||self;function Mt(){}function Ve(n){var e=typeof n;return"array"==(e="object"!=e?e:n?Array.isArray(n)?"array":e:"null")||"object"==e&&"number"==typeof n.length}function Ut(n){var e=typeof n;return"object"==e&&null!=n||"function"==e}var Pt="closure_uid_"+(1e9*Math.random()>>>0),Vt=0;function Xn(n,e,t){return n.call.apply(n.bind,arguments)}function ei(n,e,t){if(!n)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,i),n.apply(e,r)}}return function(){return n.apply(e,arguments)}}function We(n,e,t){return(We=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Xn:ei).apply(null,arguments)}function Lt(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var i=t.slice();return i.push.apply(i,arguments),n.apply(this,i)}}function Ze(n,e){function t(){}t.prototype=e.prototype,n.X=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.Wb=function(i,r,s){for(var u=Array(arguments.length-2),d=2;d<arguments.length;d++)u[d-2]=arguments[d];return e.prototype[r].apply(i,u)}}function xt(){this.s=this.s,this.o=this.o}xt.prototype.s=!1,xt.prototype.na=function(){!this.s&&(this.s=!0,this.M(),0)&&function Jn(n){Object.prototype.hasOwnProperty.call(n,Pt)&&n[Pt]||(n[Pt]=++Vt)}(this)},xt.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const dt=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if("string"==typeof n)return"string"!=typeof e||1!=e.length?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1};function j(n){const e=n.length;if(0<e){const t=Array(e);for(let i=0;i<e;i++)t[i]=n[i];return t}return[]}function J(n,e){for(let t=1;t<arguments.length;t++){const i=arguments[t];if(Ve(i)){const r=n.length||0,s=i.length||0;n.length=r+s;for(let u=0;u<s;u++)n[r+u]=i[u]}else n.push(i)}}function D(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var S=function(){if(!re.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{re.addEventListener("test",Mt,e),re.removeEventListener("test",Mt,e)}catch(t){}return n}();function z(n){return/^[\s\xa0]*$/.test(n)}var E=String.prototype.trim?function(n){return n.trim()}:function(n){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(n)[1]};function V(n,e){return n<e?-1:n>e?1:0}function ue(){var n=re.navigator;return n&&(n=n.userAgent)?n:""}function be(n){return-1!=ue().indexOf(n)}function $e(n){return $e[" "](n),n}$e[" "]=Mt;var x,n,sn=be("Opera"),on=be("Trident")||be("MSIE"),Le=be("Edge"),an=Le||on,En=be("Gecko")&&!(-1!=ue().toLowerCase().indexOf("webkit")&&!be("Edge"))&&!(be("Trident")||be("MSIE"))&&!be("Edge"),ti=-1!=ue().toLowerCase().indexOf("webkit")&&!be("Edge");function zo(){var n=re.document;return n?n.documentMode:void 0}e:{var F="",b=(n=ue(),En?/rv:([^\);]+)(\)|;)/.exec(n):Le?/Edge\/([\d\.]+)/.exec(n):on?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):ti?/WebKit\/(\S+)/.exec(n):sn?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(b&&(F=b?b[1]:""),on){var I=zo();if(null!=I&&I>parseFloat(F)){x=String(I);break e}}x=F}var Z={};var Zl=re.document&&on&&(zo()||parseInt(x,10))||void 0;function Ci(n,e){if(D.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,i=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(En){e:{try{$e(e.nodeName);var r=!0;break e}catch(s){}r=!1}r||(e=null)}}else"mouseover"==t?e=n.fromElement:"mouseout"==t&&(e=n.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:_r[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&Ci.X.h.call(this)}}Ze(Ci,D);var _r={2:"touch",3:"pen",4:"mouse"};Ci.prototype.h=function(){Ci.X.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var ni="closure_listenable_"+(1e6*Math.random()|0),ql=0;function $o(n,e,t,i,r){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!i,this.ha=r,this.key=++ql,this.ba=this.ea=!1}function ys(n){n.ba=!0,n.listener=null,n.proxy=null,n.src=null,n.ha=null}function Ho(n,e,t){for(const i in n)e.call(t,n[i],i,n)}function Mu(n){const e={};for(const t in n)e[t]=n[t];return e}const vs="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Di(n,e){let t,i;for(let r=1;r<arguments.length;r++){for(t in i=arguments[r],i)n[t]=i[t];for(let s=0;s<vs.length;s++)t=vs[s],Object.prototype.hasOwnProperty.call(i,t)&&(n[t]=i[t])}}function Qt(n){this.src=n,this.g={},this.h=0}function Tn(n,e){var t=e.type;if(t in n.g){var s,i=n.g[t],r=dt(i,e);(s=0<=r)&&Array.prototype.splice.call(i,r,1),s&&(ys(e),0==n.g[t].length&&(delete n.g[t],n.h--))}}function Pu(n,e,t,i){for(var r=0;r<n.length;++r){var s=n[r];if(!s.ba&&s.listener==e&&s.capture==!!t&&s.ha==i)return r}return-1}Qt.prototype.add=function(n,e,t,i,r){var s=n.toString();(n=this.g[s])||(n=this.g[s]=[],this.h++);var u=Pu(n,e,i,r);return-1<u?(e=n[u],t||(e.ea=!1)):((e=new $o(e,this.src,s,!!i,r)).ea=t,n.push(e)),e};var Nn="closure_lm_"+(1e6*Math.random()|0),An={};function ii(n,e,t,i,r){if(i&&i.once)return Is(n,e,t,i,r);if(Array.isArray(e)){for(var s=0;s<e.length;s++)ii(n,e[s],t,i,r);return null}return t=Jo(t),n&&n[ni]?n.N(e,t,Ut(i)?!!i.capture:!!i,r):Yo(n,e,t,!1,i,r)}function Yo(n,e,t,i,r,s){if(!e)throw Error("Invalid event type");var u=Ut(r)?!!r.capture:!!r,d=ws(n);if(d||(n[Nn]=d=new Qt(n)),(t=d.add(e,t,i,u,s)).proxy)return t;if(i=function Lu(){const e=Fu;return function n(t){return e.call(n.src,n.listener,t)}}(),t.proxy=i,i.src=n,i.listener=t,n.addEventListener)S||(r=u),void 0===r&&(r=!1),n.addEventListener(e.toString(),i,r);else if(n.attachEvent)n.attachEvent(Si(e.toString()),i);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(i)}return t}function Is(n,e,t,i,r){if(Array.isArray(e)){for(var s=0;s<e.length;s++)Is(n,e[s],t,i,r);return null}return t=Jo(t),n&&n[ni]?n.O(e,t,Ut(i)?!!i.capture:!!i,r):Yo(n,e,t,!0,i,r)}function Qo(n,e,t,i,r){if(Array.isArray(e))for(var s=0;s<e.length;s++)Qo(n,e[s],t,i,r);else i=Ut(i)?!!i.capture:!!i,t=Jo(t),n&&n[ni]?(n=n.i,(e=String(e).toString())in n.g&&-1<(t=Pu(s=n.g[e],t,i,r))&&(ys(s[t]),Array.prototype.splice.call(s,t,1),0==s.length&&(delete n.g[e],n.h--))):n&&(n=ws(n))&&(e=n.g[e.toString()],n=-1,e&&(n=Pu(e,t,i,r)),(t=-1<n?e[n]:null)&&bs(t))}function bs(n){if("number"!=typeof n&&n&&!n.ba){var e=n.src;if(e&&e[ni])Tn(e.i,n);else{var t=n.type,i=n.proxy;e.removeEventListener?e.removeEventListener(t,i,n.capture):e.detachEvent?e.detachEvent(Si(t),i):e.addListener&&e.removeListener&&e.removeListener(i),(t=ws(e))?(Tn(t,n),0==t.h&&(t.src=null,e[Nn]=null)):ys(n)}}}function Si(n){return n in An?An[n]:An[n]="on"+n}function Fu(n,e){if(n.ba)n=!0;else{e=new Ci(e,this);var t=n.listener,i=n.ha||n.src;n.ea&&bs(n),n=t.call(i,e)}return n}function ws(n){return(n=n[Nn])instanceof Qt?n:null}var Mn="__closure_events_fn_"+(1e9*Math.random()>>>0);function Jo(n){return"function"==typeof n?n:(n[Mn]||(n[Mn]=function(e){return n.handleEvent(e)}),n[Mn])}function ft(){xt.call(this),this.i=new Qt(this),this.P=this,this.I=null}function _t(n,e){var t,i=n.I;if(i)for(t=[];i;i=i.I)t.push(i);if(n=n.P,i=e.type||e,"string"==typeof e)e=new D(e,n);else if(e instanceof D)e.target=e.target||n;else{var r=e;Di(e=new D(i,n),r)}if(r=!0,t)for(var s=t.length-1;0<=s;s--){var u=e.g=t[s];r=yr(u,i,!0,e)&&r}if(r=yr(u=e.g=n,i,!0,e)&&r,r=yr(u,i,!1,e)&&r,t)for(s=0;s<t.length;s++)r=yr(u=e.g=t[s],i,!1,e)&&r}function yr(n,e,t,i){if(!(e=n.i.g[String(e)]))return!0;e=e.concat();for(var r=!0,s=0;s<e.length;++s){var u=e[s];if(u&&!u.ba&&u.capture==t){var d=u.listener,f=u.ha||u.src;u.ea&&Tn(n.i,u),r=!1!==d.call(f,i)&&r}}return r&&!i.defaultPrevented}Ze(ft,xt),ft.prototype[ni]=!0,ft.prototype.removeEventListener=function(n,e,t,i){Qo(this,n,e,t,i)},ft.prototype.M=function(){if(ft.X.M.call(this),this.i){var e,n=this.i;for(e in n.g){for(var t=n.g[e],i=0;i<t.length;i++)ys(t[i]);delete n.g[e],n.h--}}this.I=null},ft.prototype.N=function(n,e,t,i){return this.i.add(String(n),e,!1,t,i)},ft.prototype.O=function(n,e,t,i){return this.i.add(String(n),e,!0,t,i)};var Xo=re.JSON.stringify;function Uu(){var n=Zu;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}var Es,Vu=new class{constructor(n,e){this.i=n,this.j=e,this.h=0,this.g=null}get(){let n;return 0<this.h?(this.h--,n=this.g,this.g=n.next,n.next=null):n=this.i(),n}}(()=>new pt,n=>n.reset());class pt{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function Bu(n){re.setTimeout(()=>{throw n},0)}function ea(n,e){Es||function Wl(){var n=re.Promise.resolve(void 0);Es=function(){n.then(Ri)}}(),Ts||(Es(),Ts=!0),Zu.add(n,e)}var Ts=!1,Zu=new class Gl{constructor(){this.h=this.g=null}add(e,t){const i=Vu.get();i.set(e,t),this.h?this.h.next=i:this.g=i,this.h=i}};function Ri(){for(var n;n=Uu();){try{n.h.call(n.g)}catch(t){Bu(t)}var e=Vu;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}Ts=!1}function vr(n,e){ft.call(this),this.h=n||1,this.g=e||re,this.j=We(this.lb,this),this.l=Date.now()}function Ir(n){n.ca=!1,n.R&&(n.g.clearTimeout(n.R),n.R=null)}function As(n,e,t){if("function"==typeof n)t&&(n=We(n,t));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=We(n.handleEvent,n)}return 2147483647<Number(e)?-1:re.setTimeout(n,e||0)}function xs(n){n.g=As(()=>{n.g=null,n.i&&(n.i=!1,xs(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}Ze(vr,ft),(T=vr.prototype).ca=!1,T.R=null,T.lb=function(){if(this.ca){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-n):(this.R&&(this.g.clearTimeout(this.R),this.R=null),_t(this,"tick"),this.ca&&(Ir(this),this.start()))}},T.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())},T.M=function(){vr.X.M.call(this),Ir(this),delete this.g};class Kl extends xt{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:xs(this)}M(){super.M(),this.g&&(re.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ri(n){xt.call(this),this.h=n,this.g={}}Ze(ri,xt);var qu=[];function ks(n,e,t,i){Array.isArray(t)||(t&&(qu[0]=t.toString()),t=qu);for(var r=0;r<t.length;r++){var s=ii(e,t[r],i||n.handleEvent,!1,n.h||n);if(!s)break;n.g[s.key]=s}}function br(n){Ho(n.g,function(e,t){this.g.hasOwnProperty(t)&&bs(e)},n),n.g={}}function Oi(){this.g=!0}function Ni(n,e,t,i){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+function zl(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var i=t[n];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var u=1;u<r.length;u++)r[u]=""}}}return Xo(t)}catch(d){return e}}(n,t)+(i?" "+i:"")})}ri.prototype.M=function(){ri.X.M.call(this),br(this)},ri.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Oi.prototype.Aa=function(){this.g=!1},Oi.prototype.info=function(){};var xn={},Gu=null;function Mi(){return Gu=Gu||new ft}function Wu(n){D.call(this,xn.Pa,n)}function si(n){const e=Mi();_t(e,new Wu(e))}function Ku(n,e){D.call(this,xn.STAT_EVENT,n),this.stat=e}function yt(n){const e=Mi();_t(e,new Ku(e,n))}function Pi(n,e){D.call(this,xn.Qa,n),this.size=e}function Zt(n,e){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return re.setTimeout(function(){n()},e)}xn.Pa="serverreachability",Ze(Wu,D),xn.STAT_EVENT="statevent",Ze(Ku,D),xn.Qa="timingevent",Ze(Pi,D);var Li={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},ju={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function $t(){}function Cs(){}$t.prototype.h=null;var Tr,wr={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function Er(){D.call(this,"d")}function ia(){D.call(this,"c")}function Ds(){}function Ar(n,e,t,i){this.l=n,this.j=e,this.m=t,this.U=i||1,this.S=new ri(this),this.O=oi,this.T=new vr(n=an?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new Ss}function Ss(){this.i=null,this.g="",this.h=!1}Ze(Er,D),Ze(ia,D),Ze(Ds,$t),Ds.prototype.g=function(){return new XMLHttpRequest},Ds.prototype.i=function(){return{}},Tr=new Ds;var oi=45e3,ra={},Rs={};function ai(n,e,t){n.K=1,n.v=Cr(ln(e)),n.s=t,n.P=!0,$l(n,null)}function $l(n,e){n.F=Date.now(),cn(n),n.A=ln(n.v);var t=n.A,i=n.U;Array.isArray(i)||(i=[String(i)]),da(t.i,"t",i),n.C=0,t=n.l.H,n.h=new Ss,n.g=rh(n.l,t?e:null,!n.s),0<n.N&&(n.L=new Kl(We(n.La,n,n.g),n.N)),ks(n.S,n.g,"readystatechange",n.ib),e=n.H?Mu(n.H):{},n.s?(n.u||(n.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.da(n.A,n.u,n.s,e)):(n.u="GET",n.g.da(n.A,n.u,null,e)),si(),function jl(n,e,t,i,r,s){n.info(function(){if(n.g)if(s)for(var u="",d=s.split("&"),f=0;f<d.length;f++){var m=d[f].split("=");if(1<m.length){var y=m[0];m=m[1];var w=y.split("_");u=2<=w.length&&"type"==w[1]?u+(y+"=")+m+"&":u+(y+"=redacted&")}}else u=null;else u=s;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+e+"\n"+t+"\n"+u})}(n.j,n.u,n.A,n.m,n.U,n.s)}function Os(n){return!!n.g&&"GET"==n.u&&2!=n.K&&n.l.Da}function un(n,e,t){let r,i=!0;for(;!n.I&&n.C<t.length;){if(r=Fi(n,t),r==Rs){4==e&&(n.o=4,yt(14),i=!1),Ni(n.j,n.m,null,"[Incomplete Response]");break}if(r==ra){n.o=4,yt(15),Ni(n.j,n.m,t,"[Invalid Chunk]"),i=!1;break}Ni(n.j,n.m,r,null),Pn(n,r)}Os(n)&&r!=Rs&&r!=ra&&(n.h.g="",n.C=0),4!=e||0!=t.length||n.h.h||(n.o=1,yt(16),i=!1),n.i=n.i&&i,i?0<t.length&&!n.$&&(n.$=!0,(e=n.l).g==n&&e.$&&!e.K&&(e.j.info("Great, no buffering proxy detected. Bytes received: "+t.length),wa(e),e.K=!0,yt(11))):(Ni(n.j,n.m,t,"[Invalid Chunked Response]"),ui(n),Ui(n))}function Fi(n,e){var t=n.C,i=e.indexOf("\n",t);return-1==i?Rs:(t=Number(e.substring(t,i)),isNaN(t)?ra:(i+=1)+t>e.length?Rs:(e=e.substr(i,t),n.C=i+t,e))}function cn(n){n.V=Date.now()+n.O,sa(n,n.O)}function sa(n,e){if(null!=n.B)throw Error("WatchDog timer not null");n.B=Zt(We(n.gb,n),e)}function xr(n){n.B&&(re.clearTimeout(n.B),n.B=null)}function Ui(n){0==n.l.G||n.I||th(n.l,n)}function ui(n){xr(n);var e=n.L;e&&"function"==typeof e.na&&e.na(),n.L=null,Ir(n.T),br(n.S),n.g&&(e=n.g,n.g=null,e.abort(),e.na())}function Pn(n,e){try{var t=n.l;if(0!=t.G&&(t.g==n||Zi(t.h,n)))if(!n.J&&Zi(t.h,n)&&3==t.G){try{var i=t.Fa.g.parse(e)}catch(m){i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0])e:if(t.u)t.Ba=r[1],0<t.Ba-t.T&&37500>r[2]&&t.L&&0==t.A&&!t.v&&(t.v=Zt(We(t.cb,t),6e3));else{if(t.g){if(!(t.g.F+3e3<n.F))break e;Ws(t),Gs(t)}ba(t),yt(18)}if(1>=Us(t.h)&&t.ja){try{t.ja()}catch(m){}t.ja=void 0}}else di(t,11)}else if((n.J||t.g==n)&&Ws(t),!z(e))for(r=t.Fa.g.parse(e),e=0;e<r.length;e++){let m=r[e];if(t.T=m[0],m=m[1],2==t.G)if("c"==m[0]){t.I=m[1],t.ka=m[2];const y=m[3];null!=y&&(t.ma=y,t.j.info("VER="+t.ma));const w=m[4];null!=w&&(t.Ca=w,t.j.info("SVER="+t.Ca));const C=m[5];null!=C&&"number"==typeof C&&0<C&&(t.J=i=1.5*C,t.j.info("backChannelRequestTimeoutMs_="+i)),i=t;const B=n.g;if(B){const G=B.g?B.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(G){var s=i.h;s.g||-1==G.indexOf("spdy")&&-1==G.indexOf("quic")&&-1==G.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(Rr(s,s.h),s.h=null))}if(i.D){const ne=B.g?B.g.getResponseHeader("X-HTTP-Session-Id"):null;ne&&(i.za=ne,He(i.F,i.D,ne))}}t.G=3,t.l&&t.l.xa(),t.$&&(t.P=Date.now()-n.F,t.j.info("Handshake RTT: "+t.P+"ms"));var u=n;if((i=t).sa=ih(i,i.H?i.ka:null,i.V),u.J){Or(i.h,u);var d=u,f=i.J;f&&d.setTimeout(f),d.B&&(xr(d),cn(d)),i.g=u}else oc(i);0<t.i.length&&Lr(t)}else"stop"!=m[0]&&"close"!=m[0]||di(t,7);else 3==t.G&&("stop"==m[0]||"close"==m[0]?"stop"==m[0]?di(t,7):Pr(t):"noop"!=m[0]&&t.l&&t.l.wa(m),t.A=0)}si()}catch(m){}}function oa(n,e){if(n.forEach&&"function"==typeof n.forEach)n.forEach(e,void 0);else if(Ve(n)||"string"==typeof n)Array.prototype.forEach.call(n,e,void 0);else for(var t=function Ns(n){if(n.oa&&"function"==typeof n.oa)return n.oa();if(!n.W||"function"!=typeof n.W){if("undefined"!=typeof Map&&n instanceof Map)return Array.from(n.keys());if(!("undefined"!=typeof Set&&n instanceof Set)){if(Ve(n)||"string"==typeof n){var e=[];n=n.length;for(var t=0;t<n;t++)e.push(t);return e}e=[],t=0;for(const i in n)e[t++]=i;return e}}}(n),i=function Hl(n){if(n.W&&"function"==typeof n.W)return n.W();if("undefined"!=typeof Map&&n instanceof Map||"undefined"!=typeof Set&&n instanceof Set)return Array.from(n.values());if("string"==typeof n)return n.split("");if(Ve(n)){for(var e=[],t=n.length,i=0;i<t;i++)e.push(n[i]);return e}for(i in e=[],t=0,n)e[t++]=n[i];return e}(n),r=i.length,s=0;s<r;s++)e.call(void 0,i[s],t&&t[s],n)}(T=Ar.prototype).setTimeout=function(n){this.O=n},T.ib=function(n){n=n.target;const e=this.L;e&&3==Jt(n)?e.l():this.La(n)},T.La=function(n){try{if(n==this.g)e:{const y=Jt(this.g);var e=this.g.Ea();if(this.g.aa(),!(3>y)&&(3!=y||an||this.g&&(this.h.h||this.g.fa()||nc(this.g)))){this.I||4!=y||7==e||si(),xr(this);var t=this.g.aa();this.Y=t;t:if(Os(this)){var i=nc(this.g);n="";var r=i.length,s=4==Jt(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){ui(this),Ui(this);var u="";break t}this.h.i=new re.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,n+=this.h.i.decode(i[e],{stream:s&&e==r-1});i.splice(0,r),this.h.g+=n,this.C=0,u=this.h.g}else u=this.g.fa();if(this.i=200==t,function ta(n,e,t,i,r,s,u){n.info(function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+e+"\n"+t+"\n"+s+" "+u})}(this.j,this.u,this.A,this.m,this.U,y,t),this.i){if(this.Z&&!this.J){t:{if(this.g){var d,f=this.g;if((d=f.g?f.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!z(d)){var m=d;break t}}m=null}if(!(t=m)){this.i=!1,this.o=3,yt(12),ui(this),Ui(this);break e}Ni(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Pn(this,t)}this.P?(un(this,y,u),an&&this.i&&3==y&&(ks(this.S,this.T,"tick",this.hb),this.T.start())):(Ni(this.j,this.m,u,null),Pn(this,u)),4==y&&ui(this),this.i&&!this.I&&(4==y?th(this.l,this):(this.i=!1,cn(this)))}else 400==t&&0<u.indexOf("Unknown SID")?(this.o=3,yt(12)):(this.o=0,yt(13)),ui(this),Ui(this)}}}catch(y){}},T.hb=function(){if(this.g){var n=Jt(this.g),e=this.g.fa();this.C<e.length&&(xr(this),un(this,n,e),this.i&&4!=n&&cn(this))}},T.cancel=function(){this.I=!0,ui(this)},T.gb=function(){this.B=null;const n=Date.now();0<=n-this.V?(function na(n,e){n.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.K&&(si(),yt(17)),ui(this),this.o=2,Ui(this)):sa(this,this.V-n)};var aa=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function mt(n,e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof mt){this.h=void 0!==e?e:n.h,Ms(this,n.j),this.s=n.s,this.g=n.g,Vi(this,n.m),this.l=n.l,e=n.i;var t=new Bi;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),kr(this,t),this.o=n.o}else n&&(t=String(n).match(aa))?(this.h=!!e,Ms(this,t[1]||"",!0),this.s=Dr(t[2]||""),this.g=Dr(t[3]||"",!0),Vi(this,t[4]),this.l=Dr(t[5]||"",!0),kr(this,t[6]||"",!0),this.o=Dr(t[7]||"")):(this.h=!!e,this.i=new Bi(null,this.h))}function ln(n){return new mt(n)}function Ms(n,e,t){n.j=t?Dr(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function Vi(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function kr(n,e,t){e instanceof Bi?(n.i=e,function Hu(n,e){e&&!n.j&&(hn(n),n.i=null,n.g.forEach(function(t,i){var r=i.toLowerCase();i!=r&&(Sr(this,i),da(this,r,t))},n)),n.j=e}(n.i,n.h)):(t||(e=ci(e,$u)),n.i=new Bi(e,n.h))}function He(n,e,t){n.i.set(e,t)}function Cr(n){return He(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function Dr(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function ci(n,e,t){return"string"==typeof n?(n=encodeURI(n).replace(e,ca),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function ca(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}mt.prototype.toString=function(){var n=[],e=this.j;e&&n.push(ci(e,Ps,!0),":");var t=this.g;return(t||"file"==e)&&(n.push("//"),(e=this.s)&&n.push(ci(e,Ps,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&n.push(":",String(t))),(t=this.l)&&(this.g&&"/"!=t.charAt(0)&&n.push("/"),n.push(ci(t,"/"==t.charAt(0)?la:Ls,!0))),(t=this.i.toString())&&n.push("?",t),(t=this.o)&&n.push("#",ci(t,ha)),n.join("")};var Ps=/[#\/\?@]/g,Ls=/[#\?:]/g,la=/[#\?]/g,$u=/[#\?@]/g,ha=/#/g;function Bi(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function hn(n){n.g||(n.g=new Map,n.h=0,n.i&&function ua(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var i=n[t].indexOf("="),r=null;if(0<=i){var s=n[t].substring(0,i);r=n[t].substring(i+1)}else s=n[t];e(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function Sr(n,e){hn(n),e=Ln(n,e),n.g.has(e)&&(n.i=null,n.h-=n.g.get(e).length,n.g.delete(e))}function Fs(n,e){return hn(n),e=Ln(n,e),n.g.has(e)}function da(n,e,t){Sr(n,e),0<t.length&&(n.i=null,n.g.set(Ln(n,e),j(t)),n.h+=t.length)}function Ln(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function Yu(n){this.l=n||pa,n=re.PerformanceNavigationTiming?0<(n=re.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(re.g&&re.g.Ga&&re.g.Ga()&&re.g.Ga().$b),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(T=Bi.prototype).add=function(n,e){hn(this),this.i=null,n=Ln(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this},T.forEach=function(n,e){hn(this),this.g.forEach(function(t,i){t.forEach(function(r){n.call(e,r,i,this)},this)},this)},T.oa=function(){hn(this);const n=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let i=0;i<e.length;i++){const r=n[i];for(let s=0;s<r.length;s++)t.push(e[i])}return t},T.W=function(n){hn(this);let e=[];if("string"==typeof n)Fs(this,n)&&(e=e.concat(this.g.get(Ln(this,n))));else{n=Array.from(this.g.values());for(let t=0;t<n.length;t++)e=e.concat(n[t])}return e},T.set=function(n,e){return hn(this),this.i=null,Fs(this,n=Ln(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this},T.get=function(n,e){return n&&0<(n=this.W(n)).length?String(n[0]):e},T.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var i=e[t];const s=encodeURIComponent(String(i)),u=this.W(i);for(i=0;i<u.length;i++){var r=s;""!==u[i]&&(r+="="+encodeURIComponent(String(u[i]))),n.push(r)}}return this.i=n.join("&")};var pa=10;function Qu(n){return!!n.h||!!n.g&&n.g.size>=n.j}function Us(n){return n.h?1:n.g?n.g.size:0}function Zi(n,e){return n.h?n.h==e:!!n.g&&n.g.has(e)}function Rr(n,e){n.g?n.g.add(e):n.h=e}function Or(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}function Ju(n){if(null!=n.h)return n.i.concat(n.h.D);if(null!=n.g&&0!==n.g.size){let e=n.i;for(const t of n.g.values())e=e.concat(t.D);return e}return j(n.i)}function Nr(){}function Yl(){this.g=new Nr}function ma(n,e,t){const i=t||"";try{oa(n,function(r,s){let u=r;Ut(r)&&(u=Xo(r)),e.push(i+s+"="+encodeURIComponent(u))})}catch(r){throw e.push(i+"type="+encodeURIComponent("_badmap")),r}}function qi(n,e,t,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch(s){}}function Gi(n){this.l=n.ac||null,this.j=n.jb||!1}function Wi(n,e){ft.call(this),this.D=n,this.u=e,this.m=void 0,this.readyState=ga,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Yu.prototype.cancel=function(){if(this.i=Ju(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}},Nr.prototype.stringify=function(n){return re.JSON.stringify(n,void 0)},Nr.prototype.parse=function(n){return re.JSON.parse(n,void 0)},Ze(Gi,$t),Gi.prototype.g=function(){return new Wi(this.l,this.j)},Gi.prototype.i=function(n){return function(){return n}}({}),Ze(Wi,ft);var ga=0;function Vs(n){n.j.read().then(n.Ta.bind(n)).catch(n.ga.bind(n))}function Mr(n){n.readyState=4,n.l=null,n.j=null,n.A=null,li(n)}function li(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(T=Wi.prototype).open=function(n,e){if(this.readyState!=ga)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,li(this)},T.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.D||re).fetch(new Request(this.B,e)).then(this.Wa.bind(this),this.ga.bind(this))},T.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Mr(this)),this.readyState=ga},T.Wa=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,li(this)),this.g&&(this.readyState=3,li(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if(void 0!==re.ReadableStream&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Vs(this)}else n.text().then(this.Va.bind(this),this.ga.bind(this))},T.Ta=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?Mr(this):li(this),3==this.readyState&&Vs(this)}},T.Va=function(n){this.g&&(this.response=this.responseText=n,Mr(this))},T.Ua=function(n){this.g&&(this.response=n,Mr(this))},T.ga=function(){this.g&&Mr(this)},T.setRequestHeader=function(n,e){this.v.append(n,e)},T.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},T.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)n.push((t=t.value)[0]+": "+t[1]),t=e.next();return n.join("\r\n")},Object.defineProperty(Wi.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var Jl=re.JSON.parse;function nt(n){ft.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Bs,this.K=this.L=!1}Ze(nt,ft);var Bs="",Xl=/^https?$/i,eh=["POST","PUT"];function Xu(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,Zs(n),Ki(n)}function Zs(n){n.D||(n.D=!0,_t(n,"complete"),_t(n,"error"))}function ec(n){if(n.h&&void 0!==ge&&(!n.C[1]||4!=Jt(n)||2!=n.aa()))if(n.v&&4==Jt(n))As(n.Ha,0,n);else if(_t(n,"readystatechange"),4==Jt(n)){n.h=!1;try{const d=n.aa();e:switch(d){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var i;if(i=0===d){var r=String(n.H).match(aa)[1]||null;if(!r&&re.self&&re.self.location){var s=re.self.location.protocol;r=s.substr(0,s.length-1)}i=!Xl.test(r?r.toLowerCase():"")}t=i}if(t)_t(n,"complete"),_t(n,"success");else{n.m=6;try{var u=2<Jt(n)?n.g.statusText:""}catch(f){u=""}n.j=u+" ["+n.aa()+"]",Zs(n)}}finally{Ki(n)}}}function Ki(n,e){if(n.g){tc(n);const t=n.g,i=n.C[0]?Mt:null;n.g=null,n.C=null,e||_t(n,"ready");try{t.onreadystatechange=i}catch(r){}}}function tc(n){n.g&&n.K&&(n.g.ontimeout=null),n.A&&(re.clearTimeout(n.A),n.A=null)}function Jt(n){return n.g?n.g.readyState:0}function nc(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.J){case Bs:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch(e){return null}}function qs(n){let e="";return Ho(n,function(t,i){e+=i,e+=":",e+=t,e+="\r\n"}),e}function ya(n,e,t){e:{for(i in t){var i=!1;break e}i=!0}i||(t=qs(t),"string"==typeof n?null!=t&&encodeURIComponent(String(t)):He(n,e,t))}function hi(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function ic(n){this.Ca=0,this.i=[],this.j=new Oi,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=hi("failFast",!1,n),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=hi("baseRetryDelayMs",5e3,n),this.bb=hi("retryDelaySeedMs",1e4,n),this.$a=hi("forwardChannelMaxRetries",2,n),this.ta=hi("forwardChannelRequestTimeoutMs",2e4,n),this.ra=n&&n.xmlHttpFactory||void 0,this.Da=n&&n.Zb||!1,this.J=void 0,this.H=n&&n.supportsCrossDomainXhr||!1,this.I="",this.h=new Yu(n&&n.concurrentRequestLimit),this.Fa=new Yl,this.O=n&&n.fastHandshake||!1,this.N=n&&n.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=n&&n.Xb||!1,n&&n.Aa&&this.j.Aa(),n&&n.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&n&&n.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}function Pr(n){if(rc(n),3==n.G){var e=n.U++,t=ln(n.F);He(t,"SID",n.I),He(t,"RID",e),He(t,"TYPE","terminate"),dn(n,t),(e=new Ar(n,n.j,e,void 0)).K=2,e.v=Cr(ln(t)),t=!1,re.navigator&&re.navigator.sendBeacon&&(t=re.navigator.sendBeacon(e.v.toString(),"")),!t&&re.Image&&((new Image).src=e.v,t=!0),t||(e.g=rh(e.l,null),e.g.da(e.v)),e.F=Date.now(),cn(e)}nh(n)}function Gs(n){n.g&&(wa(n),n.g.cancel(),n.g=null)}function rc(n){Gs(n),n.u&&(re.clearTimeout(n.u),n.u=null),Ws(n),n.h.cancel(),n.m&&("number"==typeof n.m&&re.clearTimeout(n.m),n.m=null)}function Lr(n){Qu(n.h)||n.m||(n.m=!0,ea(n.Ja,n),n.C=0)}function sc(n,e){var t;t=e?e.m:n.U++;const i=ln(n.F);He(i,"SID",n.I),He(i,"RID",t),He(i,"AID",n.T),dn(n,i),n.o&&n.s&&ya(i,n.o,n.s),t=new Ar(n,n.j,t,n.C+1),null===n.o&&(t.H=n.s),e&&(n.i=e.D.concat(n.i)),e=Ia(n,t,1e3),t.setTimeout(Math.round(.5*n.ta)+Math.round(.5*n.ta*Math.random())),Rr(n.h,t),ai(t,i,e)}function dn(n,e){n.ia&&Ho(n.ia,function(t,i){He(e,i,t)}),n.l&&oa({},function(t,i){He(e,i,t)})}function Ia(n,e,t){t=Math.min(n.i.length,t);var i=n.l?We(n.l.Ra,n.l,n):null;e:{var r=n.i;let s=-1;for(;;){const u=["count="+t];-1==s?0<t?(s=r[0].h,u.push("ofs="+s)):s=0:u.push("ofs="+s);let d=!0;for(let f=0;f<t;f++){let m=r[f].h;const y=r[f].g;if(m-=s,0>m)s=Math.max(0,r[f].h-100),d=!1;else try{ma(y,u,"req"+m+"_")}catch(w){i&&i(y)}}if(d){i=u.join("&");break e}}}return n=n.i.splice(0,t),e.D=n,i}function oc(n){n.g||n.u||(n.Z=1,ea(n.Ia,n),n.A=0)}function ba(n){return!(n.g||n.u||3<=n.A||(n.Z++,n.u=Zt(We(n.Ia,n),uc(n,n.A)),n.A++,0))}function wa(n){null!=n.B&&(re.clearTimeout(n.B),n.B=null)}function ac(n){n.g=new Ar(n,n.j,"rpc",n.Z),null===n.o&&(n.g.H=n.s),n.g.N=0;var e=ln(n.sa);He(e,"RID","rpc"),He(e,"SID",n.I),He(e,"CI",n.L?"0":"1"),He(e,"AID",n.T),He(e,"TYPE","xmlhttp"),dn(n,e),n.o&&n.s&&ya(e,n.o,n.s),n.J&&n.g.setTimeout(n.J);var t=n.g;n=n.ka,t.K=1,t.v=Cr(ln(e)),t.s=null,t.P=!0,$l(t,n)}function Ws(n){null!=n.v&&(re.clearTimeout(n.v),n.v=null)}function th(n,e){var t=null;if(n.g==e){Ws(n),wa(n),n.g=null;var i=2}else{if(!Zi(n.h,e))return;t=e.D,Or(n.h,e),i=1}if(0!=n.G)if(n.pa=e.Y,e.i)if(1==i){t=e.s?e.s.length:0,e=Date.now()-e.F;var r=n.C;_t(i=Mi(),new Pi(i,t)),Lr(n)}else oc(n);else if(3==(r=e.o)||0==r&&0<n.pa||!(1==i&&function va(n,e){return!(Us(n.h)>=n.h.j-(n.m?1:0)||(n.m?(n.i=e.D.concat(n.i),0):1==n.G||2==n.G||n.C>=(n.Za?0:n.$a)||(n.m=Zt(We(n.Ja,n,e),uc(n,n.C)),n.C++,0)))}(n,e)||2==i&&ba(n)))switch(t&&0<t.length&&(e=n.h,e.i=e.i.concat(t)),r){case 1:di(n,5);break;case 4:di(n,10);break;case 3:di(n,6);break;default:di(n,2)}}function uc(n,e){let t=n.Xa+Math.floor(Math.random()*n.bb);return n.l||(t*=2),t*e}function di(n,e){if(n.j.info("Error code "+e),2==e){var t=null;n.l&&(t=null);var i=We(n.kb,n);t||(t=new mt("//www.google.com/images/cleardot.gif"),re.location&&"http"==re.location.protocol||Ms(t,"https"),Cr(t)),function Ql(n,e){const t=new Oi;if(re.Image){const i=new Image;i.onload=Lt(qi,t,i,"TestLoadImage: loaded",!0,e),i.onerror=Lt(qi,t,i,"TestLoadImage: error",!1,e),i.onabort=Lt(qi,t,i,"TestLoadImage: abort",!1,e),i.ontimeout=Lt(qi,t,i,"TestLoadImage: timeout",!1,e),re.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n}else e(!1)}(t.toString(),i)}else yt(2);n.G=0,n.l&&n.l.va(e),nh(n),rc(n)}function nh(n){if(n.G=0,n.la=[],n.l){const e=Ju(n.h);(0!=e.length||0!=n.i.length)&&(J(n.la,e),J(n.la,n.i),n.h.i.length=0,j(n.i),n.i.length=0),n.l.ua()}}function ih(n,e,t){var i=t instanceof mt?ln(t):new mt(t,void 0);if(""!=i.g)e&&(i.g=e+"."+i.g),Vi(i,i.m);else{var r=re.location;i=r.protocol,e=e?e+"."+r.hostname:r.hostname,r=+r.port;var s=new mt(null,void 0);i&&Ms(s,i),e&&(s.g=e),r&&Vi(s,r),t&&(s.l=t),i=s}return e=n.za,(t=n.D)&&e&&He(i,t,e),He(i,"VER",n.ma),dn(n,i),i}function rh(n,e,t){if(e&&!n.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new nt(t&&n.Da&&!n.ra?new Gi({jb:!0}):n.ra)).Ka(n.H),e}function sh(){}function Ea(){if(on&&!(10<=Number(Zl)))throw Error("Environmental error: no available transport.")}function kt(n,e){ft.call(this),this.g=new ic(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(n?n["X-WebChannel-Client-Profile"]=e.ya:n={"X-WebChannel-Client-Profile":e.ya}),this.g.S=n,(n=e&&e.Yb)&&!z(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!z(e)&&(this.g.D=e,null!==(n=this.h)&&e in n&&e in(n=this.h)&&delete n[e]),this.j=new ji(this)}function Fn(n){Er.call(this);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=null!==e&&n in e?e[n]:void 0),this.data=e}else this.data=n}function Ks(){ia.call(this),this.status=1}function ji(n){this.g=n}(T=nt.prototype).Ka=function(n){this.L=n},T.da=function(n,e,t,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+n);e=e?e.toUpperCase():"GET",this.H=n,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Tr.g(),this.C=function zu(n){return n.h||(n.h=n.i())}(this.u?this.u:Tr),this.g.onreadystatechange=We(this.Ha,this);try{this.F=!0,this.g.open(e,String(n),!0),this.F=!1}catch(s){return void Xu(this,s)}if(n=t||"",t=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var r in i)t.set(r,i[r]);else{if("function"!=typeof i.keys||"function"!=typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const s of i.keys())t.set(s,i.get(s))}i=Array.from(t.keys()).find(s=>"content-type"==s.toLowerCase()),r=re.FormData&&n instanceof re.FormData,!(0<=dt(eh,e))||i||r||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,u]of t)this.g.setRequestHeader(s,u);this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{tc(this),0<this.B&&((this.K=function _a(n){return on&&function X(){return function Bt(n){var e=Z;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=n(9)}(function(){let n=0;const e=E(String(x)).split("."),t=E("9").split("."),i=Math.max(e.length,t.length);for(let u=0;0==n&&u<i;u++){var r=e[u]||"",s=t[u]||"";do{if(r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==r[0].length&&0==s[0].length)break;n=V(0==r[1].length?0:parseInt(r[1],10),0==s[1].length?0:parseInt(s[1],10))||V(0==r[2].length,0==s[2].length)||V(r[2],s[2]),r=r[3],s=s[3]}while(0==n)}return 0<=n})}()&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=We(this.qa,this)):this.A=As(this.qa,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(s){Xu(this,s)}},T.qa=function(){void 0!==ge&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,_t(this,"timeout"),this.abort(8))},T.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,_t(this,"complete"),_t(this,"abort"),Ki(this))},T.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Ki(this,!0)),nt.X.M.call(this)},T.Ha=function(){this.s||(this.F||this.v||this.l?ec(this):this.fb())},T.fb=function(){ec(this)},T.aa=function(){try{return 2<Jt(this)?this.g.status:-1}catch(n){return-1}},T.fa=function(){try{return this.g?this.g.responseText:""}catch(n){return""}},T.Sa=function(n){if(this.g){var e=this.g.responseText;return n&&0==e.indexOf(n)&&(e=e.substring(n.length)),Jl(e)}},T.Ea=function(){return this.m},T.Oa=function(){return"string"==typeof this.j?this.j:String(this.j)},(T=ic.prototype).ma=8,T.G=1,T.Ja=function(n){if(this.m)if(this.m=null,1==this.G){if(!n){this.U=Math.floor(1e5*Math.random()),n=this.U++;const r=new Ar(this,this.j,n,void 0);let s=this.s;if(this.S&&(s?(s=Mu(s),Di(s,this.S)):s=this.S),null!==this.o||this.N||(r.H=s,s=null),this.O)e:{for(var e=0,t=0;t<this.i.length;t++){var i=this.i[t];if(void 0===(i="__data__"in i.g&&"string"==typeof(i=i.g.__data__)?i.length:void 0))break;if(4096<(e+=i)){e=t;break e}if(4096===e||t===this.i.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=Ia(this,r,e),He(t=ln(this.F),"RID",n),He(t,"CVER",22),this.D&&He(t,"X-HTTP-Session-Id",this.D),dn(this,t),s&&(this.N?e="headers="+encodeURIComponent(String(qs(s)))+"&"+e:this.o&&ya(t,this.o,s)),Rr(this.h,r),this.Ya&&He(t,"TYPE","init"),this.O?(He(t,"$req",e),He(t,"SID","null"),r.Z=!0,ai(r,t,null)):ai(r,t,e),this.G=2}}else 3==this.G&&(n?sc(this,n):0==this.i.length||Qu(this.h)||sc(this))},T.Ia=function(){if(this.u=null,ac(this),this.$&&!(this.K||null==this.g||0>=this.P)){var n=2*this.P;this.j.info("BP detection timer enabled: "+n),this.B=Zt(We(this.eb,this),n)}},T.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,yt(10),Gs(this),ac(this))},T.cb=function(){null!=this.v&&(this.v=null,Gs(this),ba(this),yt(19))},T.kb=function(n){n?(this.j.info("Successfully pinged google.com"),yt(2)):(this.j.info("Failed to ping google.com"),yt(1))},(T=sh.prototype).xa=function(){},T.wa=function(){},T.va=function(){},T.ua=function(){},T.Ra=function(){},Ea.prototype.g=function(n,e){return new kt(n,e)},Ze(kt,ft),kt.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var n=this.g,e=this.l,t=this.h||void 0;yt(0),n.V=e,n.ia=t||{},n.L=n.Y,n.F=ih(n,null,n.V),Lr(n)},kt.prototype.close=function(){Pr(this.g)},kt.prototype.u=function(n){var e=this.g;if("string"==typeof n){var t={};t.__data__=n,n=t}else this.v&&((t={}).__data__=Xo(n),n=t);e.i.push(new class{constructor(n,e){this.h=n,this.g=e}}(e.ab++,n)),3==e.G&&Lr(e)},kt.prototype.M=function(){this.g.l=null,delete this.j,Pr(this.g),delete this.g,kt.X.M.call(this)},Ze(Fn,Er),Ze(Ks,ia),Ze(ji,sh),ji.prototype.xa=function(){_t(this.g,"a")},ji.prototype.wa=function(n){_t(this.g,new Fn(n))},ji.prototype.va=function(n){_t(this.g,new Ks)},ji.prototype.ua=function(){_t(this.g,"b")},Ea.prototype.createWebChannel=Ea.prototype.g,kt.prototype.send=kt.prototype.u,kt.prototype.open=kt.prototype.m,kt.prototype.close=kt.prototype.close,Li.NO_ERROR=0,Li.TIMEOUT=8,Li.HTTP_ERROR=6,ju.COMPLETE="complete",Cs.EventType=wr,wr.OPEN="a",wr.CLOSE="b",wr.ERROR="c",wr.MESSAGE="d",ft.prototype.listen=ft.prototype.N,nt.prototype.listenOnce=nt.prototype.O,nt.prototype.getLastError=nt.prototype.Oa,nt.prototype.getLastErrorCode=nt.prototype.Ea,nt.prototype.getStatus=nt.prototype.aa,nt.prototype.getResponseJson=nt.prototype.Sa,nt.prototype.getResponseText=nt.prototype.fa,nt.prototype.send=nt.prototype.da,nt.prototype.setWithCredentials=nt.prototype.Ka;var oh=$.createWebChannelTransport=function(){return new Ea},ah=$.getStatEventTarget=function(){return Mi()},Ta=$.ErrorCode=Li,Aa=$.EventType=ju,xa=$.Event=xn,cc=$.Stat={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20},js=$.FetchXmlHttpFactory=Gi,Fr=$.WebChannel=Cs,uh=$.XhrIo=nt;const lc="@firebase/firestore";class gt{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}gt.UNAUTHENTICATED=new gt(null),gt.GOOGLE_CREDENTIALS=new gt("google-credentials-uid"),gt.FIRST_PARTY=new gt("first-party-uid"),gt.MOCK_USER=new gt("mock-user");let Ur="9.15.0";const Xt=new ae.Yd("@firebase/firestore");function hc(){return Xt.logLevel}function K(n,...e){if(Xt.logLevel<=ae.in.DEBUG){const t=e.map(ka);Xt.debug(`Firestore (${Ur}): ${n}`,...t)}}function ot(n,...e){if(Xt.logLevel<=ae.in.ERROR){const t=e.map(ka);Xt.error(`Firestore (${Ur}): ${n}`,...t)}}function en(n,...e){if(Xt.logLevel<=ae.in.WARN){const t=e.map(ka);Xt.warn(`Firestore (${Ur}): ${n}`,...t)}}function ka(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch(t){return n}}function Y(n="Unexpected state"){const e=`FIRESTORE (${Ur}) INTERNAL ASSERTION FAILED: `+n;throw ot(e),new Error(e)}function le(n,e){n||Y()}function ie(n,e){return n}const M={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class q extends Q.ZR{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class lt{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class Da{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class ch{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(gt.UNAUTHENTICATED))}shutdown(){}}class zs{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class dc{constructor(e){this.t=e,this.currentUser=gt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var i=this;let r=this.i;const s=m=>this.i!==r?(r=this.i,t(m)):Promise.resolve();let u=new lt;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new lt,e.enqueueRetryable(()=>s(this.currentUser))};const d=()=>{const m=u;e.enqueueRetryable((0,k.Z)(function*(){yield m.promise,yield s(i.currentUser)}))},f=m=>{K("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=m,this.auth.addAuthTokenListener(this.o),d()};this.t.onInit(m=>f(m)),setTimeout(()=>{if(!this.auth){const m=this.t.getImmediate({optional:!0});m?f(m):(K("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new lt)}},0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(K("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(le("string"==typeof i.accessToken),new Da(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return le(null===e||"string"==typeof e),new gt(e)}}class Vr{constructor(e,t,i,r){this.h=e,this.l=t,this.m=i,this.g=r,this.type="FirstParty",this.user=gt.FIRST_PARTY,this.p=new Map}I(){return this.g?this.g():(le(!("object"!=typeof this.h||null===this.h||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}get headers(){this.p.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.p.set("Authorization",e),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}class $s{constructor(e,t,i,r){this.h=e,this.l=t,this.m=i,this.g=r}getToken(){return Promise.resolve(new Vr(this.h,this.l,this.m,this.g))}start(e,t){e.enqueueRetryable(()=>t(gt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class fc{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Sa{constructor(e){this.T=e,this.forceRefresh=!1,this.appCheck=null,this.A=null}start(e,t){const i=s=>{null!=s.error&&K("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const u=s.token!==this.A;return this.A=s.token,K("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>i(s))};const r=s=>{K("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.T.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){const s=this.T.getImmediate({optional:!0});s?r(s):K("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(le("string"==typeof t.token),this.A=t.token,new fc(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function Ra(n){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class pc{static R(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let i="";for(;i.length<20;){const r=Ra(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<t&&(i+=e.charAt(r[s]%e.length))}return i}}function we(n,e){return n<e?-1:n>e?1:0}function fi(n,e,t){return n.length===e.length&&n.every((i,r)=>t(i,e[r]))}function mc(n){return n+"\0"}class Qe{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new q(M.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new q(M.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new q(M.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new q(M.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Qe.fromMillis(Date.now())}static fromDate(e){return Qe.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor(1e6*(e-1e3*t));return new Qe(t,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?we(this.nanoseconds,e.nanoseconds):we(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class fe{constructor(e){this.timestamp=e}static fromTimestamp(e){return new fe(e)}static min(){return new fe(new Qe(0,0))}static max(){return new fe(new Qe(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class fn{constructor(e,t,i){void 0===t?t=0:t>e.length&&Y(),void 0===i?i=e.length-t:i>e.length-t&&Y(),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return 0===fn.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof fn?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const s=e.get(r),u=t.get(r);if(s<u)return-1;if(s>u)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Me extends fn{construct(e,t,i){return new Me(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new q(M.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(r=>r.length>0))}return new Me(t)}static emptyPath(){return new Me([])}}const hh=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class it extends fn{construct(e,t,i){return new it(e,t,i)}static isValidIdentifier(e){return hh.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),it.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new it(["__name__"])}static fromServerFormat(e){const t=[];let i="",r=0;const s=()=>{if(0===i.length)throw new q(M.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let u=!1;for(;r<e.length;){const d=e[r];if("\\"===d){if(r+1===e.length)throw new q(M.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[r+1];if("\\"!==f&&"."!==f&&"`"!==f)throw new q(M.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=f,r+=2}else"`"===d?(u=!u,r++):"."!==d||u?(i+=d,r++):(s(),r++)}if(s(),u)throw new q(M.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new it(t)}static emptyPath(){return new it([])}}class ee{constructor(e){this.path=e}static fromPath(e){return new ee(Me.fromString(e))}static fromName(e){return new ee(Me.fromString(e).popFirst(5))}static empty(){return new ee(Me.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Me.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Me.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ee(new Me(e.slice()))}}class Hs{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}}function Ys(n){return n.fields.find(e=>2===e.kind)}function Vn(n){return n.fields.filter(e=>2!==e.kind)}Hs.UNKNOWN_ID=-1;class Qs{constructor(e,t){this.fieldPath=e,this.kind=t}}class Br{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Br(0,Ct.min())}}function gc(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=fe.fromTimestamp(1e9===i?new Qe(t+1,0):new Qe(t,i));return new Ct(r,ee.empty(),e)}function _c(n){return new Ct(n.readTime,n.key,-1)}class Ct{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Ct(fe.min(),ee.empty(),-1)}static max(){return new Ct(fe.max(),ee.empty(),-1)}}function Oa(n,e){let t=n.readTime.compareTo(e.readTime);return 0!==t?t:(t=ee.comparator(n.documentKey,e.documentKey),0!==t?t:we(n.largestBatchId,e.largestBatchId))}const yc="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class vc{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function Bn(n){return Na.apply(this,arguments)}function Na(){return Na=(0,k.Z)(function*(n){if(n.code!==M.FAILED_PRECONDITION||n.message!==yc)throw n;K("LocalStore","Unexpectedly lost primary lease")}),Na.apply(this,arguments)}class O{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Y(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new O((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof O?t:O.resolve(t)}catch(t){return O.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):O.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):O.reject(t)}static resolve(e){return new O((t,i)=>{t(e)})}static reject(e){return new O((t,i)=>{i(e)})}static waitFor(e){return new O((t,i)=>{let r=0,s=0,u=!1;e.forEach(d=>{++r,d.next(()=>{++s,u&&s===r&&t()},f=>i(f))}),u=!0,s===r&&t()})}static or(e){let t=O.resolve(!1);for(const i of e)t=t.next(r=>r?O.resolve(r):i());return t}static forEach(e,t){const i=[];return e.forEach((r,s)=>{i.push(t.call(this,r,s))}),this.waitFor(i)}static mapArray(e,t){return new O((i,r)=>{const s=e.length,u=new Array(s);let d=0;for(let f=0;f<s;f++){const m=f;t(e[m]).next(y=>{u[m]=y,++d,d===s&&i(u)},y=>r(y))}})}static doWhile(e,t){return new O((i,r)=>{const s=()=>{!0===e()?t().next(()=>{s()},r):i()};s()})}}class Xs{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.P=new lt,this.transaction.oncomplete=()=>{this.P.resolve()},this.transaction.onabort=()=>{t.error?this.P.reject(new pi(e,t.error)):this.P.resolve()},this.transaction.onerror=i=>{const r=Pa(i.target.error);this.P.reject(new pi(e,r))}}static open(e,t,i,r){try{return new Xs(t,e.transaction(r,i))}catch(s){throw new pi(t,s)}}get v(){return this.P.promise}abort(e){e&&this.P.reject(e),this.aborted||(K("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}V(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new Ma(t)}}class tn{constructor(e,t,i){this.name=e,this.version=t,this.S=i,12.2===tn.D((0,Q.z$)())&&ot("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return K("SimpleDb","Removing database:",e),mi(window.indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!(0,Q.hl)())return!1;if(tn.N())return!0;const e=(0,Q.z$)(),t=tn.D(e),i=0<t&&t<10,r=tn.k(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||s)}static N(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.O)}static M(e,t){return e.store(t)}static D(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}static k(e){const t=e.match(/Android ([\d.]+)/i),i=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(i)}F(e){var t=this;return(0,k.Z)(function*(){return t.db||(K("SimpleDb","Opening database:",t.name),t.db=yield new Promise((i,r)=>{const s=indexedDB.open(t.name,t.version);s.onsuccess=u=>{i(u.target.result)},s.onblocked=()=>{r(new pi(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=u=>{const d=u.target.error;r("VersionError"===d.name?new q(M.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===d.name?new q(M.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+d):new pi(e,d))},s.onupgradeneeded=u=>{K("SimpleDb",'Database "'+t.name+'" requires upgrade from version:',u.oldVersion),t.S.$(u.target.result,s.transaction,u.oldVersion,t.version).next(()=>{K("SimpleDb","Database upgrade to version "+t.version+" complete")})}})),t.B&&(t.db.onversionchange=i=>t.B(i)),t.db})()}L(e){this.B=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,i,r){var s=this;return(0,k.Z)(function*(){const u="readonly"===t;let d=0;for(;;){++d;try{s.db=yield s.F(e);const f=Xs.open(s.db,e,u?"readonly":"readwrite",i),m=r(f).next(y=>(f.V(),y)).catch(y=>(f.abort(y),O.reject(y))).toPromise();return m.catch(()=>{}),yield f.v,m}catch(f){const m=f,y="FirebaseError"!==m.name&&d<3;if(K("SimpleDb","Transaction failed with error:",m.message,"Retrying:",y),s.close(),!y)return Promise.reject(m)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class fh{constructor(e){this.q=e,this.U=!1,this.K=null}get isDone(){return this.U}get G(){return this.K}set cursor(e){this.q=e}done(){this.U=!0}j(e){this.K=e}delete(){return mi(this.q.delete())}}class pi extends q{constructor(e,t){super(M.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Zn(n){return"IndexedDbTransactionError"===n.name}class Ma{constructor(e){this.store=e}put(e,t){let i;return void 0!==t?(K("SimpleDb","PUT",this.store.name,e,t),i=this.store.put(t,e)):(K("SimpleDb","PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),mi(i)}add(e){return K("SimpleDb","ADD",this.store.name,e,e),mi(this.store.add(e))}get(e){return mi(this.store.get(e)).next(t=>(void 0===t&&(t=null),K("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return K("SimpleDb","DELETE",this.store.name,e),mi(this.store.delete(e))}count(){return K("SimpleDb","COUNT",this.store.name),mi(this.store.count())}W(e,t){const i=this.options(e,t);if(i.index||"function"!=typeof this.store.getAll){const r=this.cursor(i),s=[];return this.H(r,(u,d)=>{s.push(d)}).next(()=>s)}{const r=this.store.getAll(i.range);return new O((s,u)=>{r.onerror=d=>{u(d.target.error)},r.onsuccess=d=>{s(d.target.result)}})}}J(e,t){const i=this.store.getAll(e,null===t?void 0:t);return new O((r,s)=>{i.onerror=u=>{s(u.target.error)},i.onsuccess=u=>{r(u.target.result)}})}Y(e,t){K("SimpleDb","DELETE ALL",this.store.name);const i=this.options(e,t);i.X=!1;const r=this.cursor(i);return this.H(r,(s,u,d)=>d.delete())}Z(e,t){let i;t?i=e:(i={},t=e);const r=this.cursor(i);return this.H(r,t)}tt(e){const t=this.cursor({});return new O((i,r)=>{t.onerror=s=>{const u=Pa(s.target.error);r(u)},t.onsuccess=s=>{const u=s.target.result;u?e(u.primaryKey,u.value).next(d=>{d?u.continue():i()}):i()}})}H(e,t){const i=[];return new O((r,s)=>{e.onerror=u=>{s(u.target.error)},e.onsuccess=u=>{const d=u.target.result;if(!d)return void r();const f=new fh(d),m=t(d.primaryKey,d.value,f);if(m instanceof O){const y=m.catch(w=>(f.done(),O.reject(w)));i.push(y)}f.isDone?r():null===f.G?d.continue():d.continue(f.G)}}).next(()=>O.waitFor(i))}options(e,t){let i;return void 0!==e&&("string"==typeof e?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.X?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function mi(n){return new O((e,t)=>{n.onsuccess=i=>{e(i.target.result)},n.onerror=i=>{const r=Pa(i.target.error);t(r)}})}let eo=!1;function Pa(n){const e=tn.D((0,Q.z$)());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new q("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return eo||(eo=!0,setTimeout(()=>{throw i},0)),i}}return n}class La{constructor(e,t){this.asyncQueue=e,this.et=t,this.task=null}start(){this.nt(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}nt(e){var t=this;K("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,k.Z)(function*(){t.task=null;try{K("IndexBackiller",`Documents written: ${yield t.et.st()}`)}catch(i){Zn(i)?K("IndexBackiller","Ignoring IndexedDB error during index backfill: ",i):yield Bn(i)}yield t.nt(6e4)}))}}class to{constructor(e,t){this.localStore=e,this.persistence=t}st(e=50){var t=this;return(0,k.Z)(function*(){return t.persistence.runTransaction("Backfill Indexes","readwrite-primary",i=>t.it(i,e))})()}it(e,t){const i=new Set;let r=t,s=!0;return O.doWhile(()=>!0===s&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(u=>{if(null!==u&&!i.has(u))return K("IndexBackiller",`Processing collection: ${u}`),this.rt(e,u,r).next(d=>{r-=d,i.add(u)});s=!1})).next(()=>t-r)}rt(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(r=>this.localStore.localDocuments.getNextDocuments(e,t,r,i).next(s=>{const u=s.changes;return this.localStore.indexManager.updateIndexEntries(e,u).next(()=>this.ot(r,s)).next(d=>(K("IndexBackiller",`Updating offset: ${d}`),this.localStore.indexManager.updateCollectionGroup(e,t,d))).next(()=>u.size)}))}ot(e,t){let i=e;return t.changes.forEach((r,s)=>{const u=_c(s);Oa(u,i)>0&&(i=u)}),new Ct(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}let Dt=(()=>{class n{constructor(t,i){this.previousValue=t,i&&(i.sequenceNumberHandler=r=>this.ut(r),this.ct=r=>i.writeSequenceNumber(r))}ut(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ct&&this.ct(t),t}}return n.at=-1,n})();class ph{constructor(e,t,i,r,s,u,d,f){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=u,this.autoDetectLongPolling=d,this.useFetchStreams=f}}class pn{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new pn("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof pn&&e.projectId===this.projectId&&e.database===this.database}}function zi(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function qt(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function no(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Zr(n){return null==n}function qr(n){return 0===n&&1/n==-1/0}function Ic(n){return"number"==typeof n&&Number.isInteger(n)&&!qr(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}class at{constructor(e){this.binaryString=e}static fromBase64String(e){const t=atob(e);return new at(t)}static fromUint8Array(e){const t=function(i){let r="";for(let s=0;s<i.length;++s)r+=String.fromCharCode(i[s]);return r}(e);return new at(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let i=0;i<e.length;i++)t[i]=e.charCodeAt(i);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return we(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}at.EMPTY_BYTE_STRING=new at("");const mh=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function qn(n){if(le(!!n),"string"==typeof n){let e=0;const t=mh.exec(n);if(le(!!t),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Je(n.seconds),nanos:Je(n.nanos)}}function Je(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function gi(n){return"string"==typeof n?at.fromBase64String(n):at.fromUint8Array(n)}function Gr(n){var e,t;return"server_timestamp"===(null===(t=((null===(e=null==n?void 0:n.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function bc(n){const e=n.mapValue.fields.__previous_value__;return Gr(e)?bc(e):e}function _i(n){const e=qn(n.mapValue.fields.__local_write_time__.timestampValue);return new Qe(e.seconds,e.nanos)}const mn={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},io={nullValue:"NULL_VALUE"};function nn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Gr(n)?4:Tc(n)?9007199254740991:10:Y()}function gn(n,e){if(n===e)return!0;const t=nn(n);if(t!==nn(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return _i(n).isEqual(_i(e));case 3:return function(i,r){if("string"==typeof i.timestampValue&&"string"==typeof r.timestampValue&&i.timestampValue.length===r.timestampValue.length)return i.timestampValue===r.timestampValue;const s=qn(i.timestampValue),u=qn(r.timestampValue);return s.seconds===u.seconds&&s.nanos===u.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return r=e,gi(n.bytesValue).isEqual(gi(r.bytesValue));case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,r){return Je(i.geoPointValue.latitude)===Je(r.geoPointValue.latitude)&&Je(i.geoPointValue.longitude)===Je(r.geoPointValue.longitude)}(n,e);case 2:return function(i,r){if("integerValue"in i&&"integerValue"in r)return Je(i.integerValue)===Je(r.integerValue);if("doubleValue"in i&&"doubleValue"in r){const s=Je(i.doubleValue),u=Je(r.doubleValue);return s===u?qr(s)===qr(u):isNaN(s)&&isNaN(u)}return!1}(n,e);case 9:return fi(n.arrayValue.values||[],e.arrayValue.values||[],gn);case 10:return function(i,r){const s=i.mapValue.fields||{},u=r.mapValue.fields||{};if(zi(s)!==zi(u))return!1;for(const d in s)if(s.hasOwnProperty(d)&&(void 0===u[d]||!gn(s[d],u[d])))return!1;return!0}(n,e);default:return Y()}var r}function Wr(n,e){return void 0!==(n.values||[]).find(t=>gn(t,e))}function _n(n,e){if(n===e)return 0;const t=nn(n),i=nn(e);if(t!==i)return we(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return we(n.booleanValue,e.booleanValue);case 2:return function(r,s){const u=Je(r.integerValue||r.doubleValue),d=Je(s.integerValue||s.doubleValue);return u<d?-1:u>d?1:u===d?0:isNaN(u)?isNaN(d)?0:-1:1}(n,e);case 3:return ro(n.timestampValue,e.timestampValue);case 4:return ro(_i(n),_i(e));case 5:return we(n.stringValue,e.stringValue);case 6:return function(r,s){const u=gi(r),d=gi(s);return u.compareTo(d)}(n.bytesValue,e.bytesValue);case 7:return function(r,s){const u=r.split("/"),d=s.split("/");for(let f=0;f<u.length&&f<d.length;f++){const m=we(u[f],d[f]);if(0!==m)return m}return we(u.length,d.length)}(n.referenceValue,e.referenceValue);case 8:return function(r,s){const u=we(Je(r.latitude),Je(s.latitude));return 0!==u?u:we(Je(r.longitude),Je(s.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(r,s){const u=r.values||[],d=s.values||[];for(let f=0;f<u.length&&f<d.length;++f){const m=_n(u[f],d[f]);if(m)return m}return we(u.length,d.length)}(n.arrayValue,e.arrayValue);case 10:return function(r,s){if(r===mn.mapValue&&s===mn.mapValue)return 0;if(r===mn.mapValue)return 1;if(s===mn.mapValue)return-1;const u=r.fields||{},d=Object.keys(u),f=s.fields||{},m=Object.keys(f);d.sort(),m.sort();for(let y=0;y<d.length&&y<m.length;++y){const w=we(d[y],m[y]);if(0!==w)return w;const C=_n(u[d[y]],f[m[y]]);if(0!==C)return C}return we(d.length,m.length)}(n.mapValue,e.mapValue);default:throw Y()}}function ro(n,e){if("string"==typeof n&&"string"==typeof e&&n.length===e.length)return we(n,e);const t=qn(n),i=qn(e),r=we(t.seconds,i.seconds);return 0!==r?r:we(t.nanos,i.nanos)}function Gn(n){return Ua(n)}function Ua(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(i){const r=qn(i);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?gi(n.bytesValue).toBase64():"referenceValue"in n?ee.fromName(n.referenceValue).toString():"geoPointValue"in n?`geo(${(e=n.geoPointValue).latitude},${e.longitude})`:"arrayValue"in n?function(i){let r="[",s=!0;for(const u of i.values||[])s?s=!1:r+=",",r+=Ua(u);return r+"]"}(n.arrayValue):"mapValue"in n?function(i){const r=Object.keys(i.fields||{}).sort();let s="{",u=!0;for(const d of r)u?u=!1:s+=",",s+=`${d}:${Ua(i.fields[d])}`;return s+"}"}(n.mapValue):Y();var e}function kn(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function so(n){return!!n&&"integerValue"in n}function $i(n){return!!n&&"arrayValue"in n}function wc(n){return!!n&&"nullValue"in n}function Ec(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Hi(n){return!!n&&"mapValue"in n}function Kr(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return qt(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=Kr(i)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Kr(n.arrayValue.values[t]);return e}return Object.assign({},n)}function Tc(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}function Va(n){return"nullValue"in n?io:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?kn(pn.empty(),ee.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:Y()}function gh(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?kn(pn.empty(),ee.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?mn:Y()}function Ac(n,e){const t=_n(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function oo(n,e){const t=_n(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class Wn{constructor(e,t){this.position=e,this.inclusive=t}}function ao(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const s=e[r],u=n.position[r];if(i=s.field.isKeyField()?ee.comparator(ee.fromName(u.referenceValue),t.key):_n(u,t.data.field(s.field)),"desc"===s.dir&&(i*=-1),0!==i)break}return i}function jr(n,e){if(null===n)return null===e;if(null===e||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!gn(n.position[t],e.position[t]))return!1;return!0}class uo{}class Re extends uo{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,i):new _h(e,t,i):"array-contains"===t?new vh(e,i):"in"===t?new Wa(e,i):"not-in"===t?new Ih(e,i):"array-contains-any"===t?new ho(e,i):new Re(e,t,i)}static createKeyFieldInFilter(e,t,i){return"in"===t?new yh(e,i):new Ga(e,i)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(_n(t,this.value)):null!==t&&nn(this.value)===nn(t)&&this.matchesComparison(_n(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Y()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class Fe extends uo{constructor(e,t){super(),this.filters=e,this.op=t,this.ht=null}static create(e,t){return new Fe(e,t)}matches(e){return Yi(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.ht||(this.ht=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ht}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.lt(t=>t.isInequality());return null!==e?e.field:null}lt(e){for(const t of this.getFlattenedFilters())if(e(t))return t;return null}}function Yi(n){return"and"===n.op}function co(n){return"or"===n.op}function Ba(n){return Za(n)&&Yi(n)}function Za(n){for(const e of n.filters)if(e instanceof Fe)return!1;return!0}function xc(n){if(n instanceof Re)return n.field.canonicalString()+n.op.toString()+Gn(n.value);{const e=n.filters.map(t=>xc(t)).join(",");return`${n.op}(${e})`}}function qa(n,e){return n instanceof Re?(t=n,(i=e)instanceof Re&&t.op===i.op&&t.field.isEqual(i.field)&&gn(t.value,i.value)):n instanceof Fe?function(t,i){return i instanceof Fe&&t.op===i.op&&t.filters.length===i.filters.length&&t.filters.reduce((r,s,u)=>r&&qa(s,i.filters[u]),!0)}(n,e):void Y();var t,i}function lo(n,e){const t=n.filters.concat(e);return Fe.create(t,n.op)}function kc(n){return n instanceof Re?`${(e=n).field.canonicalString()} ${e.op} ${Gn(e.value)}`:n instanceof Fe?function(e){return e.op.toString()+" {"+e.getFilters().map(kc).join(" ,")+"}"}(n):"Filter";var e}class _h extends Re{constructor(e,t,i){super(e,t,i),this.key=ee.fromName(i.referenceValue)}matches(e){const t=ee.comparator(e.key,this.key);return this.matchesComparison(t)}}class yh extends Re{constructor(e,t){super(e,"in",t),this.keys=Cc(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Ga extends Re{constructor(e,t){super(e,"not-in",t),this.keys=Cc(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Cc(n,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(i=>ee.fromName(i.referenceValue))}class vh extends Re{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return $i(t)&&Wr(t.arrayValue,this.value)}}class Wa extends Re{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Wr(this.value.arrayValue,t)}}class Ih extends Re{constructor(e,t){super(e,"not-in",t)}matches(e){if(Wr(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Wr(this.value.arrayValue,t)}}class ho extends Re{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!$i(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>Wr(this.value.arrayValue,i))}}class Qi{constructor(e,t="asc"){this.field=e,this.dir=t}}function bh(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class rt{constructor(e,t){this.comparator=e,this.root=t||vt.EMPTY}insert(e,t){return new rt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,vt.BLACK,null,null))}remove(e){return new rt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,vt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(0===i)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(0===r)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){const e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new fo(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new fo(this.root,e,this.comparator,!1)}getReverseIterator(){return new fo(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new fo(this.root,e,this.comparator,!0)}}class fo{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class vt{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=null!=i?i:vt.RED,this.left=null!=r?r:vt.EMPTY,this.right=null!=s?s:vt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,s){return new vt(null!=e?e:this.key,null!=t?t:this.value,null!=i?i:this.color,null!=r?r:this.left,null!=s?s:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,i),null):0===s?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return vt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return vt.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,vt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,vt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Y();const e=this.left.check();if(e!==this.right.check())throw Y();return e+(this.isRed()?0:1)}}vt.EMPTY=null,vt.RED=!0,vt.BLACK=!1,vt.EMPTY=new class{constructor(){this.size=0}get key(){throw Y()}get value(){throw Y()}get color(){throw Y()}get left(){throw Y()}get right(){throw Y()}copy(n,e,t,i,r){return this}insert(n,e,t){return new vt(n,e)}remove(n,e){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Ge{constructor(e){this.comparator=e,this.data=new rt(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Dc(this.data.getIterator())}getIteratorFrom(e){return new Dc(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof Ge)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(0!==this.comparator(r,s))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Ge(this.comparator);return t.data=e,t}}class Dc{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Ji(n){return n.hasNext()?n.getNext():void 0}class St{constructor(e){this.fields=e,e.sort(it.comparator)}static empty(){return new St([])}unionWith(e){let t=new Ge(it.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new St(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return fi(this.fields,e.fields,(t,i)=>t.isEqual(i))}}class It{constructor(e){this.value=e}static empty(){return new It({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Hi(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Kr(t)}setAll(e){let t=it.emptyPath(),i={},r=[];e.forEach((u,d)=>{if(!t.isImmediateParentOf(d)){const f=this.getFieldsMap(t);this.applyChanges(f,i,r),i={},r=[],t=d.popLast()}u?i[d.lastSegment()]=Kr(u):r.push(d.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){const t=this.field(e.popLast());Hi(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return gn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];Hi(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){qt(t,(r,s)=>e[r]=s);for(const r of i)delete e[r]}clone(){return new It(Kr(this.value))}}function Sc(n){const e=[];return qt(n.fields,(t,i)=>{const r=new it([t]);if(Hi(i)){const s=Sc(i.mapValue).fields;if(0===s.length)e.push(r);else for(const u of s)e.push(r.child(u))}else e.push(r)}),new St(e)}class Ye{constructor(e,t,i,r,s,u,d){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=u,this.documentState=d}static newInvalidDocument(e){return new Ye(e,0,fe.min(),fe.min(),fe.min(),It.empty(),0)}static newFoundDocument(e,t,i,r){return new Ye(e,1,t,fe.min(),i,r,0)}static newNoDocument(e,t){return new Ye(e,2,t,fe.min(),fe.min(),It.empty(),0)}static newUnknownDocument(e,t){return new Ye(e,3,t,fe.min(),fe.min(),It.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(fe.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=It.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=It.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=fe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Ye&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ye(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class wh{constructor(e,t=null,i=[],r=[],s=null,u=null,d=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=u,this.endAt=d,this.ft=null}}function Ka(n,e=null,t=[],i=[],r=null,s=null,u=null){return new wh(n,e,t,i,r,s,u)}function Kn(n){const e=ie(n);if(null===e.ft){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>xc(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>{return(r=i).field.canonicalString()+r.dir;var r}).join(","),Zr(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>Gn(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>Gn(i)).join(",")),e.ft=t}return e.ft}function zr(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!bh(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!qa(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!jr(n.startAt,e.startAt)&&jr(n.endAt,e.endAt)}function po(n){return ee.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}function mo(n,e){return n.filters.filter(t=>t instanceof Re&&t.field.isEqual(e))}function Rc(n,e,t){let i=io,r=!0;for(const s of mo(n,e)){let u=io,d=!0;switch(s.op){case"<":case"<=":u=Va(s.value);break;case"==":case"in":case">=":u=s.value;break;case">":u=s.value,d=!1;break;case"!=":case"not-in":u=io}Ac({value:i,inclusive:r},{value:u,inclusive:d})<0&&(i=u,r=d)}if(null!==t)for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const u=t.position[s];Ac({value:i,inclusive:r},{value:u,inclusive:t.inclusive})<0&&(i=u,r=t.inclusive);break}return{value:i,inclusive:r}}function go(n,e,t){let i=mn,r=!0;for(const s of mo(n,e)){let u=mn,d=!0;switch(s.op){case">=":case">":u=gh(s.value),d=!1;break;case"==":case"in":case"<=":u=s.value;break;case"<":u=s.value,d=!1;break;case"!=":case"not-in":u=mn}oo({value:i,inclusive:r},{value:u,inclusive:d})>0&&(i=u,r=d)}if(null!==t)for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const u=t.position[s];oo({value:i,inclusive:r},{value:u,inclusive:t.inclusive})>0&&(i=u,r=t.inclusive);break}return{value:i,inclusive:r}}class Cn{constructor(e,t=null,i=[],r=[],s=null,u="F",d=null,f=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=u,this.startAt=d,this.endAt=f,this.dt=null,this._t=null}}function _o(n,e,t,i,r,s,u,d){return new Cn(n,e,t,i,r,s,u,d)}function Xi(n){return new Cn(n)}function ja(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}function za(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function er(n){for(const e of n.filters){const t=e.getFirstInequalityField();if(null!==t)return t}return null}function $a(n){return null!==n.collectionGroup}function jn(n){const e=ie(n);if(null===e.dt){e.dt=[];const t=er(e),i=za(e);if(null!==t&&null===i)t.isKeyField()||e.dt.push(new Qi(t)),e.dt.push(new Qi(it.keyField(),"asc"));else{let r=!1;for(const s of e.explicitOrderBy)e.dt.push(s),s.field.isKeyField()&&(r=!0);if(!r){const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.dt.push(new Qi(it.keyField(),s))}}}return e.dt}function wt(n){const e=ie(n);if(!e._t)if("F"===e.limitType)e._t=Ka(e.path,e.collectionGroup,jn(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const s of jn(e))t.push(new Qi(s.field,"desc"===s.dir?"asc":"desc"));const i=e.endAt?new Wn(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Wn(e.startAt.position,e.startAt.inclusive):null;e._t=Ka(e.path,e.collectionGroup,t,e.filters,e.limit,i,r)}return e._t}function Ha(n,e){e.getFirstInequalityField(),er(n);const t=n.filters.concat([e]);return new Cn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function yo(n,e,t){return new Cn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function $r(n,e){return zr(wt(n),wt(e))&&n.limitType===e.limitType}function Oc(n){return`${Kn(wt(n))}|lt:${n.limitType}`}function Ya(n){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(i=>kc(i)).join(", ")}]`),Zr(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(i=>{return`${(r=i).field.canonicalString()} (${r.dir})`;var r}).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>Gn(i)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>Gn(i)).join(",")),`Target(${t})`}(wt(n))}; limitType=${n.limitType})`}function vo(n,e){return e.isFoundDocument()&&function(t,i){const r=i.key.path;return null!==t.collectionGroup?i.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(r):ee.isDocumentKey(t.path)?t.path.isEqual(r):t.path.isImmediateParentOf(r)}(n,e)&&function(t,i){for(const r of jn(t))if(!r.field.isKeyField()&&null===i.data.field(r.field))return!1;return!0}(n,e)&&function(t,i){for(const r of t.filters)if(!r.matches(i))return!1;return!0}(n,e)&&(i=e,!((t=n).startAt&&!function(r,s,u){const d=ao(r,s,u);return r.inclusive?d<=0:d<0}(t.startAt,jn(t),i)||t.endAt&&!function(r,s,u){const d=ao(r,s,u);return r.inclusive?d>=0:d>0}(t.endAt,jn(t),i)));var t,i}function Nc(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Eh(n){return(e,t)=>{let i=!1;for(const r of jn(n)){const s=yi(r,e,t);if(0!==s)return s;i=i||r.field.isKeyField()}return 0}}function yi(n,e,t){const i=n.field.isKeyField()?ee.comparator(e.key,t.key):function(r,s,u){const d=s.data.field(r),f=u.data.field(r);return null!==d&&null!==f?_n(d,f):Y()}(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Y()}}function Mc(n,e){if(n.wt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:qr(e)?"-0":e}}function Pc(n){return{integerValue:""+n}}function Io(n,e){return Ic(e)?Pc(e):Mc(n,e)}class bo{constructor(){this._=void 0}}function Qa(n,e,t){return n instanceof zn?function(i,r){const s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return r&&(s.fields.__previous_value__=r),{mapValue:s}}(t,e):n instanceof vi?Fc(n,e):n instanceof Dn?Uc(n,e):function(i,r){const s=Lc(i,r),u=Vc(s)+Vc(i.gt);return so(s)&&so(i.gt)?Pc(u):Mc(i.yt,u)}(n,e)}function Th(n,e,t){return n instanceof vi?Fc(n,e):n instanceof Dn?Uc(n,e):t}function Lc(n,e){return n instanceof tr?so(t=e)||(i=t)&&"doubleValue"in i?e:{integerValue:0}:null;var i,t}class zn extends bo{}class vi extends bo{constructor(e){super(),this.elements=e}}function Fc(n,e){const t=Bc(e);for(const i of n.elements)t.some(r=>gn(r,i))||t.push(i);return{arrayValue:{values:t}}}class Dn extends bo{constructor(e){super(),this.elements=e}}function Uc(n,e){let t=Bc(e);for(const i of n.elements)t=t.filter(r=>!gn(r,i));return{arrayValue:{values:t}}}class tr extends bo{constructor(e,t){super(),this.yt=e,this.gt=t}}function Vc(n){return Je(n.integerValue||n.doubleValue)}function Bc(n){return $i(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class Hr{constructor(e,t){this.field=e,this.transform=t}}class Ja{constructor(e,t){this.version=e,this.transformResults=t}}class Xe{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Xe}static exists(e){return new Xe(void 0,e)}static updateTime(e){return new Xe(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function wo(n,e){return void 0!==n.updateTime?e.isFoundDocument()&&e.version.isEqual(n.updateTime):void 0===n.exists||n.exists===e.isFoundDocument()}class nr{}function Eo(n,e){if(!n.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return n.isNoDocument()?new rr(n.key,Xe.none()):new ir(n.key,n.data,Xe.none());{const t=n.data,i=It.empty();let r=new Ge(it.comparator);for(let s of e.fields)if(!r.has(s)){let u=t.field(s);null===u&&s.length>1&&(s=s.popLast(),u=t.field(s)),null===u?i.delete(s):i.set(s,u),r=r.add(s)}return new Sn(n.key,i,new St(r.toArray()),Xe.none())}}function Ah(n,e,t){n instanceof ir?function(i,r,s){const u=i.value.clone(),d=Gc(i.fieldTransforms,r,s.transformResults);u.setAll(d),r.convertToFoundDocument(s.version,u).setHasCommittedMutations()}(n,e,t):n instanceof Sn?function(i,r,s){if(!wo(i.precondition,r))return void r.convertToUnknownDocument(s.version);const u=Gc(i.fieldTransforms,r,s.transformResults),d=r.data;d.setAll(Xa(i)),d.setAll(u),r.convertToFoundDocument(s.version,d).setHasCommittedMutations()}(n,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function Yr(n,e,t,i){return n instanceof ir?function(r,s,u,d){if(!wo(r.precondition,s))return u;const f=r.value.clone(),m=Wc(r.fieldTransforms,d,s);return f.setAll(m),s.convertToFoundDocument(s.version,f).setHasLocalMutations(),null}(n,e,t,i):n instanceof Sn?function(r,s,u,d){if(!wo(r.precondition,s))return u;const f=Wc(r.fieldTransforms,d,s),m=s.data;return m.setAll(Xa(r)),m.setAll(f),s.convertToFoundDocument(s.version,m).setHasLocalMutations(),null===u?null:u.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map(y=>y.field))}(n,e,t,i):(u=t,wo(n.precondition,s=e)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):u);var s,u}function To(n,e){let t=null;for(const i of n.fieldTransforms){const r=e.data.field(i.field),s=Lc(i.transform,r||null);null!=s&&(null===t&&(t=It.empty()),t.set(i.field,s))}return t||null}function qc(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&(i=e.fieldTransforms,!!(void 0===(t=n.fieldTransforms)&&void 0===i||t&&i&&fi(t,i,(r,s)=>function Zc(n,e){return n.field.isEqual(e.field)&&(i=e.transform,(t=n.transform)instanceof vi&&i instanceof vi||t instanceof Dn&&i instanceof Dn?fi(t.elements,i.elements,gn):t instanceof tr&&i instanceof tr?gn(t.gt,i.gt):t instanceof zn&&i instanceof zn);var t,i}(r,s))))&&(0===n.type?n.value.isEqual(e.value):1!==n.type||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask));var t,i}class ir extends nr{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Sn extends nr{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Xa(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}}),e}function Gc(n,e,t){const i=new Map;le(n.length===t.length);for(let r=0;r<t.length;r++){const s=n[r],u=s.transform,d=e.data.field(s.field);i.set(s.field,Th(u,d,t[r]))}return i}function Wc(n,e,t){const i=new Map;for(const r of n){const s=r.transform,u=t.data.field(r.field);i.set(r.field,Qa(s,u,e))}return i}class rr extends nr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class eu extends nr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Qr{constructor(e){this.count=e}}var ut,Ne;function Kc(n){switch(n){default:return Y();case M.CANCELLED:case M.UNKNOWN:case M.DEADLINE_EXCEEDED:case M.RESOURCE_EXHAUSTED:case M.INTERNAL:case M.UNAVAILABLE:case M.UNAUTHENTICATED:return!1;case M.INVALID_ARGUMENT:case M.NOT_FOUND:case M.ALREADY_EXISTS:case M.PERMISSION_DENIED:case M.FAILED_PRECONDITION:case M.ABORTED:case M.OUT_OF_RANGE:case M.UNIMPLEMENTED:case M.DATA_LOSS:return!0}}function jc(n){if(void 0===n)return ot("GRPC error has no .code"),M.UNKNOWN;switch(n){case ut.OK:return M.OK;case ut.CANCELLED:return M.CANCELLED;case ut.UNKNOWN:return M.UNKNOWN;case ut.DEADLINE_EXCEEDED:return M.DEADLINE_EXCEEDED;case ut.RESOURCE_EXHAUSTED:return M.RESOURCE_EXHAUSTED;case ut.INTERNAL:return M.INTERNAL;case ut.UNAVAILABLE:return M.UNAVAILABLE;case ut.UNAUTHENTICATED:return M.UNAUTHENTICATED;case ut.INVALID_ARGUMENT:return M.INVALID_ARGUMENT;case ut.NOT_FOUND:return M.NOT_FOUND;case ut.ALREADY_EXISTS:return M.ALREADY_EXISTS;case ut.PERMISSION_DENIED:return M.PERMISSION_DENIED;case ut.FAILED_PRECONDITION:return M.FAILED_PRECONDITION;case ut.ABORTED:return M.ABORTED;case ut.OUT_OF_RANGE:return M.OUT_OF_RANGE;case ut.UNIMPLEMENTED:return M.UNIMPLEMENTED;case ut.DATA_LOSS:return M.DATA_LOSS;default:return Y()}}(Ne=ut||(ut={}))[Ne.OK=0]="OK",Ne[Ne.CANCELLED=1]="CANCELLED",Ne[Ne.UNKNOWN=2]="UNKNOWN",Ne[Ne.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ne[Ne.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ne[Ne.NOT_FOUND=5]="NOT_FOUND",Ne[Ne.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ne[Ne.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ne[Ne.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ne[Ne.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ne[Ne.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ne[Ne.ABORTED=10]="ABORTED",Ne[Ne.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ne[Ne.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ne[Ne.INTERNAL=13]="INTERNAL",Ne[Ne.UNAVAILABLE=14]="UNAVAILABLE",Ne[Ne.DATA_LOSS=15]="DATA_LOSS";class $n{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(void 0!==i)for(const[r,s]of i)if(this.equalsFn(r,e))return s}has(e){return void 0!==this.get(e)}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(void 0===r)return this.inner[i]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(void 0===i)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return 1===i.length?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){qt(this.inner,(t,i)=>{for(const[r,s]of i)e(r,s)})}isEmpty(){return no(this.inner)}size(){return this.innerSize}}const xh=new rt(ee.comparator);function Rt(){return xh}const Ao=new rt(ee.comparator);function Ii(...n){let e=Ao;for(const t of n)e=e.insert(t.key,t);return e}function tu(n){let e=Ao;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function yn(){return Jr()}function xo(){return Jr()}function Jr(){return new $n(n=>n.toString(),(n,e)=>n.isEqual(e))}const Gt=new rt(ee.comparator),Xr=new Ge(ee.comparator);function Ae(...n){let e=Xr;for(const t of n)e=e.add(t);return e}const kh=new Ge(we);function sr(){return kh}class bi{constructor(e,t,i,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const r=new Map;return r.set(e,es.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new bi(fe.min(),r,sr(),Rt(),Ae())}}class es{constructor(e,t,i,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new es(i,t,Ae(),Ae(),Ae())}}class ts{constructor(e,t,i,r){this.It=e,this.removedTargetIds=t,this.key=i,this.Tt=r}}class zc{constructor(e,t){this.targetId=e,this.Et=t}}class Rn{constructor(e,t,i=at.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}}class nu{constructor(){this.At=0,this.Rt=Hc(),this.bt=at.EMPTY_BYTE_STRING,this.Pt=!1,this.vt=!0}get current(){return this.Pt}get resumeToken(){return this.bt}get Vt(){return 0!==this.At}get St(){return this.vt}Dt(e){e.approximateByteSize()>0&&(this.vt=!0,this.bt=e)}Ct(){let e=Ae(),t=Ae(),i=Ae();return this.Rt.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:Y()}}),new es(this.bt,this.Pt,e,t,i)}xt(){this.vt=!1,this.Rt=Hc()}Nt(e,t){this.vt=!0,this.Rt=this.Rt.insert(e,t)}kt(e){this.vt=!0,this.Rt=this.Rt.remove(e)}Ot(){this.At+=1}Mt(){this.At-=1}Ft(){this.vt=!0,this.Pt=!0}}class Ch{constructor(e){this.$t=e,this.Bt=new Map,this.Lt=Rt(),this.qt=$c(),this.Ut=new Ge(we)}Kt(e){for(const t of e.It)e.Tt&&e.Tt.isFoundDocument()?this.Gt(t,e.Tt):this.Qt(t,e.key,e.Tt);for(const t of e.removedTargetIds)this.Qt(t,e.key,e.Tt)}jt(e){this.forEachTarget(e,t=>{const i=this.Wt(t);switch(e.state){case 0:this.zt(t)&&i.Dt(e.resumeToken);break;case 1:i.Mt(),i.Vt||i.xt(),i.Dt(e.resumeToken);break;case 2:i.Mt(),i.Vt||this.removeTarget(t);break;case 3:this.zt(t)&&(i.Ft(),i.Dt(e.resumeToken));break;case 4:this.zt(t)&&(this.Ht(t),i.Dt(e.resumeToken));break;default:Y()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Bt.forEach((i,r)=>{this.zt(r)&&t(r)})}Jt(e){const t=e.targetId,i=e.Et.count,r=this.Yt(t);if(r){const s=r.target;if(po(s))if(0===i){const u=new ee(s.path);this.Qt(t,u,Ye.newNoDocument(u,fe.min()))}else le(1===i);else this.Xt(t)!==i&&(this.Ht(t),this.Ut=this.Ut.add(t))}}Zt(e){const t=new Map;this.Bt.forEach((s,u)=>{const d=this.Yt(u);if(d){if(s.current&&po(d.target)){const f=new ee(d.target.path);null!==this.Lt.get(f)||this.te(u,f)||this.Qt(u,f,Ye.newNoDocument(f,e))}s.St&&(t.set(u,s.Ct()),s.xt())}});let i=Ae();this.qt.forEach((s,u)=>{let d=!0;u.forEachWhile(f=>{const m=this.Yt(f);return!m||2===m.purpose||(d=!1,!1)}),d&&(i=i.add(s))}),this.Lt.forEach((s,u)=>u.setReadTime(e));const r=new bi(e,t,this.Ut,this.Lt,i);return this.Lt=Rt(),this.qt=$c(),this.Ut=new Ge(we),r}Gt(e,t){if(!this.zt(e))return;const i=this.te(e,t.key)?2:0;this.Wt(e).Nt(t.key,i),this.Lt=this.Lt.insert(t.key,t),this.qt=this.qt.insert(t.key,this.ee(t.key).add(e))}Qt(e,t,i){if(!this.zt(e))return;const r=this.Wt(e);this.te(e,t)?r.Nt(t,1):r.kt(t),this.qt=this.qt.insert(t,this.ee(t).delete(e)),i&&(this.Lt=this.Lt.insert(t,i))}removeTarget(e){this.Bt.delete(e)}Xt(e){const t=this.Wt(e).Ct();return this.$t.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ot(e){this.Wt(e).Ot()}Wt(e){let t=this.Bt.get(e);return t||(t=new nu,this.Bt.set(e,t)),t}ee(e){let t=this.qt.get(e);return t||(t=new Ge(we),this.qt=this.qt.insert(e,t)),t}zt(e){const t=null!==this.Yt(e);return t||K("WatchChangeAggregator","Detected inactive target",e),t}Yt(e){const t=this.Bt.get(e);return t&&t.Vt?null:this.$t.ne(e)}Ht(e){this.Bt.set(e,new nu),this.$t.getRemoteKeysForTarget(e).forEach(t=>{this.Qt(e,t,null)})}te(e,t){return this.$t.getRemoteKeysForTarget(e).has(t)}}function $c(){return new rt(ee.comparator)}function Hc(){return new rt(ee.comparator)}const Yc={asc:"ASCENDING",desc:"DESCENDING"},Ft={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},iu={and:"AND",or:"OR"};class ru{constructor(e,t){this.databaseId=e,this.wt=t}}function or(n,e){return n.wt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function vn(n,e){return n.wt?e.toBase64():e.toUint8Array()}function ns(n,e){return or(n,e.toTimestamp())}function st(n){return le(!!n),fe.fromTimestamp(function(e){const t=qn(e);return new Qe(t.seconds,t.nanos)}(n))}function ko(n,e){return(t=n,new Me(["projects",t.projectId,"databases",t.database])).child("documents").child(e).canonicalString();var t}function Qc(n){const e=Me.fromString(n);return le(uu(e)),e}function wi(n,e){return ko(n.databaseId,e.path)}function In(n,e){const t=Qc(e);if(t.get(1)!==n.databaseId.projectId)throw new q(M.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new q(M.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ee(c(t))}function su(n,e){return ko(n.databaseId,e)}function Jc(n){const e=Qc(n);return 4===e.length?Me.emptyPath():c(e)}function is(n){return new Me(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function c(n){return le(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function o(n,e,t){return{name:wi(n,e),fields:t.value.mapValue.fields}}function a(n,e,t){const i=In(n,e.name),r=st(e.updateTime),s=e.createTime?st(e.createTime):fe.min(),u=new It({mapValue:{fields:e.fields}}),d=Ye.newFoundDocument(i,r,s,u);return t&&d.setHasCommittedMutations(),t?d.setHasCommittedMutations():d}function _(n,e){let t;if(e instanceof ir)t={update:o(n,e.key,e.value)};else if(e instanceof rr)t={delete:wi(n,e.key)};else if(e instanceof Sn)t={update:o(n,e.key,e.data),updateMask:au(e.fieldMask)};else{if(!(e instanceof eu))return Y();t={verify:wi(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>function(r,s){const u=s.transform;if(u instanceof zn)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof vi)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof Dn)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof tr)return{fieldPath:s.field.canonicalString(),increment:u.gt};throw Y()}(0,i))),e.precondition.isNone||(t.currentDocument=void 0!==(r=e.precondition).updateTime?{updateTime:ns(n,r.updateTime)}:void 0!==r.exists?{exists:r.exists}:Y()),t;var r}function A(n,e){const t=e.currentDocument?void 0!==(r=e.currentDocument).updateTime?Xe.updateTime(st(r.updateTime)):void 0!==r.exists?Xe.exists(r.exists):Xe.none():Xe.none(),i=e.updateTransforms?e.updateTransforms.map(r=>function(s,u){let d=null;"setToServerValue"in u?(le("REQUEST_TIME"===u.setToServerValue),d=new zn):"appendMissingElements"in u?d=new vi(u.appendMissingElements.values||[]):"removeAllFromArray"in u?d=new Dn(u.removeAllFromArray.values||[]):"increment"in u?d=new tr(s,u.increment):Y();const f=it.fromServerFormat(u.fieldPath);return new Hr(f,d)}(n,r)):[];var r;if(e.update){const r=In(n,e.update.name),s=new It({mapValue:{fields:e.update.fields}});if(e.updateMask){const u=new St((e.updateMask.fieldPaths||[]).map(m=>it.fromServerFormat(m)));return new Sn(r,s,u,t,i)}return new ir(r,s,t,i)}if(e.delete){const r=In(n,e.delete);return new rr(r,t)}if(e.verify){const r=In(n,e.verify);return new eu(r,t)}return Y()}function H(n,e){return{documents:[su(n,e.path)]}}function se(n,e){const t={structuredQuery:{}},i=e.path;null!==e.collectionGroup?(t.parent=su(n,i),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=su(n,i.popLast()),t.structuredQuery.from=[{collectionId:i.lastSegment()}]);const r=function(f){if(0!==f.length)return ou(Fe.create(f,"and"))}(e.filters);r&&(t.structuredQuery.where=r);const s=function(f){if(0!==f.length)return f.map(m=>{return{field:Hn((y=m).field),direction:rn(y.dir)};var y})}(e.orderBy);s&&(t.structuredQuery.orderBy=s);const u=(m=e.limit,n.wt||Zr(m)?m:{value:m});var m,d,f;return null!==u&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt={before:(d=e.startAt).inclusive,values:d.position}),e.endAt&&(t.structuredQuery.endAt={before:!(f=e.endAt).inclusive,values:f.position}),t}function _e(n){let e=Jc(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){le(1===i);const y=t.from[0];y.allDescendants?r=y.collectionId:e=e.child(y.collectionId)}let s=[];t.where&&(s=function(y){const w=ct(y);return w instanceof Fe&&Ba(w)?w.getFilters():[w]}(t.where));let u=[];t.orderBy&&(u=t.orderBy.map(y=>{return new Qi(Ei((w=y).field),function(C){switch(C){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(w.direction));var w}));let d=null;t.limit&&(d=function(y){let w;return w="object"==typeof y?y.value:y,Zr(w)?null:w}(t.limit));let f=null;var y;t.startAt&&(f=new Wn((y=t.startAt).values||[],!!y.before));let m=null;return t.endAt&&(m=function(y){return new Wn(y.values||[],!y.before)}(t.endAt)),_o(e,r,u,s,d,"F",f,m)}function ct(n){return void 0!==n.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Ei(e.unaryFilter.field);return Re.create(t,"==",{doubleValue:NaN});case"IS_NULL":const i=Ei(e.unaryFilter.field);return Re.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Ei(e.unaryFilter.field);return Re.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=Ei(e.unaryFilter.field);return Re.create(s,"!=",{nullValue:"NULL_VALUE"});default:return Y()}}(n):void 0!==n.fieldFilter?Re.create(Ei((e=n).fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Y()}}(e.fieldFilter.op),e.fieldFilter.value):void 0!==n.compositeFilter?function(e){return Fe.create(e.compositeFilter.filters.map(t=>ct(t)),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return Y()}}(e.compositeFilter.op))}(n):Y();var e}function rn(n){return Yc[n]}function Co(n){return Ft[n]}function Xc(n){return iu[n]}function Hn(n){return{fieldPath:n.canonicalString()}}function Ei(n){return it.fromServerFormat(n.fieldPath)}function ou(n){return n instanceof Re?function(e){if("=="===e.op){if(Ec(e.value))return{unaryFilter:{field:Hn(e.field),op:"IS_NAN"}};if(wc(e.value))return{unaryFilter:{field:Hn(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Ec(e.value))return{unaryFilter:{field:Hn(e.field),op:"IS_NOT_NAN"}};if(wc(e.value))return{unaryFilter:{field:Hn(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Hn(e.field),op:Co(e.op),value:e.value}}}(n):n instanceof Fe?function(e){const t=e.getFilters().map(i=>ou(i));return 1===t.length?t[0]:{compositeFilter:{op:Xc(e.op),filters:t}}}(n):Y()}function au(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function uu(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}function Et(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=lu(e)),e=cu(n.get(t),e);return lu(e)}function cu(n,e){let t=e;const i=n.length;for(let r=0;r<i;r++){const s=n.charAt(r);switch(s){case"\0":t+="\x01\x10";break;case"\x01":t+="\x01\x11";break;default:t+=s}}return t}function lu(n){return n+"\x01\x01"}function bn(n){const e=n.length;if(le(e>=2),2===e)return le("\x01"===n.charAt(0)&&"\x01"===n.charAt(1)),Me.emptyPath();const t=e-2,i=[];let r="";for(let s=0;s<e;){const u=n.indexOf("\x01",s);switch((u<0||u>t)&&Y(),n.charAt(u+1)){case"\x01":const d=n.substring(s,u);let f;0===r.length?f=d:(r+=d,f=r,r=""),i.push(f);break;case"\x10":r+=n.substring(s,u),r+="\0";break;case"\x11":r+=n.substring(s,u+1);break;default:Y()}s=u+2}return new Me(i)}const Do=["userId","batchId"];function So(n,e){return[n,Et(e)]}function Kf(n,e,t){return[n,Et(e),t]}const Ng={},Mg=["prefixPath","collectionGroup","readTime","documentId"],Pg=["prefixPath","collectionGroup","documentId"],Lg=["collectionGroup","readTime","prefixPath","documentId"],Fg=["canonicalId","targetId"],Ug=["targetId","path"],Vg=["path","targetId"],Bg=["collectionId","parent"],Zg=["indexId","uid"],qg=["uid","sequenceNumber"],Gg=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Wg=["indexId","uid","orderedDocumentKey"],Kg=["userId","collectionPath","documentId"],jg=["userId","collectionPath","largestBatchId"],zg=["userId","collectionGroup","largestBatchId"],jf=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],$g=[...jf,"documentOverlays"],zf=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],$f=zf,Hg=[...$f,"indexConfiguration","indexState","indexEntries"];class Dh extends vc{constructor(e,t){super(),this.se=e,this.currentSequenceNumber=t}}function Tt(n,e){const t=ie(n);return tn.M(t.se,e)}class Sh{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&Ah(s,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=Yr(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=Yr(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=xo();return this.mutations.forEach(r=>{const s=e.get(r.key),u=s.overlayedDocument;let d=this.applyToLocalView(u,s.mutatedFields);d=t.has(r.key)?null:d;const f=Eo(u,d);null!==f&&i.set(r.key,f),u.isValidDocument()||u.convertToNoDocument(fe.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Ae())}isEqual(e){return this.batchId===e.batchId&&fi(this.mutations,e.mutations,(t,i)=>qc(t,i))&&fi(this.baseMutations,e.baseMutations,(t,i)=>qc(t,i))}}class Rh{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){le(e.mutations.length===i.length);let r=Gt;const s=e.mutations;for(let u=0;u<s.length;u++)r=r.insert(s[u].key,i[u].version);return new Rh(e,t,i,r)}}class Oh{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class ar{constructor(e,t,i,r,s=fe.min(),u=fe.min(),d=at.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=d}withSequenceNumber(e){return new ar(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new ar(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new ar(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class Hf{constructor(e){this.ie=e}}function Yf(n,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:el(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document={name:wi(r=n.ie,(s=e).key),fields:s.data.value.mapValue.fields,updateTime:or(r,s.version.toTimestamp()),createTime:or(r,s.createTime.toTimestamp())};else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:rs(e.version)};else{if(!e.isUnknownDocument())return Y();i.unknownDocument={path:t.path.toArray(),version:rs(e.version)}}var r,s;return i}function el(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function rs(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function ss(n){const e=new Qe(n.seconds,n.nanoseconds);return fe.fromTimestamp(e)}function os(n,e){const t=(e.baseMutations||[]).map(s=>A(n.ie,s));for(let s=0;s<e.mutations.length-1;++s){const u=e.mutations[s];s+1<e.mutations.length&&void 0!==e.mutations[s+1].transform&&(u.updateTransforms=e.mutations[s+1].transform.fieldTransforms,e.mutations.splice(s+1,1),++s)}const i=e.mutations.map(s=>A(n.ie,s)),r=Qe.fromMillis(e.localWriteTimeMs);return new Sh(e.batchId,r,t,i)}function hu(n){const e=ss(n.readTime),t=void 0!==n.lastLimboFreeSnapshotVersion?ss(n.lastLimboFreeSnapshotVersion):fe.min();let i;var r;return void 0!==n.query.documents?(le(1===(r=n.query).documents.length),i=wt(Xi(Jc(r.documents[0])))):i=wt(_e(n.query)),new ar(i,n.targetId,0,n.lastListenSequenceNumber,e,t,at.fromBase64String(n.resumeToken))}function Qf(n,e){const t=rs(e.snapshotVersion),i=rs(e.lastLimboFreeSnapshotVersion);let r;r=po(e.target)?H(n.ie,e.target):se(n.ie,e.target);const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Kn(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function Nh(n){const e=_e({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?yo(e,e.limit,"L"):e}function Mh(n,e){return new Oh(e.largestBatchId,A(n.ie,e.overlayMutation))}function Jf(n,e){const t=e.path.lastSegment();return[n,Et(e.path.popLast()),t]}function Xf(n,e,t,i){return{indexId:n,uid:e.uid||"",sequenceNumber:t,readTime:rs(i.readTime),documentKey:Et(i.documentKey.path),largestBatchId:i.largestBatchId}}class Qg{getBundleMetadata(e,t){return ep(e).get(t).next(i=>{if(i)return{id:(r=i).bundleId,createTime:ss(r.createTime),version:r.version};var r})}saveBundleMetadata(e,t){return ep(e).put({bundleId:(i=t).id,createTime:rs(st(i.createTime)),version:i.version});var i}getNamedQuery(e,t){return tp(e).get(t).next(i=>{if(i)return{name:(r=i).name,query:Nh(r.bundledQuery),readTime:ss(r.readTime)};var r})}saveNamedQuery(e,t){return tp(e).put({name:(i=t).name,readTime:rs(st(i.readTime)),bundledQuery:i.bundledQuery});var i}}function ep(n){return Tt(n,"bundles")}function tp(n){return Tt(n,"namedQueries")}class tl{constructor(e,t){this.yt=e,this.userId=t}static re(e,t){return new tl(e,t.uid||"")}getOverlay(e,t){return du(e).get(Jf(this.userId,t)).next(i=>i?Mh(this.yt,i):null)}getOverlays(e,t){const i=yn();return O.forEach(t,r=>this.getOverlay(e,r).next(s=>{null!==s&&i.set(r,s)})).next(()=>i)}saveOverlays(e,t,i){const r=[];return i.forEach((s,u)=>{const d=new Oh(t,u);r.push(this.oe(e,d))}),O.waitFor(r)}removeOverlaysForBatchId(e,t,i){const r=new Set;t.forEach(u=>r.add(Et(u.getCollectionPath())));const s=[];return r.forEach(u=>{const d=IDBKeyRange.bound([this.userId,u,i],[this.userId,u,i+1],!1,!0);s.push(du(e).Y("collectionPathOverlayIndex",d))}),O.waitFor(s)}getOverlaysForCollection(e,t,i){const r=yn(),s=Et(t),u=IDBKeyRange.bound([this.userId,s,i],[this.userId,s,Number.POSITIVE_INFINITY],!0);return du(e).W("collectionPathOverlayIndex",u).next(d=>{for(const f of d){const m=Mh(this.yt,f);r.set(m.getKey(),m)}return r})}getOverlaysForCollectionGroup(e,t,i,r){const s=yn();let u;const d=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return du(e).Z({index:"collectionGroupOverlayIndex",range:d},(f,m,y)=>{const w=Mh(this.yt,m);s.size()<r||w.largestBatchId===u?(s.set(w.getKey(),w),u=w.largestBatchId):y.done()}).next(()=>s)}oe(e,t){return du(e).put(function(i,r,s){const[u,d,f]=Jf(r,s.mutation.key);return{userId:r,collectionPath:d,documentId:f,collectionGroup:s.mutation.key.getCollectionGroup(),largestBatchId:s.largestBatchId,overlayMutation:_(i.ie,s.mutation)}}(this.yt,this.userId,t))}}function du(n){return Tt(n,"documentOverlays")}class as{constructor(){}ue(e,t){this.ce(e,t),t.ae()}ce(e,t){if("nullValue"in e)this.he(t,5);else if("booleanValue"in e)this.he(t,10),t.le(e.booleanValue?1:0);else if("integerValue"in e)this.he(t,15),t.le(Je(e.integerValue));else if("doubleValue"in e){const i=Je(e.doubleValue);isNaN(i)?this.he(t,13):(this.he(t,15),qr(i)?t.le(0):t.le(i))}else if("timestampValue"in e){const i=e.timestampValue;this.he(t,20),"string"==typeof i?t.fe(i):(t.fe(`${i.seconds||""}`),t.le(i.nanos||0))}else if("stringValue"in e)this.de(e.stringValue,t),this._e(t);else if("bytesValue"in e)this.he(t,30),t.we(gi(e.bytesValue)),this._e(t);else if("referenceValue"in e)this.me(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.he(t,45),t.le(i.latitude||0),t.le(i.longitude||0)}else"mapValue"in e?Tc(e)?this.he(t,Number.MAX_SAFE_INTEGER):(this.ge(e.mapValue,t),this._e(t)):"arrayValue"in e?(this.ye(e.arrayValue,t),this._e(t)):Y()}de(e,t){this.he(t,25),this.pe(e,t)}pe(e,t){t.fe(e)}ge(e,t){const i=e.fields||{};this.he(t,55);for(const r of Object.keys(i))this.de(r,t),this.ce(i[r],t)}ye(e,t){const i=e.values||[];this.he(t,50);for(const r of i)this.ce(r,t)}me(e,t){this.he(t,37),ee.fromName(e).path.forEach(i=>{this.he(t,60),this.pe(i,t)})}he(e,t){e.le(t)}_e(e){e.le(2)}}function Jg(n){if(0===n)return 8;let e=0;return n>>4==0&&(e+=4,n<<=4),n>>6==0&&(e+=2,n<<=2),n>>7==0&&(e+=1),e}function np(n){const e=64-function(t){let i=0;for(let r=0;r<8;++r){const s=Jg(255&t[r]);if(i+=s,8!==s)break}return i}(n);return Math.ceil(e/8)}as.Ie=new as;class Xg{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Te(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Ee(i.value),i=t.next();this.Ae()}Re(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.be(i.value),i=t.next();this.Pe()}ve(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Ee(i);else if(i<2048)this.Ee(960|i>>>6),this.Ee(128|63&i);else if(t<"\ud800"||"\udbff"<t)this.Ee(480|i>>>12),this.Ee(128|63&i>>>6),this.Ee(128|63&i);else{const r=t.codePointAt(0);this.Ee(240|r>>>18),this.Ee(128|63&r>>>12),this.Ee(128|63&r>>>6),this.Ee(128|63&r)}}this.Ae()}Ve(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.be(i);else if(i<2048)this.be(960|i>>>6),this.be(128|63&i);else if(t<"\ud800"||"\udbff"<t)this.be(480|i>>>12),this.be(128|63&i>>>6),this.be(128|63&i);else{const r=t.codePointAt(0);this.be(240|r>>>18),this.be(128|63&r>>>12),this.be(128|63&r>>>6),this.be(128|63&r)}}this.Pe()}Se(e){const t=this.De(e),i=np(t);this.Ce(1+i),this.buffer[this.position++]=255&i;for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=255&t[r]}xe(e){const t=this.De(e),i=np(t);this.Ce(1+i),this.buffer[this.position++]=~(255&i);for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}Ne(){this.ke(255),this.ke(255)}Oe(){this.Me(255),this.Me(255)}reset(){this.position=0}seed(e){this.Ce(e.length),this.buffer.set(e,this.position),this.position+=e.length}Fe(){return this.buffer.slice(0,this.position)}De(e){const t=function(r){const s=new DataView(new ArrayBuffer(8));return s.setFloat64(0,r,!1),new Uint8Array(s.buffer)}(e),i=0!=(128&t[0]);t[0]^=i?255:128;for(let r=1;r<t.length;++r)t[r]^=i?255:0;return t}Ee(e){const t=255&e;0===t?(this.ke(0),this.ke(255)):255===t?(this.ke(255),this.ke(0)):this.ke(t)}be(e){const t=255&e;0===t?(this.Me(0),this.Me(255)):255===t?(this.Me(255),this.Me(0)):this.Me(e)}Ae(){this.ke(0),this.ke(1)}Pe(){this.Me(0),this.Me(1)}ke(e){this.Ce(1),this.buffer[this.position++]=e}Me(e){this.Ce(1),this.buffer[this.position++]=~e}Ce(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}}class e_{constructor(e){this.$e=e}we(e){this.$e.Te(e)}fe(e){this.$e.ve(e)}le(e){this.$e.Se(e)}ae(){this.$e.Ne()}}class t_{constructor(e){this.$e=e}we(e){this.$e.Re(e)}fe(e){this.$e.Ve(e)}le(e){this.$e.xe(e)}ae(){this.$e.Oe()}}class fu{constructor(){this.$e=new Xg,this.Be=new e_(this.$e),this.Le=new t_(this.$e)}seed(e){this.$e.seed(e)}qe(e){return 0===e?this.Be:this.Le}Fe(){return this.$e.Fe()}reset(){this.$e.reset()}}class us{constructor(e,t,i,r){this.indexId=e,this.documentKey=t,this.arrayValue=i,this.directionalValue=r}Ue(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,i=new Uint8Array(t);return i.set(this.directionalValue,0),t!==e?i.set([0],this.directionalValue.length):++i[i.length-1],new us(this.indexId,this.documentKey,this.arrayValue,i)}}function ur(n,e){let t=n.indexId-e.indexId;return 0!==t?t:(t=ip(n.arrayValue,e.arrayValue),0!==t?t:(t=ip(n.directionalValue,e.directionalValue),0!==t?t:ee.comparator(n.documentKey,e.documentKey)))}function ip(n,e){for(let t=0;t<n.length&&t<e.length;++t){const i=n[t]-e[t];if(0!==i)return i}return n.length-e.length}class n_{constructor(e){this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Ke=e.orderBy,this.Ge=[];for(const t of e.filters){const i=t;i.isInequality()?this.Qe=i:this.Ge.push(i)}}je(e){le(e.collectionGroup===this.collectionId);const t=Ys(e);if(void 0!==t&&!this.We(t))return!1;const i=Vn(e);let r=0,s=0;for(;r<i.length&&this.We(i[r]);++r);if(r===i.length)return!0;if(void 0!==this.Qe){const u=i[r];if(!this.ze(this.Qe,u)||!this.He(this.Ke[s++],u))return!1;++r}for(;r<i.length;++r){const u=i[r];if(s>=this.Ke.length||!this.He(this.Ke[s++],u))return!1}return!0}We(e){for(const t of this.Ge)if(this.ze(t,e))return!0;return!1}ze(e,t){return!(void 0===e||!e.field.isEqual(t.fieldPath))&&2===t.kind==("array-contains"===e.op||"array-contains-any"===e.op)}He(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function rp(n){var e,t;if(le(n instanceof Re||n instanceof Fe),n instanceof Re){if(n instanceof Wa){const r=(null===(t=null===(e=n.value.arrayValue)||void 0===e?void 0:e.values)||void 0===t?void 0:t.map(s=>Re.create(n.field,"==",s)))||[];return Fe.create(r,"or")}return n}const i=n.filters.map(r=>rp(r));return Fe.create(i,n.op)}function i_(n){if(0===n.getFilters().length)return[];const e=Fh(rp(n));return le(sp(e)),Ph(e)||Lh(e)?[e]:e.getFilters()}function Ph(n){return n instanceof Re}function Lh(n){return n instanceof Fe&&Ba(n)}function sp(n){return Ph(n)||Lh(n)||function(e){if(e instanceof Fe&&co(e)){for(const t of e.getFilters())if(!Ph(t)&&!Lh(t))return!1;return!0}return!1}(n)}function Fh(n){if(le(n instanceof Re||n instanceof Fe),n instanceof Re)return n;if(1===n.filters.length)return Fh(n.filters[0]);const e=n.filters.map(i=>Fh(i));let t=Fe.create(e,n.op);return t=nl(t),sp(t)?t:(le(t instanceof Fe),le(Yi(t)),le(t.filters.length>1),t.filters.reduce((i,r)=>Uh(i,r)))}function Uh(n,e){let t;return le(n instanceof Re||n instanceof Fe),le(e instanceof Re||e instanceof Fe),t=n instanceof Re?e instanceof Re?Fe.create([n,e],"and"):op(n,e):e instanceof Re?op(e,n):function(i,r){if(le(i.filters.length>0&&r.filters.length>0),Yi(i)&&Yi(r))return lo(i,r.getFilters());const s=co(i)?i:r,u=co(i)?r:i,d=s.filters.map(f=>Uh(f,u));return Fe.create(d,"or")}(n,e),nl(t)}function op(n,e){if(Yi(e))return lo(e,n.getFilters());{const t=e.filters.map(i=>Uh(n,i));return Fe.create(t,"or")}}function nl(n){if(le(n instanceof Re||n instanceof Fe),n instanceof Re)return n;const e=n.getFilters();if(1===e.length)return nl(e[0]);if(Za(n))return n;const t=e.map(r=>nl(r)),i=[];return t.forEach(r=>{r instanceof Re?i.push(r):r instanceof Fe&&(r.op===n.op?i.push(...r.filters):i.push(r))}),1===i.length?i[0]:Fe.create(i,n.op)}class r_{constructor(){this.Je=new Vh}addToCollectionParentIndex(e,t){return this.Je.add(t),O.resolve()}getCollectionParents(e,t){return O.resolve(this.Je.getEntries(t))}addFieldIndex(e,t){return O.resolve()}deleteFieldIndex(e,t){return O.resolve()}getDocumentsMatchingTarget(e,t){return O.resolve(null)}getIndexType(e,t){return O.resolve(0)}getFieldIndexes(e,t){return O.resolve([])}getNextCollectionGroupToUpdate(e){return O.resolve(null)}getMinOffset(e,t){return O.resolve(Ct.min())}getMinOffsetFromCollectionGroup(e,t){return O.resolve(Ct.min())}updateCollectionGroup(e,t,i){return O.resolve()}updateIndexEntries(e,t){return O.resolve()}}class Vh{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new Ge(Me.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new Ge(Me.comparator)).toArray()}}const il=new Uint8Array(0);class s_{constructor(e,t){this.user=e,this.databaseId=t,this.Ye=new Vh,this.Xe=new $n(i=>Kn(i),(i,r)=>zr(i,r)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Ye.has(t)){const i=t.lastSegment(),r=t.popLast();e.addOnCommittedListener(()=>{this.Ye.add(t)});const s={collectionId:i,parent:Et(r)};return ap(e).put(s)}return O.resolve()}getCollectionParents(e,t){const i=[],r=IDBKeyRange.bound([t,""],[mc(t),""],!1,!0);return ap(e).W(r).next(s=>{for(const u of s){if(u.collectionId!==t)break;i.push(bn(u.parent))}return i})}addFieldIndex(e,t){const i=rl(e),r={indexId:(u=t).indexId,collectionGroup:u.collectionGroup,fields:u.fields.map(d=>[d.fieldPath.canonicalString(),d.kind])};var u;delete r.indexId;const s=i.add(r);if(t.indexState){const u=mu(e);return s.next(d=>{u.put(Xf(d,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const i=rl(e),r=mu(e),s=pu(e);return i.delete(t.indexId).next(()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,t){const i=pu(e);let r=!0;const s=new Map;return O.forEach(this.Ze(t),u=>this.tn(e,u).next(d=>{r&&(r=!!d),s.set(u,d)})).next(()=>{if(r){let u=Ae();const d=[];return O.forEach(s,(f,m)=>{var y;K("IndexedDbIndexManager",`Using index ${y=f,`id=${y.indexId}|cg=${y.collectionGroup}|f=${y.fields.map(Oe=>`${Oe.fieldPath}:${Oe.kind}`).join(",")}`} to execute ${Kn(t)}`);const w=function(Oe,Ce){const ke=Ys(Ce);if(void 0===ke)return null;for(const De of mo(Oe,ke.fieldPath))switch(De.op){case"array-contains-any":return De.value.arrayValue.values||[];case"array-contains":return[De.value]}return null}(m,f),C=function(Oe,Ce){const ke=new Map;for(const De of Vn(Ce))for(const bt of mo(Oe,De.fieldPath))switch(bt.op){case"==":case"in":ke.set(De.fieldPath.canonicalString(),bt.value);break;case"not-in":case"!=":return ke.set(De.fieldPath.canonicalString(),bt.value),Array.from(ke.values())}return null}(m,f),B=function(Oe,Ce){const ke=[];let De=!0;for(const bt of Vn(Ce)){const Nu=0===bt.kind?Rc(Oe,bt.fieldPath,Oe.startAt):go(Oe,bt.fieldPath,Oe.startAt);ke.push(Nu.value),De&&(De=Nu.inclusive)}return new Wn(ke,De)}(m,f),G=function(Oe,Ce){const ke=[];let De=!0;for(const bt of Vn(Ce)){const Nu=0===bt.kind?go(Oe,bt.fieldPath,Oe.endAt):Rc(Oe,bt.fieldPath,Oe.endAt);ke.push(Nu.value),De&&(De=Nu.inclusive)}return new Wn(ke,De)}(m,f),ne=this.en(f,m,B),ce=this.en(f,m,G),Ue=this.nn(f,m,C),je=this.sn(f.indexId,w,ne,B.inclusive,ce,G.inclusive,Ue);return O.forEach(je,Oe=>i.J(Oe,t.limit).next(Ce=>{Ce.forEach(ke=>{const De=ee.fromSegments(ke.documentKey);u.has(De)||(u=u.add(De),d.push(De))})}))}).next(()=>d)}return O.resolve(null)})}Ze(e){let t=this.Xe.get(e);return t||(t=0===e.filters.length?[e]:i_(Fe.create(e.filters,"and")).map(i=>Ka(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt)),this.Xe.set(e,t),t)}sn(e,t,i,r,s,u,d){const f=(null!=t?t.length:1)*Math.max(i.length,s.length),m=f/(null!=t?t.length:1),y=[];for(let w=0;w<f;++w){const C=t?this.rn(t[w/m]):il,B=this.on(e,C,i[w%m],r),G=this.un(e,C,s[w%m],u),ne=d.map(ce=>this.on(e,C,ce,!0));y.push(...this.createRange(B,G,ne))}return y}on(e,t,i,r){const s=new us(e,ee.empty(),t,i);return r?s:s.Ue()}un(e,t,i,r){const s=new us(e,ee.empty(),t,i);return r?s.Ue():s}tn(e,t){const i=new n_(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next(s=>{let u=null;for(const d of s)i.je(d)&&(!u||d.fields.length>u.fields.length)&&(u=d);return u})}getIndexType(e,t){let i=2;const r=this.Ze(t);return O.forEach(r,s=>this.tn(e,s).next(u=>{u?0!==i&&u.fields.length<function(d){let f=new Ge(it.comparator),m=!1;for(const y of d.filters)for(const w of y.getFlattenedFilters())w.field.isKeyField()||("array-contains"===w.op||"array-contains-any"===w.op?m=!0:f=f.add(w.field));for(const y of d.orderBy)y.field.isKeyField()||(f=f.add(y.field));return f.size+(m?1:0)}(s)&&(i=1):i=0})).next(()=>null!==t.limit&&r.length>1&&2===i?1:i)}cn(e,t){const i=new fu;for(const r of Vn(e)){const s=t.data.field(r.fieldPath);if(null==s)return null;const u=i.qe(r.kind);as.Ie.ue(s,u)}return i.Fe()}rn(e){const t=new fu;return as.Ie.ue(e,t.qe(0)),t.Fe()}an(e,t){const i=new fu;return as.Ie.ue(kn(this.databaseId,t),i.qe(function(r){const s=Vn(r);return 0===s.length?0:s[s.length-1].kind}(e))),i.Fe()}nn(e,t,i){if(null===i)return[];let r=[];r.push(new fu);let s=0;for(const u of Vn(e)){const d=i[s++];for(const f of r)if(this.hn(t,u.fieldPath)&&$i(d))r=this.ln(r,u,d);else{const m=f.qe(u.kind);as.Ie.ue(d,m)}}return this.fn(r)}en(e,t,i){return this.nn(e,t,i.position)}fn(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].Fe();return t}ln(e,t,i){const r=[...e],s=[];for(const u of i.arrayValue.values||[])for(const d of r){const f=new fu;f.seed(d.Fe()),as.Ie.ue(u,f.qe(t.kind)),s.push(f)}return s}hn(e,t){return!!e.filters.find(i=>i instanceof Re&&i.field.isEqual(t)&&("in"===i.op||"not-in"===i.op))}getFieldIndexes(e,t){const i=rl(e),r=mu(e);return(t?i.W("collectionGroupIndex",IDBKeyRange.bound(t,t)):i.W()).next(s=>{const u=[];return O.forEach(s,d=>r.get([d.indexId,this.uid]).next(f=>{u.push(function(m,y){const w=y?new Br(y.sequenceNumber,new Ct(ss(y.readTime),new ee(bn(y.documentKey)),y.largestBatchId)):Br.empty(),C=m.fields.map(([B,G])=>new Qs(it.fromServerFormat(B),G));return new Hs(m.indexId,m.collectionGroup,C,w)}(d,f))})).next(()=>u)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>0===t.length?null:(t.sort((i,r)=>{const s=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return 0!==s?s:we(i.collectionGroup,r.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,i){const r=rl(e),s=mu(e);return this.dn(e).next(u=>r.W("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(d=>O.forEach(d,f=>s.put(Xf(f.indexId,this.user,u,i)))))}updateIndexEntries(e,t){const i=new Map;return O.forEach(t,(r,s)=>{const u=i.get(r.collectionGroup);return(u?O.resolve(u):this.getFieldIndexes(e,r.collectionGroup)).next(d=>(i.set(r.collectionGroup,d),O.forEach(d,f=>this._n(e,r,f).next(m=>{const y=this.wn(s,f);return m.isEqual(y)?O.resolve():this.mn(e,s,f,m,y)}))))})}gn(e,t,i,r){return pu(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.an(i,t.key),documentKey:t.key.path.toArray()})}yn(e,t,i,r){return pu(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.an(i,t.key),t.key.path.toArray()])}_n(e,t,i){const r=pu(e);let s=new Ge(ur);return r.Z({index:"documentKeyIndex",range:IDBKeyRange.only([i.indexId,this.uid,this.an(i,t)])},(u,d)=>{s=s.add(new us(i.indexId,t,d.arrayValue,d.directionalValue))}).next(()=>s)}wn(e,t){let i=new Ge(ur);const r=this.cn(t,e);if(null==r)return i;const s=Ys(t);if(null!=s){const u=e.data.field(s.fieldPath);if($i(u))for(const d of u.arrayValue.values||[])i=i.add(new us(t.indexId,e.key,this.rn(d),r))}else i=i.add(new us(t.indexId,e.key,il,r));return i}mn(e,t,i,r,s){K("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const u=[];return function(d,f,m,y,w){const C=d.getIterator(),B=f.getIterator();let G=Ji(C),ne=Ji(B);for(;G||ne;){let ce=!1,Ue=!1;if(G&&ne){const je=m(G,ne);je<0?Ue=!0:je>0&&(ce=!0)}else null!=G?Ue=!0:ce=!0;ce?(y(ne),ne=Ji(B)):Ue?(w(G),G=Ji(C)):(G=Ji(C),ne=Ji(B))}}(r,s,ur,d=>{u.push(this.gn(e,t,i,d))},d=>{u.push(this.yn(e,t,i,d))}),O.waitFor(u)}dn(e){let t=1;return mu(e).Z({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(i,r,s)=>{s.done(),t=r.sequenceNumber+1}).next(()=>t)}createRange(e,t,i){i=i.sort((u,d)=>ur(u,d)).filter((u,d,f)=>!d||0!==ur(u,f[d-1]));const r=[];r.push(e);for(const u of i){const d=ur(u,e),f=ur(u,t);if(0===d)r[0]=e.Ue();else if(d>0&&f<0)r.push(u),r.push(u.Ue());else if(f>0)break}r.push(t);const s=[];for(let u=0;u<r.length;u+=2){if(this.pn(r[u],r[u+1]))return[];s.push(IDBKeyRange.bound([r[u].indexId,this.uid,r[u].arrayValue,r[u].directionalValue,il,[]],[r[u+1].indexId,this.uid,r[u+1].arrayValue,r[u+1].directionalValue,il,[]]))}return s}pn(e,t){return ur(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(up)}getMinOffset(e,t){return O.mapArray(this.Ze(t),i=>this.tn(e,i).next(r=>r||Y())).next(up)}}function ap(n){return Tt(n,"collectionParents")}function pu(n){return Tt(n,"indexEntries")}function rl(n){return Tt(n,"indexConfiguration")}function mu(n){return Tt(n,"indexState")}function up(n){le(0!==n.length);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){const r=n[i].indexState.offset;Oa(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new Ct(e.readTime,e.documentKey,t)}const cp={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Ht{constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}static withCacheSize(e){return new Ht(e,Ht.DEFAULT_COLLECTION_PERCENTILE,Ht.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function lp(n,e,t){const i=n.store("mutations"),r=n.store("documentMutations"),s=[],u=IDBKeyRange.only(t.batchId);let d=0;const f=i.Z({range:u},(y,w,C)=>(d++,C.delete()));s.push(f.next(()=>{le(1===d)}));const m=[];for(const y of t.mutations){const w=Kf(e,y.key.path,t.batchId);s.push(r.delete(w)),m.push(y.key)}return O.waitFor(s).next(()=>m)}function sl(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Y();e=n.noDocument}return JSON.stringify(e).length}Ht.DEFAULT_COLLECTION_PERCENTILE=10,Ht.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ht.DEFAULT=new Ht(41943040,Ht.DEFAULT_COLLECTION_PERCENTILE,Ht.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ht.DISABLED=new Ht(-1,0,0);class ol{constructor(e,t,i,r){this.userId=e,this.yt=t,this.indexManager=i,this.referenceDelegate=r,this.In={}}static re(e,t,i,r){le(""!==e.uid);const s=e.isAuthenticated()?e.uid:"";return new ol(s,t,i,r)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return cr(e).Z({index:"userMutationsIndex",range:i},(r,s,u)=>{t=!1,u.done()}).next(()=>t)}addMutationBatch(e,t,i,r){const s=Ro(e),u=cr(e);return u.add({}).next(d=>{le("number"==typeof d);const f=new Sh(d,t,i,r),m=function(C,B,G){const ne=G.baseMutations.map(Ue=>_(C.ie,Ue)),ce=G.mutations.map(Ue=>_(C.ie,Ue));return{userId:B,batchId:G.batchId,localWriteTimeMs:G.localWriteTime.toMillis(),baseMutations:ne,mutations:ce}}(this.yt,this.userId,f),y=[];let w=new Ge((C,B)=>we(C.canonicalString(),B.canonicalString()));for(const C of r){const B=Kf(this.userId,C.key.path,d);w=w.add(C.key.path.popLast()),y.push(u.put(m)),y.push(s.put(B,Ng))}return w.forEach(C=>{y.push(this.indexManager.addToCollectionParentIndex(e,C))}),e.addOnCommittedListener(()=>{this.In[d]=f.keys()}),O.waitFor(y).next(()=>f)})}lookupMutationBatch(e,t){return cr(e).get(t).next(i=>i?(le(i.userId===this.userId),os(this.yt,i)):null)}Tn(e,t){return this.In[t]?O.resolve(this.In[t]):this.lookupMutationBatch(e,t).next(i=>{if(i){const r=i.keys();return this.In[t]=r,r}return null})}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=IDBKeyRange.lowerBound([this.userId,i]);let s=null;return cr(e).Z({index:"userMutationsIndex",range:r},(u,d,f)=>{d.userId===this.userId&&(le(d.batchId>=i),s=os(this.yt,d)),f.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=-1;return cr(e).Z({index:"userMutationsIndex",range:t,reverse:!0},(r,s,u)=>{i=s.batchId,u.done()}).next(()=>i)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return cr(e).W("userMutationsIndex",t).next(i=>i.map(r=>os(this.yt,r)))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=So(this.userId,t.path),r=IDBKeyRange.lowerBound(i),s=[];return Ro(e).Z({range:r},(u,d,f)=>{const[m,y,w]=u,C=bn(y);if(m===this.userId&&t.path.isEqual(C))return cr(e).get(w).next(B=>{if(!B)throw Y();le(B.userId===this.userId),s.push(os(this.yt,B))});f.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Ge(we);const r=[];return t.forEach(s=>{const u=So(this.userId,s.path),d=IDBKeyRange.lowerBound(u),f=Ro(e).Z({range:d},(m,y,w)=>{const[C,B,G]=m,ne=bn(B);C===this.userId&&s.path.isEqual(ne)?i=i.add(G):w.done()});r.push(f)}),O.waitFor(r).next(()=>this.En(e,i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1,s=So(this.userId,i),u=IDBKeyRange.lowerBound(s);let d=new Ge(we);return Ro(e).Z({range:u},(f,m,y)=>{const[w,C,B]=f,G=bn(C);w===this.userId&&i.isPrefixOf(G)?G.length===r&&(d=d.add(B)):y.done()}).next(()=>this.En(e,d))}En(e,t){const i=[],r=[];return t.forEach(s=>{r.push(cr(e).get(s).next(u=>{if(null===u)throw Y();le(u.userId===this.userId),i.push(os(this.yt,u))}))}),O.waitFor(r).next(()=>i)}removeMutationBatch(e,t){return lp(e.se,this.userId,t).next(i=>(e.addOnCommittedListener(()=>{this.An(t.batchId)}),O.forEach(i,r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))}An(e){delete this.In[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return O.resolve();const i=IDBKeyRange.lowerBound([this.userId]),r=[];return Ro(e).Z({range:i},(s,u,d)=>{if(s[0]===this.userId){const f=bn(s[1]);r.push(f)}else d.done()}).next(()=>{le(0===r.length)})})}containsKey(e,t){return hp(e,this.userId,t)}Rn(e){return dp(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function hp(n,e,t){const i=So(e,t.path),r=i[1],s=IDBKeyRange.lowerBound(i);let u=!1;return Ro(n).Z({range:s,X:!0},(d,f,m)=>{const[y,w,C]=d;y===e&&w===r&&(u=!0),m.done()}).next(()=>u)}function cr(n){return Tt(n,"mutations")}function Ro(n){return Tt(n,"documentMutations")}function dp(n){return Tt(n,"mutationQueues")}class cs{constructor(e){this.bn=e}next(){return this.bn+=2,this.bn}static Pn(){return new cs(0)}static vn(){return new cs(-1)}}class o_{constructor(e,t){this.referenceDelegate=e,this.yt=t}allocateTargetId(e){return this.Vn(e).next(t=>{const i=new cs(t.highestTargetId);return t.highestTargetId=i.next(),this.Sn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Vn(e).next(t=>fe.fromTimestamp(new Qe(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Vn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,i){return this.Vn(e).next(r=>(r.highestListenSequenceNumber=t,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.Sn(e,r)))}addTargetData(e,t){return this.Dn(e,t).next(()=>this.Vn(e).next(i=>(i.targetCount+=1,this.Cn(t,i),this.Sn(e,i))))}updateTargetData(e,t){return this.Dn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Oo(e).delete(t.targetId)).next(()=>this.Vn(e)).next(i=>(le(i.targetCount>0),i.targetCount-=1,this.Sn(e,i)))}removeTargets(e,t,i){let r=0;const s=[];return Oo(e).Z((u,d)=>{const f=hu(d);f.sequenceNumber<=t&&null===i.get(f.targetId)&&(r++,s.push(this.removeTargetData(e,f)))}).next(()=>O.waitFor(s)).next(()=>r)}forEachTarget(e,t){return Oo(e).Z((i,r)=>{const s=hu(r);t(s)})}Vn(e){return fp(e).get("targetGlobalKey").next(t=>(le(null!==t),t))}Sn(e,t){return fp(e).put("targetGlobalKey",t)}Dn(e,t){return Oo(e).put(Qf(this.yt,t))}Cn(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.Vn(e).next(t=>t.targetCount)}getTargetData(e,t){const i=Kn(t),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let s=null;return Oo(e).Z({range:r,index:"queryTargetsIndex"},(u,d,f)=>{const m=hu(d);zr(t,m.target)&&(s=m,f.done())}).next(()=>s)}addMatchingKeys(e,t,i){const r=[],s=lr(e);return t.forEach(u=>{const d=Et(u.path);r.push(s.put({targetId:i,path:d})),r.push(this.referenceDelegate.addReference(e,i,u))}),O.waitFor(r)}removeMatchingKeys(e,t,i){const r=lr(e);return O.forEach(t,s=>{const u=Et(s.path);return O.waitFor([r.delete([i,u]),this.referenceDelegate.removeReference(e,i,s)])})}removeMatchingKeysForTargetId(e,t){const i=lr(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),r=lr(e);let s=Ae();return r.Z({range:i,X:!0},(u,d,f)=>{const m=bn(u[1]),y=new ee(m);s=s.add(y)}).next(()=>s)}containsKey(e,t){const i=Et(t.path),r=IDBKeyRange.bound([i],[mc(i)],!1,!0);let s=0;return lr(e).Z({index:"documentTargetsIndex",X:!0,range:r},([u,d],f,m)=>{0!==u&&(s++,m.done())}).next(()=>s>0)}ne(e,t){return Oo(e).get(t).next(i=>i?hu(i):null)}}function Oo(n){return Tt(n,"targets")}function fp(n){return Tt(n,"targetGlobal")}function lr(n){return Tt(n,"targetDocuments")}function pp([n,e],[t,i]){const r=we(n,t);return 0===r?we(e,i):r}class a_{constructor(e){this.xn=e,this.buffer=new Ge(pp),this.Nn=0}kn(){return++this.Nn}On(e){const t=[e,this.kn()];if(this.buffer.size<this.xn)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();pp(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class u_{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Mn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Fn(6e4)}stop(){this.Mn&&(this.Mn.cancel(),this.Mn=null)}get started(){return null!==this.Mn}Fn(e){var t=this;K("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Mn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,k.Z)(function*(){t.Mn=null;try{yield t.localStore.collectGarbage(t.garbageCollector)}catch(i){Zn(i)?K("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",i):yield Bn(i)}yield t.Fn(3e5)}))}}class c_{constructor(e,t){this.$n=e,this.params=t}calculateTargetCount(e,t){return this.$n.Bn(e).next(i=>Math.floor(t/100*i))}nthSequenceNumber(e,t){if(0===t)return O.resolve(Dt.at);const i=new a_(t);return this.$n.forEachTarget(e,r=>i.On(r.sequenceNumber)).next(()=>this.$n.Ln(e,r=>i.On(r))).next(()=>i.maxValue)}removeTargets(e,t,i){return this.$n.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.$n.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(K("LruGarbageCollector","Garbage collection skipped; disabled"),O.resolve(cp)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(K("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),cp):this.qn(e,t))}getCacheSize(e){return this.$n.getCacheSize(e)}qn(e,t){let i,r,s,u,d,f,m;const y=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(w=>(w>this.params.maximumSequenceNumbersToCollect?(K("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${w}`),r=this.params.maximumSequenceNumbersToCollect):r=w,u=Date.now(),this.nthSequenceNumber(e,r))).next(w=>(i=w,d=Date.now(),this.removeTargets(e,i,t))).next(w=>(s=w,f=Date.now(),this.removeOrphanedDocuments(e,i))).next(w=>(m=Date.now(),hc()<=ae.in.DEBUG&&K("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${u-y}ms\n\tDetermined least recently used ${r} in `+(d-u)+`ms\n\tRemoved ${s} targets in `+(f-d)+`ms\n\tRemoved ${w} documents in `+(m-f)+`ms\nTotal Duration: ${m-y}ms`),O.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:w})))}}class l_{constructor(e,t){this.db=e,this.garbageCollector=new c_(this,t)}Bn(e){const t=this.Un(e);return this.db.getTargetCache().getTargetCount(e).next(i=>t.next(r=>i+r))}Un(e){let t=0;return this.Ln(e,i=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Ln(e,t){return this.Kn(e,(i,r)=>t(r))}addReference(e,t,i){return al(e,i)}removeReference(e,t,i){return al(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return al(e,t)}Gn(e,t){return function(i,r){let s=!1;return dp(i).tt(u=>hp(i,u,r).next(d=>(d&&(s=!0),O.resolve(!d)))).next(()=>s)}(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let s=0;return this.Kn(e,(u,d)=>{if(d<=t){const f=this.Gn(e,u).next(m=>{if(!m)return s++,i.getEntry(e,u).next(()=>(i.removeEntry(u,fe.min()),lr(e).delete([0,Et(u.path)])))});r.push(f)}}).next(()=>O.waitFor(r)).next(()=>i.apply(e)).next(()=>s)}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return al(e,t)}Kn(e,t){const i=lr(e);let r,s=Dt.at;return i.Z({index:"documentTargetsIndex"},([u,d],{path:f,sequenceNumber:m})=>{0===u?(s!==Dt.at&&t(new ee(bn(r)),s),s=m,r=f):s=Dt.at}).next(()=>{s!==Dt.at&&t(new ee(bn(r)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function al(n,e){return lr(n).put((i=n.currentSequenceNumber,{targetId:0,path:Et(e.path),sequenceNumber:i}));var i}class mp{constructor(){this.changes=new $n(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ye.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return void 0!==i?O.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class h_{constructor(e){this.yt=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return ls(e).put(i)}removeEntry(e,t,i){return ls(e).delete(function(r,s){const u=r.path.toArray();return[u.slice(0,u.length-2),u[u.length-2],el(s),u[u.length-1]]}(t,i))}updateMetadata(e,t){return this.getMetadata(e).next(i=>(i.byteSize+=t,this.Qn(e,i)))}getEntry(e,t){let i=Ye.newInvalidDocument(t);return ls(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(gu(t))},(r,s)=>{i=this.jn(t,s)}).next(()=>i)}Wn(e,t){let i={size:0,document:Ye.newInvalidDocument(t)};return ls(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(gu(t))},(r,s)=>{i={document:this.jn(t,s),size:sl(s)}}).next(()=>i)}getEntries(e,t){let i=Rt();return this.zn(e,t,(r,s)=>{const u=this.jn(r,s);i=i.insert(r,u)}).next(()=>i)}Hn(e,t){let i=Rt(),r=new rt(ee.comparator);return this.zn(e,t,(s,u)=>{const d=this.jn(s,u);i=i.insert(s,d),r=r.insert(s,sl(u))}).next(()=>({documents:i,Jn:r}))}zn(e,t,i){if(t.isEmpty())return O.resolve();let r=new Ge(vp);t.forEach(f=>r=r.add(f));const s=IDBKeyRange.bound(gu(r.first()),gu(r.last())),u=r.getIterator();let d=u.getNext();return ls(e).Z({index:"documentKeyIndex",range:s},(f,m,y)=>{const w=ee.fromSegments([...m.prefixPath,m.collectionGroup,m.documentId]);for(;d&&vp(d,w)<0;)i(d,null),d=u.getNext();d&&d.isEqual(w)&&(i(d,m),d=u.hasNext()?u.getNext():null),d?y.j(gu(d)):y.done()}).next(()=>{for(;d;)i(d,null),d=u.hasNext()?u.getNext():null})}getAllFromCollection(e,t,i){const r=[t.popLast().toArray(),t.lastSegment(),el(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],s=[t.popLast().toArray(),t.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ls(e).W(IDBKeyRange.bound(r,s,!0)).next(u=>{let d=Rt();for(const f of u){const m=this.jn(ee.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);d=d.insert(m.key,m)}return d})}getAllFromCollectionGroup(e,t,i,r){let s=Rt();const u=yp(t,i),d=yp(t,Ct.max());return ls(e).Z({index:"collectionGroupIndex",range:IDBKeyRange.bound(u,d,!0)},(f,m,y)=>{const w=this.jn(ee.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);s=s.insert(w.key,w),s.size===r&&y.done()}).next(()=>s)}newChangeBuffer(e){return new d_(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return _p(e).get("remoteDocumentGlobalKey").next(t=>(le(!!t),t))}Qn(e,t){return _p(e).put("remoteDocumentGlobalKey",t)}jn(e,t){if(t){const i=function Yg(n,e){let t;if(e.document)t=a(n.ie,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=ee.fromSegments(e.noDocument.path),r=ss(e.noDocument.readTime);t=Ye.newNoDocument(i,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Y();{const i=ee.fromSegments(e.unknownDocument.path),r=ss(e.unknownDocument.version);t=Ye.newUnknownDocument(i,r)}}return e.readTime&&t.setReadTime(function(i){const r=new Qe(i[0],i[1]);return fe.fromTimestamp(r)}(e.readTime)),t}(this.yt,t);if(!i.isNoDocument()||!i.version.isEqual(fe.min()))return i}return Ye.newInvalidDocument(e)}}function gp(n){return new h_(n)}class d_ extends mp{constructor(e,t){super(),this.Yn=e,this.trackRemovals=t,this.Xn=new $n(i=>i.toString(),(i,r)=>i.isEqual(r))}applyChanges(e){const t=[];let i=0,r=new Ge((s,u)=>we(s.canonicalString(),u.canonicalString()));return this.changes.forEach((s,u)=>{const d=this.Xn.get(s);if(t.push(this.Yn.removeEntry(e,s,d.readTime)),u.isValidDocument()){const f=Yf(this.Yn.yt,u);r=r.add(s.path.popLast()),i+=sl(f)-d.size,t.push(this.Yn.addEntry(e,s,f))}else if(i-=d.size,this.trackRemovals){const f=Yf(this.Yn.yt,u.convertToNoDocument(fe.min()));t.push(this.Yn.addEntry(e,s,f))}}),r.forEach(s=>{t.push(this.Yn.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.Yn.updateMetadata(e,i)),O.waitFor(t)}getFromCache(e,t){return this.Yn.Wn(e,t).next(i=>(this.Xn.set(t,{size:i.size,readTime:i.document.readTime}),i.document))}getAllFromCache(e,t){return this.Yn.Hn(e,t).next(({documents:i,Jn:r})=>(r.forEach((s,u)=>{this.Xn.set(s,{size:u,readTime:i.get(s).readTime})}),i))}}function _p(n){return Tt(n,"remoteDocumentGlobal")}function ls(n){return Tt(n,"remoteDocumentsV14")}function gu(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function yp(n,e){const t=e.documentKey.path.toArray();return[n,el(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function vp(n,e){const t=n.path.toArray(),i=e.path.toArray();let r=0;for(let s=0;s<t.length-2&&s<i.length-2;++s)if(r=we(t[s],i[s]),r)return r;return r=we(t.length,i.length),r||(r=we(t[t.length-2],i[i.length-2]),r||we(t[t.length-1],i[i.length-1]))}class f_{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Ip{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(i=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(null!==i&&Yr(i.mutation,r,St.empty(),Qe.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,Ae()).next(()=>i))}getLocalViewOfDocuments(e,t,i=Ae()){const r=yn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,i).next(s=>{let u=Ii();return s.forEach((d,f)=>{u=u.insert(d,f.overlayedDocument)}),u}))}getOverlayedDocuments(e,t){const i=yn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,Ae()))}populateOverlays(e,t,i){const r=[];return i.forEach(s=>{t.has(s)||r.push(s)}),this.documentOverlayCache.getOverlays(e,r).next(s=>{s.forEach((u,d)=>{t.set(u,d)})})}computeViews(e,t,i,r){let s=Rt();const u=Jr(),d=Jr();return t.forEach((f,m)=>{const y=i.get(m.key);r.has(m.key)&&(void 0===y||y.mutation instanceof Sn)?s=s.insert(m.key,m):void 0!==y&&(u.set(m.key,y.mutation.getFieldMask()),Yr(y.mutation,m,y.mutation.getFieldMask(),Qe.now()))}),this.recalculateAndSaveOverlays(e,s).next(f=>(f.forEach((m,y)=>u.set(m,y)),t.forEach((m,y)=>{var w;return d.set(m,new f_(y,null!==(w=u.get(m))&&void 0!==w?w:null))}),d))}recalculateAndSaveOverlays(e,t){const i=Jr();let r=new rt((u,d)=>u-d),s=Ae();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(u=>{for(const d of u)d.keys().forEach(f=>{const m=t.get(f);if(null===m)return;let y=i.get(f)||St.empty();y=d.applyToLocalView(m,y),i.set(f,y);const w=(r.get(d.batchId)||Ae()).add(f);r=r.insert(d.batchId,w)})}).next(()=>{const u=[],d=r.getReverseIterator();for(;d.hasNext();){const f=d.getNext(),m=f.key,y=f.value,w=xo();y.forEach(C=>{if(!s.has(C)){const B=Eo(t.get(C),i.get(C));null!==B&&w.set(C,B),s=s.add(C)}}),u.push(this.documentOverlayCache.saveOverlays(e,m,w))}return O.waitFor(u)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i){return ee.isDocumentKey((r=t).path)&&null===r.collectionGroup&&0===r.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):$a(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i):this.getDocumentsMatchingCollectionQuery(e,t,i);var r}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next(s=>{const u=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):O.resolve(yn());let d=-1,f=s;return u.next(m=>O.forEach(m,(y,w)=>(d<w.largestBatchId&&(d=w.largestBatchId),s.get(y)?O.resolve():this.remoteDocumentCache.getEntry(e,y).next(C=>{f=f.insert(y,C)}))).next(()=>this.populateOverlays(e,m,s)).next(()=>this.computeViews(e,f,m,Ae())).next(y=>({batchId:d,changes:tu(y)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ee(t)).next(i=>{let r=Ii();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,i){const r=t.collectionGroup;let s=Ii();return this.indexManager.getCollectionParents(e,r).next(u=>O.forEach(u,d=>{const f=(m=t,y=d.child(r),new Cn(y,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt));var m,y;return this.getDocumentsMatchingCollectionQuery(e,f,i).next(m=>{m.forEach((y,w)=>{s=s.insert(y,w)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,i){let r;return this.remoteDocumentCache.getAllFromCollection(e,t.path,i).next(s=>(r=s,this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId))).next(s=>{s.forEach((d,f)=>{const m=f.getKey();null===r.get(m)&&(r=r.insert(m,Ye.newInvalidDocument(m)))});let u=Ii();return r.forEach((d,f)=>{const m=s.get(d);void 0!==m&&Yr(m.mutation,f,St.empty(),Qe.now()),vo(t,f)&&(u=u.insert(d,f))}),u})}}class p_{constructor(e){this.yt=e,this.Zn=new Map,this.ts=new Map}getBundleMetadata(e,t){return O.resolve(this.Zn.get(t))}saveBundleMetadata(e,t){var i;return this.Zn.set(t.id,{id:(i=t).id,version:i.version,createTime:st(i.createTime)}),O.resolve()}getNamedQuery(e,t){return O.resolve(this.ts.get(t))}saveNamedQuery(e,t){return this.ts.set(t.name,{name:(i=t).name,query:Nh(i.bundledQuery),readTime:st(i.readTime)}),O.resolve();var i}}class m_{constructor(){this.overlays=new rt(ee.comparator),this.es=new Map}getOverlay(e,t){return O.resolve(this.overlays.get(t))}getOverlays(e,t){const i=yn();return O.forEach(t,r=>this.getOverlay(e,r).next(s=>{null!==s&&i.set(r,s)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((r,s)=>{this.oe(e,t,s)}),O.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.es.get(i);return void 0!==r&&(r.forEach(s=>this.overlays=this.overlays.remove(s)),this.es.delete(i)),O.resolve()}getOverlaysForCollection(e,t,i){const r=yn(),s=t.length+1,u=new ee(t.child("")),d=this.overlays.getIteratorFrom(u);for(;d.hasNext();){const f=d.getNext().value,m=f.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===s&&f.largestBatchId>i&&r.set(f.getKey(),f)}return O.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new rt((m,y)=>m-y);const u=this.overlays.getIterator();for(;u.hasNext();){const m=u.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>i){let y=s.get(m.largestBatchId);null===y&&(y=yn(),s=s.insert(m.largestBatchId,y)),y.set(m.getKey(),m)}}const d=yn(),f=s.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach((m,y)=>d.set(m,y)),!(d.size()>=r)););return O.resolve(d)}oe(e,t,i){const r=this.overlays.get(i.key);if(null!==r){const u=this.es.get(r.largestBatchId).delete(i.key);this.es.set(r.largestBatchId,u)}this.overlays=this.overlays.insert(i.key,new Oh(t,i));let s=this.es.get(t);void 0===s&&(s=Ae(),this.es.set(t,s)),this.es.set(t,s.add(i.key))}}class Bh{constructor(){this.ns=new Ge(At.ss),this.rs=new Ge(At.os)}isEmpty(){return this.ns.isEmpty()}addReference(e,t){const i=new At(e,t);this.ns=this.ns.add(i),this.rs=this.rs.add(i)}us(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.cs(new At(e,t))}hs(e,t){e.forEach(i=>this.removeReference(i,t))}ls(e){const t=new ee(new Me([])),i=new At(t,e),r=new At(t,e+1),s=[];return this.rs.forEachInRange([i,r],u=>{this.cs(u),s.push(u.key)}),s}fs(){this.ns.forEach(e=>this.cs(e))}cs(e){this.ns=this.ns.delete(e),this.rs=this.rs.delete(e)}ds(e){const t=new ee(new Me([])),i=new At(t,e),r=new At(t,e+1);let s=Ae();return this.rs.forEachInRange([i,r],u=>{s=s.add(u.key)}),s}containsKey(e){const t=new At(e,0),i=this.ns.firstAfterOrEqual(t);return null!==i&&e.isEqual(i.key)}}class At{constructor(e,t){this.key=e,this._s=t}static ss(e,t){return ee.comparator(e.key,t.key)||we(e._s,t._s)}static os(e,t){return we(e._s,t._s)||ee.comparator(e.key,t.key)}}class g_{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.ws=1,this.gs=new Ge(At.ss)}checkEmpty(e){return O.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,i,r){const s=this.ws;this.ws++;const u=new Sh(s,t,i,r);this.mutationQueue.push(u);for(const d of r)this.gs=this.gs.add(new At(d.key,s)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return O.resolve(u)}lookupMutationBatch(e,t){return O.resolve(this.ys(t))}getNextMutationBatchAfterBatchId(e,t){const r=this.ps(t+1),s=r<0?0:r;return O.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return O.resolve(0===this.mutationQueue.length?-1:this.ws-1)}getAllMutationBatches(e){return O.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new At(t,0),r=new At(t,Number.POSITIVE_INFINITY),s=[];return this.gs.forEachInRange([i,r],u=>{const d=this.ys(u._s);s.push(d)}),O.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Ge(we);return t.forEach(r=>{const s=new At(r,0),u=new At(r,Number.POSITIVE_INFINITY);this.gs.forEachInRange([s,u],d=>{i=i.add(d._s)})}),O.resolve(this.Is(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let s=i;ee.isDocumentKey(s)||(s=s.child(""));const u=new At(new ee(s),0);let d=new Ge(we);return this.gs.forEachWhile(f=>{const m=f.key.path;return!!i.isPrefixOf(m)&&(m.length===r&&(d=d.add(f._s)),!0)},u),O.resolve(this.Is(d))}Is(e){const t=[];return e.forEach(i=>{const r=this.ys(i);null!==r&&t.push(r)}),t}removeMutationBatch(e,t){le(0===this.Ts(t.batchId,"removed")),this.mutationQueue.shift();let i=this.gs;return O.forEach(t.mutations,r=>{const s=new At(r.key,t.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.gs=i})}An(e){}containsKey(e,t){const i=new At(t,0),r=this.gs.firstAfterOrEqual(i);return O.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return O.resolve()}Ts(e,t){return this.ps(e)}ps(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}ys(e){const t=this.ps(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class __{constructor(e){this.Es=e,this.docs=new rt(ee.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),s=r?r.size:0,u=this.Es(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:u}),this.size+=u-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return O.resolve(i?i.document.mutableCopy():Ye.newInvalidDocument(t))}getEntries(e,t){let i=Rt();return t.forEach(r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():Ye.newInvalidDocument(r))}),O.resolve(i)}getAllFromCollection(e,t,i){let r=Rt();const s=new ee(t.child("")),u=this.docs.getIteratorFrom(s);for(;u.hasNext();){const{key:d,value:{document:f}}=u.getNext();if(!t.isPrefixOf(d.path))break;d.path.length>t.length+1||Oa(_c(f),i)<=0||(r=r.insert(f.key,f.mutableCopy()))}return O.resolve(r)}getAllFromCollectionGroup(e,t,i,r){Y()}As(e,t){return O.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new y_(this)}getSize(e){return O.resolve(this.size)}}class y_ extends mp{constructor(e){super(),this.Yn=e}applyChanges(e){const t=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?t.push(this.Yn.addEntry(e,r)):this.Yn.removeEntry(i)}),O.waitFor(t)}getFromCache(e,t){return this.Yn.getEntry(e,t)}getAllFromCache(e,t){return this.Yn.getEntries(e,t)}}class v_{constructor(e){this.persistence=e,this.Rs=new $n(t=>Kn(t),zr),this.lastRemoteSnapshotVersion=fe.min(),this.highestTargetId=0,this.bs=0,this.Ps=new Bh,this.targetCount=0,this.vs=cs.Pn()}forEachTarget(e,t){return this.Rs.forEach((i,r)=>t(r)),O.resolve()}getLastRemoteSnapshotVersion(e){return O.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return O.resolve(this.bs)}allocateTargetId(e){return this.highestTargetId=this.vs.next(),O.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.bs&&(this.bs=t),O.resolve()}Dn(e){this.Rs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.vs=new cs(t),this.highestTargetId=t),e.sequenceNumber>this.bs&&(this.bs=e.sequenceNumber)}addTargetData(e,t){return this.Dn(t),this.targetCount+=1,O.resolve()}updateTargetData(e,t){return this.Dn(t),O.resolve()}removeTargetData(e,t){return this.Rs.delete(t.target),this.Ps.ls(t.targetId),this.targetCount-=1,O.resolve()}removeTargets(e,t,i){let r=0;const s=[];return this.Rs.forEach((u,d)=>{d.sequenceNumber<=t&&null===i.get(d.targetId)&&(this.Rs.delete(u),s.push(this.removeMatchingKeysForTargetId(e,d.targetId)),r++)}),O.waitFor(s).next(()=>r)}getTargetCount(e){return O.resolve(this.targetCount)}getTargetData(e,t){const i=this.Rs.get(t)||null;return O.resolve(i)}addMatchingKeys(e,t,i){return this.Ps.us(t,i),O.resolve()}removeMatchingKeys(e,t,i){this.Ps.hs(t,i);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach(u=>{s.push(r.markPotentiallyOrphaned(e,u))}),O.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Ps.ls(t),O.resolve()}getMatchingKeysForTargetId(e,t){const i=this.Ps.ds(t);return O.resolve(i)}containsKey(e,t){return O.resolve(this.Ps.containsKey(t))}}class bp{constructor(e,t){this.Vs={},this.overlays={},this.Ss=new Dt(0),this.Ds=!1,this.Ds=!0,this.referenceDelegate=e(this),this.Cs=new v_(this),this.indexManager=new r_,this.remoteDocumentCache=new __(i=>this.referenceDelegate.xs(i)),this.yt=new Hf(t),this.Ns=new p_(this.yt)}start(){return Promise.resolve()}shutdown(){return this.Ds=!1,Promise.resolve()}get started(){return this.Ds}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new m_,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.Vs[e.toKey()];return i||(i=new g_(t,this.referenceDelegate),this.Vs[e.toKey()]=i),i}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ns}runTransaction(e,t,i){K("MemoryPersistence","Starting transaction:",e);const r=new I_(this.Ss.next());return this.referenceDelegate.ks(),i(r).next(s=>this.referenceDelegate.Os(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}Ms(e,t){return O.or(Object.values(this.Vs).map(i=>()=>i.containsKey(e,t)))}}class I_ extends vc{constructor(e){super(),this.currentSequenceNumber=e}}class ul{constructor(e){this.persistence=e,this.Fs=new Bh,this.$s=null}static Bs(e){return new ul(e)}get Ls(){if(this.$s)return this.$s;throw Y()}addReference(e,t,i){return this.Fs.addReference(i,t),this.Ls.delete(i.toString()),O.resolve()}removeReference(e,t,i){return this.Fs.removeReference(i,t),this.Ls.add(i.toString()),O.resolve()}markPotentiallyOrphaned(e,t){return this.Ls.add(t.toString()),O.resolve()}removeTarget(e,t){this.Fs.ls(t.targetId).forEach(r=>this.Ls.add(r.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(s=>this.Ls.add(s.toString()))}).next(()=>i.removeTargetData(e,t))}ks(){this.$s=new Set}Os(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return O.forEach(this.Ls,i=>{const r=ee.fromPath(i);return this.qs(e,r).next(s=>{s||t.removeEntry(r,fe.min())})}).next(()=>(this.$s=null,t.apply(e)))}updateLimboDocument(e,t){return this.qs(e,t).next(i=>{i?this.Ls.delete(t.toString()):this.Ls.add(t.toString())})}xs(e){return 0}qs(e,t){return O.or([()=>O.resolve(this.Fs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ms(e,t)])}}class b_{constructor(e){this.yt=e}$(e,t,i,r){const s=new Xs("createOrUpgrade",t);var d;i<1&&r>=1&&(e.createObjectStore("owner"),(d=e).createObjectStore("mutationQueues",{keyPath:"userId"}),d.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Do,{unique:!0}),d.createObjectStore("documentMutations"),wp(e),function(d){d.createObjectStore("remoteDocuments")}(e));let u=O.resolve();return i<3&&r>=3&&(0!==i&&(function(d){d.deleteObjectStore("targetDocuments"),d.deleteObjectStore("targets"),d.deleteObjectStore("targetGlobal")}(e),wp(e)),u=u.next(()=>function(d){const f=d.store("targetGlobal"),m={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:fe.min().toTimestamp(),targetCount:0};return f.put("targetGlobalKey",m)}(s))),i<4&&r>=4&&(0!==i&&(u=u.next(()=>function(d,f){return f.store("mutations").W().next(m=>{d.deleteObjectStore("mutations"),d.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Do,{unique:!0});const y=f.store("mutations"),w=m.map(C=>y.put(C));return O.waitFor(w)})}(e,s))),u=u.next(()=>{!function(d){d.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),i<5&&r>=5&&(u=u.next(()=>this.Us(s))),i<6&&r>=6&&(u=u.next(()=>(function(d){d.createObjectStore("remoteDocumentGlobal")}(e),this.Ks(s)))),i<7&&r>=7&&(u=u.next(()=>this.Gs(s))),i<8&&r>=8&&(u=u.next(()=>this.Qs(e,s))),i<9&&r>=9&&(u=u.next(()=>{!function(d){d.objectStoreNames.contains("remoteDocumentChanges")&&d.deleteObjectStore("remoteDocumentChanges")}(e)})),i<10&&r>=10&&(u=u.next(()=>this.js(s))),i<11&&r>=11&&(u=u.next(()=>{(function(d){d.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(d){d.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),i<12&&r>=12&&(u=u.next(()=>{!function(d){const f=d.createObjectStore("documentOverlays",{keyPath:Kg});f.createIndex("collectionPathOverlayIndex",jg,{unique:!1}),f.createIndex("collectionGroupOverlayIndex",zg,{unique:!1})}(e)})),i<13&&r>=13&&(u=u.next(()=>function(d){const f=d.createObjectStore("remoteDocumentsV14",{keyPath:Mg});f.createIndex("documentKeyIndex",Pg),f.createIndex("collectionGroupIndex",Lg)}(e)).next(()=>this.Ws(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),i<14&&r>=14&&(u=u.next(()=>this.zs(e,s))),i<15&&r>=15&&(u=u.next(()=>function(d){d.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),d.createObjectStore("indexState",{keyPath:Zg}).createIndex("sequenceNumberIndex",qg,{unique:!1}),d.createObjectStore("indexEntries",{keyPath:Gg}).createIndex("documentKeyIndex",Wg,{unique:!1})}(e))),u}Ks(e){let t=0;return e.store("remoteDocuments").Z((i,r)=>{t+=sl(r)}).next(()=>{const i={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",i)})}Us(e){const t=e.store("mutationQueues"),i=e.store("mutations");return t.W().next(r=>O.forEach(r,s=>{const u=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return i.W("userMutationsIndex",u).next(d=>O.forEach(d,f=>{le(f.userId===s.userId);const m=os(this.yt,f);return lp(e,s.userId,m).next(()=>{})}))}))}Gs(e){const t=e.store("targetDocuments"),i=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(r=>{const s=[];return i.Z((u,d)=>{const f=new Me(u),m=[0,Et(f)];s.push(t.get(m).next(y=>y?O.resolve():t.put({targetId:0,path:Et(f),sequenceNumber:r.highestListenSequenceNumber})))}).next(()=>O.waitFor(s))})}Qs(e,t){e.createObjectStore("collectionParents",{keyPath:Bg});const i=t.store("collectionParents"),r=new Vh,s=u=>{if(r.add(u)){const d=u.lastSegment(),f=u.popLast();return i.put({collectionId:d,parent:Et(f)})}};return t.store("remoteDocuments").Z({X:!0},(u,d)=>{const f=new Me(u);return s(f.popLast())}).next(()=>t.store("documentMutations").Z({X:!0},([u,d,f],m)=>{const y=bn(d);return s(y.popLast())}))}js(e){const t=e.store("targets");return t.Z((i,r)=>{const s=hu(r),u=Qf(this.yt,s);return t.put(u)})}Ws(e,t){const i=t.store("remoteDocuments"),r=[];return i.Z((s,u)=>{const d=t.store("remoteDocumentsV14"),f=(m=u,m.document?new ee(Me.fromString(m.document.name).popFirst(5)):m.noDocument?ee.fromSegments(m.noDocument.path):m.unknownDocument?ee.fromSegments(m.unknownDocument.path):Y()).path.toArray();var m;const y={prefixPath:f.slice(0,f.length-2),collectionGroup:f[f.length-2],documentId:f[f.length-1],readTime:u.readTime||[0,0],unknownDocument:u.unknownDocument,noDocument:u.noDocument,document:u.document,hasCommittedMutations:!!u.hasCommittedMutations};r.push(d.put(y))}).next(()=>O.waitFor(r))}zs(e,t){const i=t.store("mutations"),r=gp(this.yt),s=new bp(ul.Bs,this.yt.ie);return i.W().next(u=>{const d=new Map;return u.forEach(f=>{var m;let y=null!==(m=d.get(f.userId))&&void 0!==m?m:Ae();os(this.yt,f).keys().forEach(w=>y=y.add(w)),d.set(f.userId,y)}),O.forEach(d,(f,m)=>{const y=new gt(m),w=tl.re(this.yt,y),C=s.getIndexManager(y),B=ol.re(y,this.yt,C,s.referenceDelegate);return new Ip(r,B,w,C).recalculateAndSaveOverlaysForDocumentKeys(new Dh(t,Dt.at),f).next()})})}}function wp(n){n.createObjectStore("targetDocuments",{keyPath:Ug}).createIndex("documentTargetsIndex",Vg,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",Fg,{unique:!0}),n.createObjectStore("targetGlobal")}const Zh="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class qh{constructor(e,t,i,r,s,u,d,f,m,y,w=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.Hs=s,this.window=u,this.document=d,this.Js=m,this.Ys=y,this.Xs=w,this.Ss=null,this.Ds=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Zs=null,this.inForeground=!1,this.ti=null,this.ei=null,this.ni=Number.NEGATIVE_INFINITY,this.si=C=>Promise.resolve(),!qh.C())throw new q(M.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new l_(this,r),this.ii=t+"main",this.yt=new Hf(f),this.ri=new tn(this.ii,this.Xs,new b_(this.yt)),this.Cs=new o_(this.referenceDelegate,this.yt),this.remoteDocumentCache=gp(this.yt),this.Ns=new Qg,this.window&&this.window.localStorage?this.oi=this.window.localStorage:(this.oi=null,!1===y&&ot("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.ui().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new q(M.FAILED_PRECONDITION,Zh);return this.ci(),this.ai(),this.hi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Cs.getHighestSequenceNumber(e))}).then(e=>{this.Ss=new Dt(e,this.Js)}).then(()=>{this.Ds=!0}).catch(e=>(this.ri&&this.ri.close(),Promise.reject(e)))}li(e){var t=this;return this.si=function(){var i=(0,k.Z)(function*(r){if(t.started)return e(r)});return function(r){return i.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.ri.L(function(){var t=(0,k.Z)(function*(i){null===i.newVersion&&(yield e())});return function(i){return t.apply(this,arguments)}}())}setNetworkEnabled(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.Hs.enqueueAndForget((0,k.Z)(function*(){t.started&&(yield t.ui())})))}ui(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>cl(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.fi(e).next(t=>{t||(this.isPrimary=!1,this.Hs.enqueueRetryable(()=>this.si(!1)))})}).next(()=>this.di(e)).next(t=>this.isPrimary&&!t?this._i(e).next(()=>!1):!!t&&this.wi(e).next(()=>!0))).catch(e=>{if(Zn(e))return K("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return K("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Hs.enqueueRetryable(()=>this.si(e)),this.isPrimary=e})}fi(e){return _u(e).get("owner").next(t=>O.resolve(this.mi(t)))}gi(e){return cl(e).delete(this.clientId)}yi(){var e=this;return(0,k.Z)(function*(){if(e.isPrimary&&!e.pi(e.ni,18e5)){e.ni=Date.now();const t=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",i=>{const r=Tt(i,"clientMetadata");return r.W().next(s=>{const u=e.Ii(s,18e5),d=s.filter(f=>-1===u.indexOf(f));return O.forEach(d,f=>r.delete(f.clientId)).next(()=>d)})}).catch(()=>[]);if(e.oi)for(const i of t)e.oi.removeItem(e.Ti(i.clientId))}})()}hi(){this.ei=this.Hs.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.ui().then(()=>this.yi()).then(()=>this.hi()))}mi(e){return!!e&&e.ownerId===this.clientId}di(e){return this.Ys?O.resolve(!0):_u(e).get("owner").next(t=>{if(null!==t&&this.pi(t.leaseTimestampMs,5e3)&&!this.Ei(t.ownerId)){if(this.mi(t)&&this.networkEnabled)return!0;if(!this.mi(t)){if(!t.allowTabSynchronization)throw new q(M.FAILED_PRECONDITION,Zh);return!1}}return!(!this.networkEnabled||!this.inForeground)||cl(e).W().next(i=>void 0===this.Ii(i,5e3).find(r=>{if(this.clientId!==r.clientId){const u=!this.inForeground&&r.inForeground,d=this.networkEnabled===r.networkEnabled;if(!this.networkEnabled&&r.networkEnabled||u&&d)return!0}return!1}))}).next(t=>(this.isPrimary!==t&&K("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){var e=this;return(0,k.Z)(function*(){e.Ds=!1,e.Ai(),e.ei&&(e.ei.cancel(),e.ei=null),e.Ri(),e.bi(),yield e.ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],t=>{const i=new Dh(t,Dt.at);return e._i(i).next(()=>e.gi(i))}),e.ri.close(),e.Pi()})()}Ii(e,t){return e.filter(i=>this.pi(i.updateTimeMs,t)&&!this.Ei(i.clientId))}vi(){return this.runTransaction("getActiveClients","readonly",e=>cl(e).W().next(t=>this.Ii(t,18e5).map(i=>i.clientId)))}get started(){return this.Ds}getMutationQueue(e,t){return ol.re(e,this.yt,t,this.referenceDelegate)}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new s_(e,this.yt.ie.databaseId)}getDocumentOverlayCache(e){return tl.re(this.yt,e)}getBundleCache(){return this.Ns}runTransaction(e,t,i){K("IndexedDbPersistence","Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite",s=15===(u=this.Xs)?Hg:14===u?$f:13===u?zf:12===u?$g:11===u?jf:void Y();var u;let d;return this.ri.runTransaction(e,r,s,f=>(d=new Dh(f,this.Ss?this.Ss.next():Dt.at),"readwrite-primary"===t?this.fi(d).next(m=>!!m||this.di(d)).next(m=>{if(!m)throw ot(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Hs.enqueueRetryable(()=>this.si(!1)),new q(M.FAILED_PRECONDITION,yc);return i(d)}).next(m=>this.wi(d).next(()=>m)):this.Vi(d).next(()=>i(d)))).then(f=>(d.raiseOnCommittedEvent(),f))}Vi(e){return _u(e).get("owner").next(t=>{if(null!==t&&this.pi(t.leaseTimestampMs,5e3)&&!this.Ei(t.ownerId)&&!this.mi(t)&&!(this.Ys||this.allowTabSynchronization&&t.allowTabSynchronization))throw new q(M.FAILED_PRECONDITION,Zh)})}wi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return _u(e).put("owner",t)}static C(){return tn.C()}_i(e){const t=_u(e);return t.get("owner").next(i=>this.mi(i)?(K("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):O.resolve())}pi(e,t){const i=Date.now();return!(e<i-t||e>i&&(ot(`Detected an update time that is in the future: ${e} > ${i}`),1))}ci(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ti=()=>{this.Hs.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.ui()))},this.document.addEventListener("visibilitychange",this.ti),this.inForeground="visible"===this.document.visibilityState)}Ri(){this.ti&&(this.document.removeEventListener("visibilitychange",this.ti),this.ti=null)}ai(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Zs=()=>{this.Ai(),(0,Q.G6)()&&navigator.appVersion.match(/Version\/1[45]/)&&this.Hs.enterRestrictedMode(!0),this.Hs.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Zs))}bi(){this.Zs&&(this.window.removeEventListener("pagehide",this.Zs),this.Zs=null)}Ei(e){var t;try{const i=null!==(null===(t=this.oi)||void 0===t?void 0:t.getItem(this.Ti(e)));return K("IndexedDbPersistence",`Client '${e}' ${i?"is":"is not"} zombied in LocalStorage`),i}catch(i){return ot("IndexedDbPersistence","Failed to get zombied client id.",i),!1}}Ai(){if(this.oi)try{this.oi.setItem(this.Ti(this.clientId),String(Date.now()))}catch(e){ot("Failed to set zombie client id.",e)}}Pi(){if(this.oi)try{this.oi.removeItem(this.Ti(this.clientId))}catch(e){}}Ti(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function _u(n){return Tt(n,"owner")}function cl(n){return Tt(n,"clientMetadata")}function Gh(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Wh{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Si=i,this.Di=r}static Ci(e,t){let i=Ae(),r=Ae();for(const s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new Wh(e,t.fromCache,i,r)}}class Ep{constructor(){this.xi=!1}initialize(e,t){this.Ni=e,this.indexManager=t,this.xi=!0}getDocumentsMatchingQuery(e,t,i,r){return this.ki(e,t).next(s=>s||this.Oi(e,t,r,i)).next(s=>s||this.Mi(e,t))}ki(e,t){if(ja(t))return O.resolve(null);let i=wt(t);return this.indexManager.getIndexType(e,i).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=yo(t,null,"F"),i=wt(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(s=>{const u=Ae(...s);return this.Ni.getDocuments(e,u).next(d=>this.indexManager.getMinOffset(e,i).next(f=>{const m=this.Fi(t,d);return this.$i(t,m,u,f.readTime)?this.ki(e,yo(t,null,"F")):this.Bi(e,m,t,f)}))})))}Oi(e,t,i,r){return ja(t)||r.isEqual(fe.min())?this.Mi(e,t):this.Ni.getDocuments(e,i).next(s=>{const u=this.Fi(t,s);return this.$i(t,u,i,r)?this.Mi(e,t):(hc()<=ae.in.DEBUG&&K("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Ya(t)),this.Bi(e,u,t,gc(r,-1)))})}Fi(e,t){let i=new Ge(Eh(e));return t.forEach((r,s)=>{vo(e,s)&&(i=i.add(s))}),i}$i(e,t,i,r){if(null===e.limit)return!1;if(i.size!==t.size)return!0;const s="F"===e.limitType?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Mi(e,t){return hc()<=ae.in.DEBUG&&K("QueryEngine","Using full collection scan to execute query:",Ya(t)),this.Ni.getDocumentsMatchingQuery(e,t,Ct.min())}Bi(e,t,i,r){return this.Ni.getDocumentsMatchingQuery(e,i,r).next(s=>(t.forEach(u=>{s=s.insert(u.key,u)}),s))}}class w_{constructor(e,t,i,r){this.persistence=e,this.Li=t,this.yt=r,this.qi=new rt(we),this.Ui=new $n(s=>Kn(s),zr),this.Ki=new Map,this.Gi=e.getRemoteDocumentCache(),this.Cs=e.getTargetCache(),this.Ns=e.getBundleCache(),this.Qi(i)}Qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Ip(this.Gi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Gi.setIndexManager(this.indexManager),this.Li.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.qi))}}function Tp(n,e,t,i){return new w_(n,e,t,i)}function Ap(n,e){return Kh.apply(this,arguments)}function Kh(){return Kh=(0,k.Z)(function*(n,e){const t=ie(n);return yield t.persistence.runTransaction("Handle user change","readonly",i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next(s=>(r=s,t.Qi(e),t.mutationQueue.getAllMutationBatches(i))).next(s=>{const u=[],d=[];let f=Ae();for(const m of r){u.push(m.batchId);for(const y of m.mutations)f=f.add(y.key)}for(const m of s){d.push(m.batchId);for(const y of m.mutations)f=f.add(y.key)}return t.localDocuments.getDocuments(i,f).next(m=>({ji:m,removedBatchIds:u,addedBatchIds:d}))})})}),Kh.apply(this,arguments)}function E_(n,e){const t=ie(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const r=e.batch.keys(),s=t.Gi.newChangeBuffer({trackRemovals:!0});return function(u,d,f,m){const y=f.batch,w=y.keys();let C=O.resolve();return w.forEach(B=>{C=C.next(()=>m.getEntry(d,B)).next(G=>{const ne=f.docVersions.get(B);le(null!==ne),G.version.compareTo(ne)<0&&(y.applyToRemoteDocument(G,f),G.isValidDocument()&&(G.setReadTime(f.commitVersion),m.addEntry(G)))})}),C.next(()=>u.mutationQueue.removeMutationBatch(d,y))}(t,i,e,s).next(()=>s.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(u){let d=Ae();for(let f=0;f<u.mutationResults.length;++f)u.mutationResults[f].transformResults.length>0&&(d=d.add(u.batch.mutations[f].key));return d}(e))).next(()=>t.localDocuments.getDocuments(i,r))})}function xp(n){const e=ie(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Cs.getLastRemoteSnapshotVersion(t))}function T_(n,e){const t=ie(n),i=e.snapshotVersion;let r=t.qi;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const u=t.Gi.newChangeBuffer({trackRemovals:!0});r=t.qi;const d=[];e.targetChanges.forEach((y,w)=>{const C=r.get(w);if(!C)return;d.push(t.Cs.removeMatchingKeys(s,y.removedDocuments,w).next(()=>t.Cs.addMatchingKeys(s,y.addedDocuments,w)));let B=C.withSequenceNumber(s.currentSequenceNumber);var G,ne,ce;e.targetMismatches.has(w)?B=B.withResumeToken(at.EMPTY_BYTE_STRING,fe.min()).withLastLimboFreeSnapshotVersion(fe.min()):y.resumeToken.approximateByteSize()>0&&(B=B.withResumeToken(y.resumeToken,i)),r=r.insert(w,B),ne=B,ce=y,(0===(G=C).resumeToken.approximateByteSize()||ne.snapshotVersion.toMicroseconds()-G.snapshotVersion.toMicroseconds()>=3e8||ce.addedDocuments.size+ce.modifiedDocuments.size+ce.removedDocuments.size>0)&&d.push(t.Cs.updateTargetData(s,B))});let f=Rt(),m=Ae();if(e.documentUpdates.forEach(y=>{e.resolvedLimboDocuments.has(y)&&d.push(t.persistence.referenceDelegate.updateLimboDocument(s,y))}),d.push(kp(s,u,e.documentUpdates).next(y=>{f=y.Wi,m=y.zi})),!i.isEqual(fe.min())){const y=t.Cs.getLastRemoteSnapshotVersion(s).next(w=>t.Cs.setTargetsMetadata(s,s.currentSequenceNumber,i));d.push(y)}return O.waitFor(d).next(()=>u.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,f,m)).next(()=>f)}).then(s=>(t.qi=r,s))}function kp(n,e,t){let i=Ae(),r=Ae();return t.forEach(s=>i=i.add(s)),e.getEntries(n,i).next(s=>{let u=Rt();return t.forEach((d,f)=>{const m=s.get(d);f.isFoundDocument()!==m.isFoundDocument()&&(r=r.add(d)),f.isNoDocument()&&f.version.isEqual(fe.min())?(e.removeEntry(d,f.readTime),u=u.insert(d,f)):!m.isValidDocument()||f.version.compareTo(m.version)>0||0===f.version.compareTo(m.version)&&m.hasPendingWrites?(e.addEntry(f),u=u.insert(d,f)):K("LocalStore","Ignoring outdated watch update for ",d,". Current version:",m.version," Watch version:",f.version)}),{Wi:u,zi:r}})}function A_(n,e){const t=ie(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function No(n,e){const t=ie(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return t.Cs.getTargetData(i,e).next(s=>s?(r=s,O.resolve(r)):t.Cs.allocateTargetId(i).next(u=>(r=new ar(e,u,0,i.currentSequenceNumber),t.Cs.addTargetData(i,r).next(()=>r))))}).then(i=>{const r=t.qi.get(i.targetId);return(null===r||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.qi=t.qi.insert(i.targetId,i),t.Ui.set(e,i.targetId)),i})}function Mo(n,e,t){return jh.apply(this,arguments)}function jh(){return jh=(0,k.Z)(function*(n,e,t){const i=ie(n),r=i.qi.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield i.persistence.runTransaction("Release target",s,u=>i.persistence.referenceDelegate.removeTarget(u,r)))}catch(u){if(!Zn(u))throw u;K("LocalStore",`Failed to update sequence numbers for target ${e}: ${u}`)}i.qi=i.qi.remove(e),i.Ui.delete(r.target)}),jh.apply(this,arguments)}function ll(n,e,t){const i=ie(n);let r=fe.min(),s=Ae();return i.persistence.runTransaction("Execute query","readonly",u=>function(d,f,m){const y=ie(d),w=y.Ui.get(m);return void 0!==w?O.resolve(y.qi.get(w)):y.Cs.getTargetData(f,m)}(i,u,wt(e)).next(d=>{if(d)return r=d.lastLimboFreeSnapshotVersion,i.Cs.getMatchingKeysForTargetId(u,d.targetId).next(f=>{s=f})}).next(()=>i.Li.getDocumentsMatchingQuery(u,e,t?r:fe.min(),t?s:Ae())).next(d=>(Sp(i,Nc(e),d),{documents:d,Hi:s})))}function Cp(n,e){const t=ie(n),i=ie(t.Cs),r=t.qi.get(e);return r?Promise.resolve(r.target):t.persistence.runTransaction("Get target data","readonly",s=>i.ne(s,e).next(u=>u?u.target:null))}function Dp(n,e){const t=ie(n),i=t.Ki.get(e)||fe.min();return t.persistence.runTransaction("Get new document changes","readonly",r=>t.Gi.getAllFromCollectionGroup(r,e,gc(i,-1),Number.MAX_SAFE_INTEGER)).then(r=>(Sp(t,e,r),r))}function Sp(n,e,t){let i=n.Ki.get(e)||fe.min();t.forEach((r,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)}),n.Ki.set(e,i)}function zh(){return zh=(0,k.Z)(function*(n,e,t,i){const r=ie(n);let s=Ae(),u=Rt();for(const m of t){const y=e.Ji(m.metadata.name);m.document&&(s=s.add(y));const w=e.Yi(m);w.setReadTime(e.Xi(m.metadata.readTime)),u=u.insert(y,w)}const d=r.Gi.newChangeBuffer({trackRemovals:!0}),f=yield No(r,(m=i,wt(Xi(Me.fromString(`__bundle__/docs/${m}`)))));var m;return r.persistence.runTransaction("Apply bundle documents","readwrite",m=>kp(m,d,u).next(y=>(d.apply(m),y)).next(y=>r.Cs.removeMatchingKeysForTargetId(m,f.targetId).next(()=>r.Cs.addMatchingKeys(m,s,f.targetId)).next(()=>r.localDocuments.getLocalViewOfDocuments(m,y.Wi,y.zi)).next(()=>y.Wi)))}),zh.apply(this,arguments)}function k_(n,e){return $h.apply(this,arguments)}function $h(){return $h=(0,k.Z)(function*(n,e,t=Ae()){const i=yield No(n,wt(Nh(e.bundledQuery))),r=ie(n);return r.persistence.runTransaction("Save named query","readwrite",s=>{const u=st(e.readTime);if(i.snapshotVersion.compareTo(u)>=0)return r.Ns.saveNamedQuery(s,e);const d=i.withResumeToken(at.EMPTY_BYTE_STRING,u);return r.qi=r.qi.insert(d.targetId,d),r.Cs.updateTargetData(s,d).next(()=>r.Cs.removeMatchingKeysForTargetId(s,i.targetId)).next(()=>r.Cs.addMatchingKeys(s,t,i.targetId)).next(()=>r.Ns.saveNamedQuery(s,e))})}),$h.apply(this,arguments)}function Rp(n,e){return`firestore_clients_${n}_${e}`}function Op(n,e,t){let i=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(i+=`_${e.uid}`),i}function Hh(n,e){return`firestore_targets_${n}_${e}`}class hl{constructor(e,t,i,r){this.user=e,this.batchId=t,this.state=i,this.error=r}static Zi(e,t,i){const r=JSON.parse(i);let s,u="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return u&&r.error&&(u="string"==typeof r.error.message&&"string"==typeof r.error.code,u&&(s=new q(r.error.code,r.error.message))),u?new hl(e,t,r.state,s):(ot("SharedClientState",`Failed to parse mutation state for ID '${t}': ${i}`),null)}tr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class yu{constructor(e,t,i){this.targetId=e,this.state=t,this.error=i}static Zi(e,t){const i=JSON.parse(t);let r,s="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return s&&i.error&&(s="string"==typeof i.error.message&&"string"==typeof i.error.code,s&&(r=new q(i.error.code,i.error.message))),s?new yu(e,i.state,r):(ot("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}tr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class dl{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Zi(e,t){const i=JSON.parse(t);let r="object"==typeof i&&i.activeTargetIds instanceof Array,s=sr();for(let u=0;r&&u<i.activeTargetIds.length;++u)r=Ic(i.activeTargetIds[u]),s=s.add(i.activeTargetIds[u]);return r?new dl(e,s):(ot("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class Yh{constructor(e,t){this.clientId=e,this.onlineState=t}static Zi(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new Yh(t.clientId,t.onlineState):(ot("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Qh{constructor(){this.activeTargetIds=sr()}er(e){this.activeTargetIds=this.activeTargetIds.add(e)}nr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}tr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Jh{constructor(e,t,i,r,s){this.window=e,this.Hs=t,this.persistenceKey=i,this.sr=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ir=this.rr.bind(this),this.ur=new rt(we),this.started=!1,this.cr=[];const u=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ar=Rp(this.persistenceKey,this.sr),this.hr=`firestore_sequence_number_${this.persistenceKey}`,this.ur=this.ur.insert(this.sr,new Qh),this.lr=new RegExp(`^firestore_clients_${u}_([^_]*)$`),this.dr=new RegExp(`^firestore_mutations_${u}_(\\d+)(?:_(.*))?$`),this._r=new RegExp(`^firestore_targets_${u}_(\\d+)$`),this.wr=`firestore_online_state_${this.persistenceKey}`,this.mr=function(d){return`firestore_bundle_loaded_v2_${d}`}(this.persistenceKey),this.window.addEventListener("storage",this.ir)}static C(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,k.Z)(function*(){const t=yield e.syncEngine.vi();for(const r of t){if(r===e.sr)continue;const s=e.getItem(Rp(e.persistenceKey,r));if(s){const u=dl.Zi(r,s);u&&(e.ur=e.ur.insert(u.clientId,u))}}e.gr();const i=e.storage.getItem(e.wr);if(i){const r=e.yr(i);r&&e.pr(r)}for(const r of e.cr)e.rr(r);e.cr=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.hr,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ir(this.ur)}isActiveQueryTarget(e){let t=!1;return this.ur.forEach((i,r)=>{r.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Tr(e,"pending")}updateMutationState(e,t,i){this.Tr(e,t,i),this.Er(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(Hh(this.persistenceKey,e));if(i){const r=yu.Zi(e,i);r&&(t=r.state)}}return this.Ar.er(e),this.gr(),t}removeLocalQueryTarget(e){this.Ar.nr(e),this.gr()}isLocalQueryTarget(e){return this.Ar.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Hh(this.persistenceKey,e))}updateQueryState(e,t,i){this.Rr(e,t,i)}handleUserChange(e,t,i){t.forEach(r=>{this.Er(r)}),this.currentUser=e,i.forEach(r=>{this.addPendingMutation(r)})}setOnlineState(e){this.br(e)}notifyBundleLoaded(e){this.Pr(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ir),this.removeItem(this.ar),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return K("SharedClientState","READ",e,t),t}setItem(e,t){K("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){K("SharedClientState","REMOVE",e),this.storage.removeItem(e)}rr(e){var t=this;const i=e;if(i.storageArea===this.storage){if(K("SharedClientState","EVENT",i.key,i.newValue),i.key===this.ar)return void ot("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Hs.enqueueRetryable((0,k.Z)(function*(){if(t.started){if(null!==i.key)if(t.lr.test(i.key)){if(null==i.newValue){const r=t.vr(i.key);return t.Vr(r,null)}{const r=t.Sr(i.key,i.newValue);if(r)return t.Vr(r.clientId,r)}}else if(t.dr.test(i.key)){if(null!==i.newValue){const r=t.Dr(i.key,i.newValue);if(r)return t.Cr(r)}}else if(t._r.test(i.key)){if(null!==i.newValue){const r=t.Nr(i.key,i.newValue);if(r)return t.kr(r)}}else if(i.key===t.wr){if(null!==i.newValue){const r=t.yr(i.newValue);if(r)return t.pr(r)}}else if(i.key===t.hr){const r=function(s){let u=Dt.at;if(null!=s)try{const d=JSON.parse(s);le("number"==typeof d),u=d}catch(d){ot("SharedClientState","Failed to read sequence number from WebStorage",d)}return u}(i.newValue);r!==Dt.at&&t.sequenceNumberHandler(r)}else if(i.key===t.mr){const r=t.Or(i.newValue);yield Promise.all(r.map(s=>t.syncEngine.Mr(s)))}}else t.cr.push(i)}))}}get Ar(){return this.ur.get(this.sr)}gr(){this.setItem(this.ar,this.Ar.tr())}Tr(e,t,i){const r=new hl(this.currentUser,e,t,i),s=Op(this.persistenceKey,this.currentUser,e);this.setItem(s,r.tr())}Er(e){const t=Op(this.persistenceKey,this.currentUser,e);this.removeItem(t)}br(e){this.storage.setItem(this.wr,JSON.stringify({clientId:this.sr,onlineState:e}))}Rr(e,t,i){const r=Hh(this.persistenceKey,e),s=new yu(e,t,i);this.setItem(r,s.tr())}Pr(e){const t=JSON.stringify(Array.from(e));this.setItem(this.mr,t)}vr(e){const t=this.lr.exec(e);return t?t[1]:null}Sr(e,t){const i=this.vr(e);return dl.Zi(i,t)}Dr(e,t){const i=this.dr.exec(e),r=Number(i[1]);return hl.Zi(new gt(void 0!==i[2]?i[2]:null),r,t)}Nr(e,t){const i=this._r.exec(e),r=Number(i[1]);return yu.Zi(r,t)}yr(e){return Yh.Zi(e)}Or(e){return JSON.parse(e)}Cr(e){var t=this;return(0,k.Z)(function*(){if(e.user.uid===t.currentUser.uid)return t.syncEngine.Fr(e.batchId,e.state,e.error);K("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}kr(e){return this.syncEngine.$r(e.targetId,e.state,e.error)}Vr(e,t){const i=t?this.ur.insert(e,t):this.ur.remove(e),r=this.Ir(this.ur),s=this.Ir(i),u=[],d=[];return s.forEach(f=>{r.has(f)||u.push(f)}),r.forEach(f=>{s.has(f)||d.push(f)}),this.syncEngine.Br(u,d).then(()=>{this.ur=i})}pr(e){this.ur.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ir(e){let t=sr();return e.forEach((i,r)=>{t=t.unionWith(r.activeTargetIds)}),t}}class Np{constructor(){this.Lr=new Qh,this.qr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e){return this.Lr.er(e),this.qr[e]||"not-current"}updateQueryState(e,t,i){this.qr[e]=t}removeLocalQueryTarget(e){this.Lr.nr(e)}isLocalQueryTarget(e){return this.Lr.activeTargetIds.has(e)}clearQueryState(e){delete this.qr[e]}getAllActiveQueryTargets(){return this.Lr.activeTargetIds}isActiveQueryTarget(e){return this.Lr.activeTargetIds.has(e)}start(){return this.Lr=new Qh,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class C_{Ur(e){}shutdown(){}}class Mp{constructor(){this.Kr=()=>this.Gr(),this.Qr=()=>this.jr(),this.Wr=[],this.zr()}Ur(e){this.Wr.push(e)}shutdown(){window.removeEventListener("online",this.Kr),window.removeEventListener("offline",this.Qr)}zr(){window.addEventListener("online",this.Kr),window.addEventListener("offline",this.Qr)}Gr(){K("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Wr)e(0)}jr(){K("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Wr)e(1)}static C(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const D_={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class S_{constructor(e){this.Hr=e.Hr,this.Jr=e.Jr}Yr(e){this.Xr=e}Zr(e){this.eo=e}onMessage(e){this.no=e}close(){this.Jr()}send(e){this.Hr(e)}so(){this.Xr()}io(e){this.eo(e)}ro(e){this.no(e)}}class R_ extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.oo=(e.ssl?"https":"http")+"://"+e.host,this.uo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get co(){return!1}ao(e,t,i,r,s){const u=this.ho(e,t);K("RestConnection","Sending: ",u,i);const d={};return this.lo(d,r,s),this.fo(e,u,d,i).then(f=>(K("RestConnection","Received: ",f),f),f=>{throw en("RestConnection",`${e} failed with error: `,f,"url: ",u,"request:",i),f})}_o(e,t,i,r,s,u){return this.ao(e,t,i,r,s)}lo(e,t,i){e["X-Goog-Api-Client"]="gl-js/ fire/"+Ur,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((r,s)=>e[s]=r),i&&i.headers.forEach((r,s)=>e[s]=r)}ho(e,t){return`${this.oo}/v1/${t}:${D_[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}fo(e,t,i,r){return new Promise((s,u)=>{const d=new uh;d.setWithCredentials(!0),d.listenOnce(Aa.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Ta.NO_ERROR:const m=d.getResponseJson();K("Connection","XHR received:",JSON.stringify(m)),s(m);break;case Ta.TIMEOUT:K("Connection",'RPC "'+e+'" timed out'),u(new q(M.DEADLINE_EXCEEDED,"Request time out"));break;case Ta.HTTP_ERROR:const y=d.getStatus();if(K("Connection",'RPC "'+e+'" failed with status:',y,"response text:",d.getResponseText()),y>0){let w=d.getResponseJson();Array.isArray(w)&&(w=w[0]);const C=null==w?void 0:w.error;if(C&&C.status&&C.message){const B=function(G){const ne=G.toLowerCase().replace(/_/g,"-");return Object.values(M).indexOf(ne)>=0?ne:M.UNKNOWN}(C.status);u(new q(B,C.message))}else u(new q(M.UNKNOWN,"Server responded with status "+d.getStatus()))}else u(new q(M.UNAVAILABLE,"Connection failed."));break;default:Y()}}finally{K("Connection",'RPC "'+e+'" completed.')}});const f=JSON.stringify(r);d.send(t,"POST",f,i,15)})}wo(e,t,i){const r=[this.oo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=oh(),u=ah(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(d.xmlHttpFactory=new js({})),this.lo(d.initMessageHeaders,t,i),d.encodeInitMessageHeaders=!0;const f=r.join("");K("Connection","Creating WebChannel: "+f,d);const m=s.createWebChannel(f,d);let y=!1,w=!1;const C=new S_({Hr:G=>{w?K("Connection","Not sending because WebChannel is closed:",G):(y||(K("Connection","Opening WebChannel transport."),m.open(),y=!0),K("Connection","WebChannel sending:",G),m.send(G))},Jr:()=>m.close()}),B=(G,ne,ce)=>{G.listen(ne,Ue=>{try{ce(Ue)}catch(je){setTimeout(()=>{throw je},0)}})};return B(m,Fr.EventType.OPEN,()=>{w||K("Connection","WebChannel transport opened.")}),B(m,Fr.EventType.CLOSE,()=>{w||(w=!0,K("Connection","WebChannel transport closed"),C.io())}),B(m,Fr.EventType.ERROR,G=>{w||(w=!0,en("Connection","WebChannel transport errored:",G),C.io(new q(M.UNAVAILABLE,"The operation could not be completed")))}),B(m,Fr.EventType.MESSAGE,G=>{var ne;if(!w){const ce=G.data[0];le(!!ce);const Ue=ce,je=Ue.error||(null===(ne=Ue[0])||void 0===ne?void 0:ne.error);if(je){K("Connection","WebChannel received error:",je);const Oe=je.status;let Ce=function(De){const bt=ut[De];if(void 0!==bt)return jc(bt)}(Oe),ke=je.message;void 0===Ce&&(Ce=M.INTERNAL,ke="Unknown error status: "+Oe+" with message "+je.message),w=!0,C.io(new q(Ce,ke)),m.close()}else K("Connection","WebChannel received:",ce),C.ro(ce)}}),B(u,xa.STAT_EVENT,G=>{G.stat===cc.PROXY?K("Connection","Detected buffering proxy"):G.stat===cc.NOPROXY&&K("Connection","Detected no buffering proxy")}),setTimeout(()=>{C.so()},0),C}}function Pp(){return"undefined"!=typeof window?window:null}function fl(){return"undefined"!=typeof document?document:null}function vu(n){return new ru(n,!0)}class Xh{constructor(e,t,i=1e3,r=1.5,s=6e4){this.Hs=e,this.timerId=t,this.mo=i,this.yo=r,this.po=s,this.Io=0,this.To=null,this.Eo=Date.now(),this.reset()}reset(){this.Io=0}Ao(){this.Io=this.po}Ro(e){this.cancel();const t=Math.floor(this.Io+this.bo()),i=Math.max(0,Date.now()-this.Eo),r=Math.max(0,t-i);r>0&&K("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Io} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.To=this.Hs.enqueueAfterDelay(this.timerId,r,()=>(this.Eo=Date.now(),e())),this.Io*=this.yo,this.Io<this.mo&&(this.Io=this.mo),this.Io>this.po&&(this.Io=this.po)}Po(){null!==this.To&&(this.To.skipDelay(),this.To=null)}cancel(){null!==this.To&&(this.To.cancel(),this.To=null)}bo(){return(Math.random()-.5)*this.Io}}class Lp{constructor(e,t,i,r,s,u,d,f){this.Hs=e,this.vo=i,this.Vo=r,this.connection=s,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=d,this.listener=f,this.state=0,this.So=0,this.Do=null,this.Co=null,this.stream=null,this.xo=new Xh(e,t)}No(){return 1===this.state||5===this.state||this.ko()}ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Oo()}stop(){var e=this;return(0,k.Z)(function*(){e.No()&&(yield e.close(0))})()}Mo(){this.state=0,this.xo.reset()}Fo(){this.ko()&&null===this.Do&&(this.Do=this.Hs.enqueueAfterDelay(this.vo,6e4,()=>this.$o()))}Bo(e){this.Lo(),this.stream.send(e)}$o(){var e=this;return(0,k.Z)(function*(){if(e.ko())return e.close(0)})()}Lo(){this.Do&&(this.Do.cancel(),this.Do=null)}qo(){this.Co&&(this.Co.cancel(),this.Co=null)}close(e,t){var i=this;return(0,k.Z)(function*(){i.Lo(),i.qo(),i.xo.cancel(),i.So++,4!==e?i.xo.reset():t&&t.code===M.RESOURCE_EXHAUSTED?(ot(t.toString()),ot("Using maximum backoff delay to prevent overloading the backend."),i.xo.Ao()):t&&t.code===M.UNAUTHENTICATED&&3!==i.state&&(i.authCredentialsProvider.invalidateToken(),i.appCheckCredentialsProvider.invalidateToken()),null!==i.stream&&(i.Uo(),i.stream.close(),i.stream=null),i.state=e,yield i.listener.Zr(t)})()}Uo(){}auth(){this.state=1;const e=this.Ko(this.So),t=this.So;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.So===t&&this.Go(i,r)},i=>{e(()=>{const r=new q(M.UNKNOWN,"Fetching auth token failed: "+i.message);return this.Qo(r)})})}Go(e,t){const i=this.Ko(this.So);this.stream=this.jo(e,t),this.stream.Yr(()=>{i(()=>(this.state=2,this.Co=this.Hs.enqueueAfterDelay(this.Vo,1e4,()=>(this.ko()&&(this.state=3),Promise.resolve())),this.listener.Yr()))}),this.stream.Zr(r=>{i(()=>this.Qo(r))}),this.stream.onMessage(r=>{i(()=>this.onMessage(r))})}Oo(){var e=this;this.state=5,this.xo.Ro((0,k.Z)(function*(){e.state=0,e.start()}))}Qo(e){return K("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Ko(e){return t=>{this.Hs.enqueueAndForget(()=>this.So===e?t():(K("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class O_ extends Lp{constructor(e,t,i,r,s,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,u),this.yt=s}jo(e,t){return this.connection.wo("Listen",e,t)}onMessage(e){this.xo.reset();const t=function p(n,e){let t;if("targetChange"in e){const i="NO_CHANGE"===(f=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===f?1:"REMOVE"===f?2:"CURRENT"===f?3:"RESET"===f?4:Y(),r=e.targetChange.targetIds||[],s=function(f,m){return f.wt?(le(void 0===m||"string"==typeof m),at.fromBase64String(m||"")):(le(void 0===m||m instanceof Uint8Array),at.fromUint8Array(m||new Uint8Array))}(n,e.targetChange.resumeToken),u=e.targetChange.cause,d=u&&function(f){const m=void 0===f.code?M.UNKNOWN:jc(f.code);return new q(m,f.message||"")}(u);t=new Rn(i,r,s,d||null)}else if("documentChange"in e){const i=e.documentChange,r=In(n,i.document.name),s=st(i.document.updateTime),u=i.document.createTime?st(i.document.createTime):fe.min(),d=new It({mapValue:{fields:i.document.fields}}),f=Ye.newFoundDocument(r,s,u,d);t=new ts(i.targetIds||[],i.removedTargetIds||[],f.key,f)}else if("documentDelete"in e){const i=e.documentDelete,r=In(n,i.document),s=i.readTime?st(i.readTime):fe.min(),u=Ye.newNoDocument(r,s);t=new ts([],i.removedTargetIds||[],u.key,u)}else if("documentRemove"in e){const i=e.documentRemove,r=In(n,i.document);t=new ts([],i.removedTargetIds||[],r,null)}else{if(!("filter"in e))return Y();{const i=e.filter,s=new Qr(i.count||0);t=new zc(i.targetId,s)}}var f;return t}(this.yt,e),i=function(r){if(!("targetChange"in r))return fe.min();const s=r.targetChange;return s.targetIds&&s.targetIds.length?fe.min():s.readTime?st(s.readTime):fe.min()}(e);return this.listener.Wo(t,i)}zo(e){const t={};t.database=is(this.yt),t.addTarget=function(r,s){let u;const d=s.target;return u=po(d)?{documents:H(r,d)}:{query:se(r,d)},u.targetId=s.targetId,s.resumeToken.approximateByteSize()>0?u.resumeToken=vn(r,s.resumeToken):s.snapshotVersion.compareTo(fe.min())>0&&(u.readTime=or(r,s.snapshotVersion.toTimestamp())),u}(this.yt,e);const i=function pe(n,e){const t=function(i,r){switch(r){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Y()}}(0,e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);i&&(t.labels=i),this.Bo(t)}Ho(e){const t={};t.database=is(this.yt),t.removeTarget=e,this.Bo(t)}}class N_ extends Lp{constructor(e,t,i,r,s,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,u),this.yt=s,this.Jo=!1}get Yo(){return this.Jo}start(){this.Jo=!1,this.lastStreamToken=void 0,super.start()}Uo(){this.Jo&&this.Xo([])}jo(e,t){return this.connection.wo("Write",e,t)}onMessage(e){if(le(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Jo){this.xo.reset();const t=function L(n,e){return n&&n.length>0?(le(void 0!==e),n.map(t=>function(i,r){let s=st(i.updateTime?i.updateTime:r);return s.isEqual(fe.min())&&(s=st(r)),new Ja(s,i.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),i=st(e.commitTime);return this.listener.Zo(i,t)}return le(!e.writeResults||0===e.writeResults.length),this.Jo=!0,this.listener.tu()}eu(){const e={};e.database=is(this.yt),this.Bo(e)}Xo(e){const t={streamToken:this.lastStreamToken,writes:e.map(i=>_(this.yt,i))};this.Bo(t)}}class M_ extends class{}{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.yt=r,this.nu=!1}su(){if(this.nu)throw new q(M.FAILED_PRECONDITION,"The client has already been terminated.")}ao(e,t,i){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,s])=>this.connection.ao(e,t,i,r,s)).catch(r=>{throw"FirebaseError"===r.name?(r.code===M.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new q(M.UNKNOWN,r.toString())})}_o(e,t,i,r){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,u])=>this.connection._o(e,t,i,s,u,r)).catch(s=>{throw"FirebaseError"===s.name?(s.code===M.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new q(M.UNKNOWN,s.toString())})}terminate(){this.nu=!0}}class L_{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.iu=0,this.ru=null,this.ou=!0}uu(){0===this.iu&&(this.cu("Unknown"),this.ru=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.ru=null,this.au("Backend didn't respond within 10 seconds."),this.cu("Offline"),Promise.resolve())))}hu(e){"Online"===this.state?this.cu("Unknown"):(this.iu++,this.iu>=1&&(this.lu(),this.au(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.cu("Offline")))}set(e){this.lu(),this.iu=0,"Online"===e&&(this.ou=!1),this.cu(e)}cu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}au(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ou?(ot(t),this.ou=!1):K("OnlineStateTracker",t)}lu(){null!==this.ru&&(this.ru.cancel(),this.ru=null)}}class F_{constructor(e,t,i,r,s){var u=this;this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.fu=[],this.du=new Map,this._u=new Set,this.wu=[],this.mu=s,this.mu.Ur(d=>{i.enqueueAndForget((0,k.Z)(function*(){var f;Ti(u)&&(K("RemoteStore","Restarting streams for network reachability change."),yield(f=(0,k.Z)(function*(m){const y=ie(m);y._u.add(4),yield Po(y),y.gu.set("Unknown"),y._u.delete(4),yield Iu(y)}),function(m){return f.apply(this,arguments)})(u))}))}),this.gu=new L_(i,r)}}function Iu(n){return td.apply(this,arguments)}function td(){return td=(0,k.Z)(function*(n){if(Ti(n))for(const e of n.wu)yield e(!0)}),td.apply(this,arguments)}function Po(n){return nd.apply(this,arguments)}function nd(){return nd=(0,k.Z)(function*(n){for(const e of n.wu)yield e(!1)}),nd.apply(this,arguments)}function pl(n,e){const t=ie(n);t.du.has(e.targetId)||(t.du.set(e.targetId,e),sd(t)?rd(t):Fo(t).ko()&&id(t,e))}function bu(n,e){const t=ie(n),i=Fo(t);t.du.delete(e),i.ko()&&Fp(t,e),0===t.du.size&&(i.ko()?i.Fo():Ti(t)&&t.gu.set("Unknown"))}function id(n,e){n.yu.Ot(e.targetId),Fo(n).zo(e)}function Fp(n,e){n.yu.Ot(e),Fo(n).Ho(e)}function rd(n){n.yu=new Ch({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ne:e=>n.du.get(e)||null}),Fo(n).start(),n.gu.uu()}function sd(n){return Ti(n)&&!Fo(n).No()&&n.du.size>0}function Ti(n){return 0===ie(n)._u.size}function Up(n){n.yu=void 0}function U_(n){return od.apply(this,arguments)}function od(){return od=(0,k.Z)(function*(n){n.du.forEach((e,t)=>{id(n,e)})}),od.apply(this,arguments)}function V_(n,e){return ad.apply(this,arguments)}function ad(){return ad=(0,k.Z)(function*(n,e){Up(n),sd(n)?(n.gu.hu(e),rd(n)):n.gu.set("Unknown")}),ad.apply(this,arguments)}function B_(n,e,t){return ud.apply(this,arguments)}function ud(){return ud=(0,k.Z)(function*(n,e,t){if(n.gu.set("Online"),e instanceof Rn&&2===e.state&&e.cause)try{yield(i=(0,k.Z)(function*(r,s){const u=s.cause;for(const d of s.targetIds)r.du.has(d)&&(yield r.remoteSyncer.rejectListen(d,u),r.du.delete(d),r.yu.removeTarget(d))}),function(r,s){return i.apply(this,arguments)})(n,e)}catch(i){K("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),i),yield ml(n,i)}else if(e instanceof ts?n.yu.Kt(e):e instanceof zc?n.yu.Jt(e):n.yu.jt(e),!t.isEqual(fe.min()))try{const i=yield xp(n.localStore);t.compareTo(i)>=0&&(yield function(r,s){const u=r.yu.Zt(s);return u.targetChanges.forEach((d,f)=>{if(d.resumeToken.approximateByteSize()>0){const m=r.du.get(f);m&&r.du.set(f,m.withResumeToken(d.resumeToken,s))}}),u.targetMismatches.forEach(d=>{const f=r.du.get(d);if(!f)return;r.du.set(d,f.withResumeToken(at.EMPTY_BYTE_STRING,f.snapshotVersion)),Fp(r,d);const m=new ar(f.target,d,1,f.sequenceNumber);id(r,m)}),r.remoteSyncer.applyRemoteEvent(u)}(n,t))}catch(i){K("RemoteStore","Failed to raise snapshot:",i),yield ml(n,i)}var i}),ud.apply(this,arguments)}function ml(n,e,t){return cd.apply(this,arguments)}function cd(){return cd=(0,k.Z)(function*(n,e,t){if(!Zn(e))throw e;n._u.add(1),yield Po(n),n.gu.set("Offline"),t||(t=()=>xp(n.localStore)),n.asyncQueue.enqueueRetryable((0,k.Z)(function*(){K("RemoteStore","Retrying IndexedDB access"),yield t(),n._u.delete(1),yield Iu(n)}))}),cd.apply(this,arguments)}function Vp(n,e){return e().catch(t=>ml(n,t,e))}function Lo(n){return ld.apply(this,arguments)}function ld(){return ld=(0,k.Z)(function*(n){const e=ie(n),t=hr(e);let i=e.fu.length>0?e.fu[e.fu.length-1].batchId:-1;for(;Z_(e);)try{const r=yield A_(e.localStore,i);if(null===r){0===e.fu.length&&t.Fo();break}i=r.batchId,q_(e,r)}catch(r){yield ml(e,r)}Bp(e)&&Zp(e)}),ld.apply(this,arguments)}function Z_(n){return Ti(n)&&n.fu.length<10}function q_(n,e){n.fu.push(e);const t=hr(n);t.ko()&&t.Yo&&t.Xo(e.mutations)}function Bp(n){return Ti(n)&&!hr(n).No()&&n.fu.length>0}function Zp(n){hr(n).start()}function G_(n){return hd.apply(this,arguments)}function hd(){return hd=(0,k.Z)(function*(n){hr(n).eu()}),hd.apply(this,arguments)}function W_(n){return dd.apply(this,arguments)}function dd(){return dd=(0,k.Z)(function*(n){const e=hr(n);for(const t of n.fu)e.Xo(t.mutations)}),dd.apply(this,arguments)}function K_(n,e,t){return fd.apply(this,arguments)}function fd(){return fd=(0,k.Z)(function*(n,e,t){const i=n.fu.shift(),r=Rh.from(i,e,t);yield Vp(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),yield Lo(n)}),fd.apply(this,arguments)}function j_(n,e){return pd.apply(this,arguments)}function pd(){return pd=(0,k.Z)(function*(n,e){var t;e&&hr(n).Yo&&(yield(t=(0,k.Z)(function*(i,r){if(Kc(s=r.code)&&s!==M.ABORTED){const u=i.fu.shift();hr(i).Mo(),yield Vp(i,()=>i.remoteSyncer.rejectFailedWrite(u.batchId,r)),yield Lo(i)}var s}),function(i,r){return t.apply(this,arguments)})(n,e)),Bp(n)&&Zp(n)}),pd.apply(this,arguments)}function qp(n,e){return md.apply(this,arguments)}function md(){return md=(0,k.Z)(function*(n,e){const t=ie(n);t.asyncQueue.verifyOperationInProgress(),K("RemoteStore","RemoteStore received new credentials");const i=Ti(t);t._u.add(3),yield Po(t),i&&t.gu.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t._u.delete(3),yield Iu(t)}),md.apply(this,arguments)}function gd(n,e){return _d.apply(this,arguments)}function _d(){return _d=(0,k.Z)(function*(n,e){const t=ie(n);e?(t._u.delete(2),yield Iu(t)):e||(t._u.add(2),yield Po(t),t.gu.set("Unknown"))}),_d.apply(this,arguments)}function Fo(n){return n.pu||(n.pu=function(e,t,i){const r=ie(e);return r.su(),new O_(t,r.connection,r.authCredentials,r.appCheckCredentials,r.yt,i)}(n.datastore,n.asyncQueue,{Yr:U_.bind(null,n),Zr:V_.bind(null,n),Wo:B_.bind(null,n)}),n.wu.push(function(){var e=(0,k.Z)(function*(t){t?(n.pu.Mo(),sd(n)?rd(n):n.gu.set("Unknown")):(yield n.pu.stop(),Up(n))});return function(t){return e.apply(this,arguments)}}())),n.pu}function hr(n){return n.Iu||(n.Iu=function(e,t,i){const r=ie(e);return r.su(),new N_(t,r.connection,r.authCredentials,r.appCheckCredentials,r.yt,i)}(n.datastore,n.asyncQueue,{Yr:G_.bind(null,n),Zr:j_.bind(null,n),tu:W_.bind(null,n),Zo:K_.bind(null,n)}),n.wu.push(function(){var e=(0,k.Z)(function*(t){t?(n.Iu.Mo(),yield Lo(n)):(yield n.Iu.stop(),n.fu.length>0&&(K("RemoteStore",`Stopping write stream with ${n.fu.length} pending writes`),n.fu=[]))});return function(t){return e.apply(this,arguments)}}())),n.Iu}class yd{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new lt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(u=>{})}static createAndSchedule(e,t,i,r,s){const u=Date.now()+i,d=new yd(e,t,u,r,s);return d.start(i),d}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new q(M.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Uo(n,e){if(ot("AsyncQueue",`${e}: ${n}`),Zn(n))return new q(M.UNAVAILABLE,`${e}: ${n}`);throw n}class Vo{constructor(e){this.comparator=e?(t,i)=>e(t,i)||ee.comparator(t.key,i.key):(t,i)=>ee.comparator(t.key,i.key),this.keyedMap=Ii(),this.sortedSet=new rt(this.comparator)}static emptySet(e){return new Vo(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Vo)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const i=new Vo;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class Gp{constructor(){this.Tu=new rt(ee.comparator)}track(e){const t=e.doc.key,i=this.Tu.get(t);i?0!==e.type&&3===i.type?this.Tu=this.Tu.insert(t,e):3===e.type&&1!==i.type?this.Tu=this.Tu.insert(t,{type:i.type,doc:e.doc}):2===e.type&&2===i.type?this.Tu=this.Tu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===i.type?this.Tu=this.Tu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===i.type?this.Tu=this.Tu.remove(t):1===e.type&&2===i.type?this.Tu=this.Tu.insert(t,{type:1,doc:i.doc}):0===e.type&&1===i.type?this.Tu=this.Tu.insert(t,{type:2,doc:e.doc}):Y():this.Tu=this.Tu.insert(t,e)}Eu(){const e=[];return this.Tu.inorderTraversal((t,i)=>{e.push(i)}),e}}class Bo{constructor(e,t,i,r,s,u,d,f,m){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=s,this.fromCache=u,this.syncStateChanged=d,this.excludesMetadataChanges=f,this.hasCachedResults=m}static fromInitialDocuments(e,t,i,r,s){const u=[];return t.forEach(d=>{u.push({type:0,doc:d})}),new Bo(e,t,Vo.emptySet(t),u,i,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&$r(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}}class z_{constructor(){this.Au=void 0,this.listeners=[]}}class $_{constructor(){this.queries=new $n(e=>Oc(e),$r),this.onlineState="Unknown",this.Ru=new Set}}function vd(n,e){return Id.apply(this,arguments)}function Id(){return Id=(0,k.Z)(function*(n,e){const t=ie(n),i=e.query;let r=!1,s=t.queries.get(i);if(s||(r=!0,s=new z_),r)try{s.Au=yield t.onListen(i)}catch(u){const d=Uo(u,`Initialization of query '${Ya(e.query)}' failed`);return void e.onError(d)}t.queries.set(i,s),s.listeners.push(e),e.bu(t.onlineState),s.Au&&e.Pu(s.Au)&&Ed(t)}),Id.apply(this,arguments)}function bd(n,e){return wd.apply(this,arguments)}function wd(){return wd=(0,k.Z)(function*(n,e){const t=ie(n),i=e.query;let r=!1;const s=t.queries.get(i);if(s){const u=s.listeners.indexOf(e);u>=0&&(s.listeners.splice(u,1),r=0===s.listeners.length)}if(r)return t.queries.delete(i),t.onUnlisten(i)}),wd.apply(this,arguments)}function H_(n,e){const t=ie(n);let i=!1;for(const r of e){const u=t.queries.get(r.query);if(u){for(const d of u.listeners)d.Pu(r)&&(i=!0);u.Au=r}}i&&Ed(t)}function Y_(n,e,t){const i=ie(n),r=i.queries.get(e);if(r)for(const s of r.listeners)s.onError(t);i.queries.delete(e)}function Ed(n){n.Ru.forEach(e=>{e.next()})}class Td{constructor(e,t,i){this.query=e,this.vu=t,this.Vu=!1,this.Su=null,this.onlineState="Unknown",this.options=i||{}}Pu(e){if(!this.options.includeMetadataChanges){const i=[];for(const r of e.docChanges)3!==r.type&&i.push(r);e=new Bo(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Vu?this.Du(e)&&(this.vu.next(e),t=!0):this.Cu(e,this.onlineState)&&(this.xu(e),t=!0),this.Su=e,t}onError(e){this.vu.error(e)}bu(e){this.onlineState=e;let t=!1;return this.Su&&!this.Vu&&this.Cu(this.Su,e)&&(this.xu(this.Su),t=!0),t}Cu(e,t){return!e.fromCache||(!this.options.Nu||!("Offline"!==t))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Du(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Su&&this.Su.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}xu(e){e=Bo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Vu=!0,this.vu.next(e)}}class Q_{constructor(e,t){this.ku=e,this.byteLength=t}Ou(){return"metadata"in this.ku}}class Wp{constructor(e){this.yt=e}Ji(e){return In(this.yt,e)}Yi(e){return e.metadata.exists?a(this.yt,e.document,!1):Ye.newNoDocument(this.Ji(e.metadata.name),this.Xi(e.metadata.readTime))}Xi(e){return st(e)}}class J_{constructor(e,t,i){this.Mu=e,this.localStore=t,this.yt=i,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=Kp(e)}Fu(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.ku.namedQuery)this.queries.push(e.ku.namedQuery);else if(e.ku.documentMetadata){this.documents.push({metadata:e.ku.documentMetadata}),e.ku.documentMetadata.exists||++t;const i=Me.fromString(e.ku.documentMetadata.name);this.collectionGroups.add(i.get(i.length-2))}else e.ku.document&&(this.documents[this.documents.length-1].document=e.ku.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}$u(e){const t=new Map,i=new Wp(this.yt);for(const r of e)if(r.metadata.queries){const s=i.Ji(r.metadata.name);for(const u of r.metadata.queries){const d=(t.get(u)||Ae()).add(s);t.set(u,d)}}return t}complete(){var e=this;return(0,k.Z)(function*(){const t=yield function x_(n,e,t,i){return zh.apply(this,arguments)}(e.localStore,new Wp(e.yt),e.documents,e.Mu.id),i=e.$u(e.documents);for(const r of e.queries)yield k_(e.localStore,r,i.get(r.name));return e.progress.taskState="Success",{progress:e.progress,Bu:e.collectionGroups,Lu:t}})()}}function Kp(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class jp{constructor(e){this.key=e}}class zp{constructor(e){this.key=e}}class $p{constructor(e,t){this.query=e,this.qu=t,this.Uu=null,this.hasCachedResults=!1,this.current=!1,this.Ku=Ae(),this.mutatedKeys=Ae(),this.Gu=Eh(e),this.Qu=new Vo(this.Gu)}get ju(){return this.qu}Wu(e,t){const i=t?t.zu:new Gp,r=t?t.Qu:this.Qu;let s=t?t.mutatedKeys:this.mutatedKeys,u=r,d=!1;const f="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,m="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((y,w)=>{const C=r.get(y),B=vo(this.query,w)?w:null,G=!!C&&this.mutatedKeys.has(C.key),ne=!!B&&(B.hasLocalMutations||this.mutatedKeys.has(B.key)&&B.hasCommittedMutations);let ce=!1;C&&B?C.data.isEqual(B.data)?G!==ne&&(i.track({type:3,doc:B}),ce=!0):this.Hu(C,B)||(i.track({type:2,doc:B}),ce=!0,(f&&this.Gu(B,f)>0||m&&this.Gu(B,m)<0)&&(d=!0)):!C&&B?(i.track({type:0,doc:B}),ce=!0):C&&!B&&(i.track({type:1,doc:C}),ce=!0,(f||m)&&(d=!0)),ce&&(B?(u=u.add(B),s=ne?s.add(y):s.delete(y)):(u=u.delete(y),s=s.delete(y)))}),null!==this.query.limit)for(;u.size>this.query.limit;){const y="F"===this.query.limitType?u.last():u.first();u=u.delete(y.key),s=s.delete(y.key),i.track({type:1,doc:y})}return{Qu:u,zu:i,$i:d,mutatedKeys:s}}Hu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i){const r=this.Qu;this.Qu=e.Qu,this.mutatedKeys=e.mutatedKeys;const s=e.zu.Eu();s.sort((m,y)=>function(w,C){const B=G=>{switch(G){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Y()}};return B(w)-B(C)}(m.type,y.type)||this.Gu(m.doc,y.doc)),this.Ju(i);const u=t?this.Yu():[],d=0===this.Ku.size&&this.current?1:0,f=d!==this.Uu;return this.Uu=d,0!==s.length||f?{snapshot:new Bo(this.query,e.Qu,r,s,e.mutatedKeys,0===d,f,!1,!!i&&i.resumeToken.approximateByteSize()>0),Xu:u}:{Xu:u}}bu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Qu:this.Qu,zu:new Gp,mutatedKeys:this.mutatedKeys,$i:!1},!1)):{Xu:[]}}Zu(e){return!this.qu.has(e)&&!!this.Qu.has(e)&&!this.Qu.get(e).hasLocalMutations}Ju(e){e&&(e.addedDocuments.forEach(t=>this.qu=this.qu.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.qu=this.qu.delete(t)),this.current=e.current)}Yu(){if(!this.current)return[];const e=this.Ku;this.Ku=Ae(),this.Qu.forEach(i=>{this.Zu(i.key)&&(this.Ku=this.Ku.add(i.key))});const t=[];return e.forEach(i=>{this.Ku.has(i)||t.push(new zp(i))}),this.Ku.forEach(i=>{e.has(i)||t.push(new jp(i))}),t}tc(e){this.qu=e.Hi,this.Ku=Ae();const t=this.Wu(e.documents);return this.applyChanges(t,!0)}ec(){return Bo.fromInitialDocuments(this.query,this.Qu,this.mutatedKeys,0===this.Uu,this.hasCachedResults)}}class X_{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class ey{constructor(e){this.key=e,this.nc=!1}}class ty{constructor(e,t,i,r,s,u){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=u,this.sc={},this.ic=new $n(d=>Oc(d),$r),this.rc=new Map,this.oc=new Set,this.uc=new rt(ee.comparator),this.cc=new Map,this.ac=new Bh,this.hc={},this.lc=new Map,this.fc=cs.vn(),this.onlineState="Unknown",this.dc=void 0}get isPrimaryClient(){return!0===this.dc}}function ny(n,e){return Ad.apply(this,arguments)}function Ad(){return Ad=(0,k.Z)(function*(n,e){const t=$d(n);let i,r;const s=t.ic.get(e);if(s)i=s.targetId,t.sharedClientState.addLocalQueryTarget(i),r=s.view.ec();else{const u=yield No(t.localStore,wt(e));t.isPrimaryClient&&pl(t.remoteStore,u);const d=t.sharedClientState.addLocalQueryTarget(u.targetId);i=u.targetId,r=yield xd(t,e,i,"current"===d,u.resumeToken)}return r}),Ad.apply(this,arguments)}function xd(n,e,t,i,r){return kd.apply(this,arguments)}function kd(){return kd=(0,k.Z)(function*(n,e,t,i,r){n._c=(w,C,B)=>{return(G=(0,k.Z)(function*(ne,ce,Ue,je){let Oe=ce.view.Wu(Ue);Oe.$i&&(Oe=yield ll(ne.localStore,ce.query,!1).then(({documents:De})=>ce.view.Wu(De,Oe)));const Ce=je&&je.targetChanges.get(ce.targetId),ke=ce.view.applyChanges(Oe,ne.isPrimaryClient,Ce);return Fd(ne,ce.targetId,ke.Xu),ke.snapshot}),function(ne,ce,Ue,je){return G.apply(this,arguments)})(n,w,C,B);var G};const s=yield ll(n.localStore,e,!0),u=new $p(e,s.Hi),d=u.Wu(s.documents),f=es.createSynthesizedTargetChangeForCurrentChange(t,i&&"Offline"!==n.onlineState,r),m=u.applyChanges(d,n.isPrimaryClient,f);Fd(n,t,m.Xu);const y=new X_(e,t,u);return n.ic.set(e,y),n.rc.has(t)?n.rc.get(t).push(e):n.rc.set(t,[e]),m.snapshot}),kd.apply(this,arguments)}function iy(n,e){return Cd.apply(this,arguments)}function Cd(){return Cd=(0,k.Z)(function*(n,e){const t=ie(n),i=t.ic.get(e),r=t.rc.get(i.targetId);if(r.length>1)return t.rc.set(i.targetId,r.filter(s=>!$r(s,e))),void t.ic.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(i.targetId),t.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Mo(t.localStore,i.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(i.targetId),bu(t.remoteStore,i.targetId),Zo(t,i.targetId)}).catch(Bn))):(Zo(t,i.targetId),yield Mo(t.localStore,i.targetId,!0))}),Cd.apply(this,arguments)}function Dd(){return Dd=(0,k.Z)(function*(n,e,t){const i=Hd(n);try{const r=yield function(s,u){const d=ie(s),f=Qe.now(),m=u.reduce((C,B)=>C.add(B.key),Ae());let y,w;return d.persistence.runTransaction("Locally write mutations","readwrite",C=>{let B=Rt(),G=Ae();return d.Gi.getEntries(C,m).next(ne=>{B=ne,B.forEach((ce,Ue)=>{Ue.isValidDocument()||(G=G.add(ce))})}).next(()=>d.localDocuments.getOverlayedDocuments(C,B)).next(ne=>{y=ne;const ce=[];for(const Ue of u){const je=To(Ue,y.get(Ue.key).overlayedDocument);null!=je&&ce.push(new Sn(Ue.key,je,Sc(je.value.mapValue),Xe.exists(!0)))}return d.mutationQueue.addMutationBatch(C,f,ce,u)}).next(ne=>{w=ne;const ce=ne.applyToLocalDocumentSet(y,G);return d.documentOverlayCache.saveOverlays(C,ne.batchId,ce)})}).then(()=>({batchId:w.batchId,changes:tu(y)}))}(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),function(s,u,d){let f=s.hc[s.currentUser.toKey()];f||(f=new rt(we)),f=f.insert(u,d),s.hc[s.currentUser.toKey()]=f}(i,r.batchId,t),yield Ai(i,r.changes),yield Lo(i.remoteStore)}catch(r){const s=Uo(r,"Failed to persist write");t.reject(s)}}),Dd.apply(this,arguments)}function Hp(n,e){return Sd.apply(this,arguments)}function Sd(){return Sd=(0,k.Z)(function*(n,e){const t=ie(n);try{const i=yield T_(t.localStore,e);e.targetChanges.forEach((r,s)=>{const u=t.cc.get(s);u&&(le(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?u.nc=!0:r.modifiedDocuments.size>0?le(u.nc):r.removedDocuments.size>0&&(le(u.nc),u.nc=!1))}),yield Ai(t,i,e)}catch(i){yield Bn(i)}}),Sd.apply(this,arguments)}function Yp(n,e,t){const i=ie(n);if(i.isPrimaryClient&&0===t||!i.isPrimaryClient&&1===t){const r=[];i.ic.forEach((s,u)=>{const d=u.view.bu(e);d.snapshot&&r.push(d.snapshot)}),function(s,u){const d=ie(s);d.onlineState=u;let f=!1;d.queries.forEach((m,y)=>{for(const w of y.listeners)w.bu(u)&&(f=!0)}),f&&Ed(d)}(i.eventManager,e),r.length&&i.sc.Wo(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}function sy(n,e,t){return Rd.apply(this,arguments)}function Rd(){return Rd=(0,k.Z)(function*(n,e,t){const i=ie(n);i.sharedClientState.updateQueryState(e,"rejected",t);const r=i.cc.get(e),s=r&&r.key;if(s){let u=new rt(ee.comparator);u=u.insert(s,Ye.newNoDocument(s,fe.min()));const d=Ae().add(s),f=new bi(fe.min(),new Map,new Ge(we),u,d);yield Hp(i,f),i.uc=i.uc.remove(s),i.cc.delete(e),Ud(i)}else yield Mo(i.localStore,e,!1).then(()=>Zo(i,e,t)).catch(Bn)}),Rd.apply(this,arguments)}function oy(n,e){return Od.apply(this,arguments)}function Od(){return Od=(0,k.Z)(function*(n,e){const t=ie(n),i=e.batch.batchId;try{const r=yield E_(t.localStore,e);Ld(t,i,null),Pd(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),yield Ai(t,r)}catch(r){yield Bn(r)}}),Od.apply(this,arguments)}function ay(n,e,t){return Nd.apply(this,arguments)}function Nd(){return Nd=(0,k.Z)(function*(n,e,t){const i=ie(n);try{const r=yield function(s,u){const d=ie(s);return d.persistence.runTransaction("Reject batch","readwrite-primary",f=>{let m;return d.mutationQueue.lookupMutationBatch(f,u).next(y=>(le(null!==y),m=y.keys(),d.mutationQueue.removeMutationBatch(f,y))).next(()=>d.mutationQueue.performConsistencyCheck(f)).next(()=>d.documentOverlayCache.removeOverlaysForBatchId(f,m,u)).next(()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(f,m)).next(()=>d.localDocuments.getDocuments(f,m))})}(i.localStore,e);Ld(i,e,t),Pd(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),yield Ai(i,r)}catch(r){yield Bn(r)}}),Nd.apply(this,arguments)}function Md(){return Md=(0,k.Z)(function*(n,e){const t=ie(n);Ti(t.remoteStore)||K("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const i=yield function(s){const u=ie(s);return u.persistence.runTransaction("Get highest unacknowledged batch id","readonly",d=>u.mutationQueue.getHighestUnacknowledgedBatchId(d))}(t.localStore);if(-1===i)return void e.resolve();const r=t.lc.get(i)||[];r.push(e),t.lc.set(i,r)}catch(i){const r=Uo(i,"Initialization of waitForPendingWrites() operation failed");e.reject(r)}}),Md.apply(this,arguments)}function Pd(n,e){(n.lc.get(e)||[]).forEach(t=>{t.resolve()}),n.lc.delete(e)}function Ld(n,e,t){const i=ie(n);let r=i.hc[i.currentUser.toKey()];if(r){const s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.hc[i.currentUser.toKey()]=r}}function Zo(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.rc.get(e))n.ic.delete(i),t&&n.sc.wc(i,t);n.rc.delete(e),n.isPrimaryClient&&n.ac.ls(e).forEach(i=>{n.ac.containsKey(i)||Qp(n,i)})}function Qp(n,e){n.oc.delete(e.path.canonicalString());const t=n.uc.get(e);null!==t&&(bu(n.remoteStore,t),n.uc=n.uc.remove(e),n.cc.delete(t),Ud(n))}function Fd(n,e,t){for(const i of t)i instanceof jp?(n.ac.addReference(i.key,e),cy(n,i)):i instanceof zp?(K("SyncEngine","Document no longer in limbo: "+i.key),n.ac.removeReference(i.key,e),n.ac.containsKey(i.key)||Qp(n,i.key)):Y()}function cy(n,e){const t=e.key,i=t.path.canonicalString();n.uc.get(t)||n.oc.has(i)||(K("SyncEngine","New document in limbo: "+t),n.oc.add(i),Ud(n))}function Ud(n){for(;n.oc.size>0&&n.uc.size<n.maxConcurrentLimboResolutions;){const e=n.oc.values().next().value;n.oc.delete(e);const t=new ee(Me.fromString(e)),i=n.fc.next();n.cc.set(i,new ey(t)),n.uc=n.uc.insert(t,i),pl(n.remoteStore,new ar(wt(Xi(t.path)),i,2,Dt.at))}}function Ai(n,e,t){return Vd.apply(this,arguments)}function Vd(){return Vd=(0,k.Z)(function*(n,e,t){const i=ie(n),r=[],s=[],u=[];var d;i.ic.isEmpty()||(i.ic.forEach((d,f)=>{u.push(i._c(f,e,t).then(m=>{if((m||t)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(f.targetId,(null==m?void 0:m.fromCache)?"not-current":"current"),m){r.push(m);const y=Wh.Ci(f.targetId,m);s.push(y)}}))}),yield Promise.all(u),i.sc.Wo(r),yield(d=(0,k.Z)(function*(f,m){const y=ie(f);try{yield y.persistence.runTransaction("notifyLocalViewChanges","readwrite",w=>O.forEach(m,C=>O.forEach(C.Si,B=>y.persistence.referenceDelegate.addReference(w,C.targetId,B)).next(()=>O.forEach(C.Di,B=>y.persistence.referenceDelegate.removeReference(w,C.targetId,B)))))}catch(w){if(!Zn(w))throw w;K("LocalStore","Failed to update sequence numbers: "+w)}for(const w of m){const C=w.targetId;if(!w.fromCache){const B=y.qi.get(C),ne=B.withLastLimboFreeSnapshotVersion(B.snapshotVersion);y.qi=y.qi.insert(C,ne)}}}),function(f,m){return d.apply(this,arguments)})(i.localStore,s))}),Vd.apply(this,arguments)}function ly(n,e){return Bd.apply(this,arguments)}function Bd(){return Bd=(0,k.Z)(function*(n,e){const t=ie(n);if(!t.currentUser.isEqual(e)){K("SyncEngine","User change. New user:",e.toKey());const i=yield Ap(t.localStore,e);t.currentUser=e,(r=t).lc.forEach(u=>{u.forEach(d=>{d.reject(new q(M.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),r.lc.clear(),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),yield Ai(t,i.ji)}var r}),Bd.apply(this,arguments)}function hy(n,e){const t=ie(n),i=t.cc.get(e);if(i&&i.nc)return Ae().add(i.key);{let r=Ae();const s=t.rc.get(e);if(!s)return r;for(const u of s){const d=t.ic.get(u);r=r.unionWith(d.view.ju)}return r}}function dy(n,e){return Zd.apply(this,arguments)}function Zd(){return Zd=(0,k.Z)(function*(n,e){const t=ie(n),i=yield ll(t.localStore,e.query,!0),r=e.view.tc(i);return t.isPrimaryClient&&Fd(t,e.targetId,r.Xu),r}),Zd.apply(this,arguments)}function fy(n,e){return qd.apply(this,arguments)}function qd(){return qd=(0,k.Z)(function*(n,e){const t=ie(n);return Dp(t.localStore,e).then(i=>Ai(t,i))}),qd.apply(this,arguments)}function py(n,e,t,i){return Gd.apply(this,arguments)}function Gd(){return Gd=(0,k.Z)(function*(n,e,t,i){const r=ie(n),s=yield function(u,d){const f=ie(u),m=ie(f.mutationQueue);return f.persistence.runTransaction("Lookup mutation documents","readonly",y=>m.Tn(y,d).next(w=>w?f.localDocuments.getDocuments(y,w):O.resolve(null)))}(r.localStore,e);var d;null!==s?("pending"===t?yield Lo(r.remoteStore):"acknowledged"===t||"rejected"===t?(Ld(r,e,i||null),Pd(r,e),d=e,ie(ie(r.localStore).mutationQueue).An(d)):Y(),yield Ai(r,s)):K("SyncEngine","Cannot apply mutation batch with id: "+e)}),Gd.apply(this,arguments)}function Wd(){return Wd=(0,k.Z)(function*(n,e){const t=ie(n);if($d(t),Hd(t),!0===e&&!0!==t.dc){const i=t.sharedClientState.getAllActiveQueryTargets(),r=yield Jp(t,i.toArray());t.dc=!0,yield gd(t.remoteStore,!0);for(const s of r)pl(t.remoteStore,s)}else if(!1===e&&!1!==t.dc){const i=[];let r=Promise.resolve();t.rc.forEach((s,u)=>{t.sharedClientState.isLocalQueryTarget(u)?i.push(u):r=r.then(()=>(Zo(t,u),Mo(t.localStore,u,!0))),bu(t.remoteStore,u)}),yield r,yield Jp(t,i),function(s){const u=ie(s);u.cc.forEach((d,f)=>{bu(u.remoteStore,f)}),u.ac.fs(),u.cc=new Map,u.uc=new rt(ee.comparator)}(t),t.dc=!1,yield gd(t.remoteStore,!1)}}),Wd.apply(this,arguments)}function Jp(n,e,t){return Kd.apply(this,arguments)}function Kd(){return Kd=(0,k.Z)(function*(n,e,t){const i=ie(n),r=[],s=[];for(const u of e){let d;const f=i.rc.get(u);if(f&&0!==f.length){d=yield No(i.localStore,wt(f[0]));for(const m of f){const y=i.ic.get(m),w=yield dy(i,y);w.snapshot&&s.push(w.snapshot)}}else{const m=yield Cp(i.localStore,u);d=yield No(i.localStore,m),yield xd(i,Xp(m),u,!1,d.resumeToken)}r.push(d)}return i.sc.Wo(s),r}),Kd.apply(this,arguments)}function Xp(n){return _o(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function gy(n){const e=ie(n);return ie(ie(e.localStore).persistence).vi()}function _y(n,e,t,i){return jd.apply(this,arguments)}function jd(){return jd=(0,k.Z)(function*(n,e,t,i){const r=ie(n);if(r.dc)return void K("SyncEngine","Ignoring unexpected query state notification.");const s=r.rc.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{const u=yield Dp(r.localStore,Nc(s[0])),d=bi.createSynthesizedRemoteEventForCurrentChange(e,"current"===t,at.EMPTY_BYTE_STRING);yield Ai(r,u,d);break}case"rejected":yield Mo(r.localStore,e,!0),Zo(r,e,i);break;default:Y()}}),jd.apply(this,arguments)}function yy(n,e,t){return zd.apply(this,arguments)}function zd(){return zd=(0,k.Z)(function*(n,e,t){const i=$d(n);if(i.dc){for(const r of e){if(i.rc.has(r)){K("SyncEngine","Adding an already active target "+r);continue}const s=yield Cp(i.localStore,r),u=yield No(i.localStore,s);yield xd(i,Xp(s),u.targetId,!1,u.resumeToken),pl(i.remoteStore,u)}for(const r of t)i.rc.has(r)&&(yield Mo(i.localStore,r,!1).then(()=>{bu(i.remoteStore,r),Zo(i,r)}).catch(Bn))}}),zd.apply(this,arguments)}function $d(n){const e=ie(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Hp.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=hy.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=sy.bind(null,e),e.sc.Wo=H_.bind(null,e.eventManager),e.sc.wc=Y_.bind(null,e.eventManager),e}function Hd(n){const e=ie(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=oy.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=ay.bind(null,e),e}class em{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return(0,k.Z)(function*(){t.yt=vu(e.databaseInfo.databaseId),t.sharedClientState=t.gc(e),t.persistence=t.yc(e),yield t.persistence.start(),t.localStore=t.Ic(e),t.gcScheduler=t.Tc(e,t.localStore),t.indexBackfillerScheduler=t.Ec(e,t.localStore)})()}Tc(e,t){return null}Ec(e,t){return null}Ic(e){return Tp(this.persistence,new Ep,e.initialUser,this.yt)}yc(e){return new bp(ul.Bs,this.yt)}gc(e){return new Np}terminate(){var e=this;return(0,k.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class tm extends em{constructor(e,t,i){super(),this.Ac=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.synchronizeTabs=!1}initialize(e){var t=()=>super.initialize,i=this;return(0,k.Z)(function*(){yield t().call(i,e),yield i.Ac.initialize(i,e),yield Hd(i.Ac.syncEngine),yield Lo(i.Ac.remoteStore),yield i.persistence.li(()=>(i.gcScheduler&&!i.gcScheduler.started&&i.gcScheduler.start(),i.indexBackfillerScheduler&&!i.indexBackfillerScheduler.started&&i.indexBackfillerScheduler.start(),Promise.resolve()))})()}Ic(e){return Tp(this.persistence,new Ep,e.initialUser,this.yt)}Tc(e,t){return new u_(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}Ec(e,t){const i=new to(t,this.persistence);return new La(e.asyncQueue,i)}yc(e){const t=Gh(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=void 0!==this.cacheSizeBytes?Ht.withCacheSize(this.cacheSizeBytes):Ht.DEFAULT;return new qh(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,Pp(),fl(),this.yt,this.sharedClientState,!!this.forceOwnership)}gc(e){return new Np}}class Iy extends tm{constructor(e,t){super(e,t,!1),this.Ac=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){var t=()=>super.initialize,i=this;return(0,k.Z)(function*(){yield t().call(i,e);const r=i.Ac.syncEngine;i.sharedClientState instanceof Jh&&(i.sharedClientState.syncEngine={Fr:py.bind(null,r),$r:_y.bind(null,r),Br:yy.bind(null,r),vi:gy.bind(null,r),Mr:fy.bind(null,r)},yield i.sharedClientState.start()),yield i.persistence.li(function(){var s=(0,k.Z)(function*(u){yield function my(n,e){return Wd.apply(this,arguments)}(i.Ac.syncEngine,u),i.gcScheduler&&(u&&!i.gcScheduler.started?i.gcScheduler.start():u||i.gcScheduler.stop()),i.indexBackfillerScheduler&&(u&&!i.indexBackfillerScheduler.started?i.indexBackfillerScheduler.start():u||i.indexBackfillerScheduler.stop())});return function(u){return s.apply(this,arguments)}}())})()}gc(e){const t=Pp();if(!Jh.C(t))throw new q(M.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const i=Gh(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Jh(t,e.asyncQueue,i,e.clientId,e.initialUser)}}class Yd{initialize(e,t){var i=this;return(0,k.Z)(function*(){i.localStore||(i.localStore=e.localStore,i.sharedClientState=e.sharedClientState,i.datastore=i.createDatastore(t),i.remoteStore=i.createRemoteStore(t),i.eventManager=i.createEventManager(t),i.syncEngine=i.createSyncEngine(t,!e.synchronizeTabs),i.sharedClientState.onlineStateHandler=r=>Yp(i.syncEngine,r,1),i.remoteStore.remoteSyncer.handleCredentialChange=ly.bind(null,i.syncEngine),yield gd(i.remoteStore,i.syncEngine.isPrimaryClient))})()}createEventManager(e){return new $_}createDatastore(e){const t=vu(e.databaseInfo.databaseId),i=new R_(e.databaseInfo);return new M_(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return t=this.localStore,i=this.datastore,r=e.asyncQueue,s=d=>Yp(this.syncEngine,d,0),u=Mp.C()?new Mp:new C_,new F_(t,i,r,s,u);var t,i,r,s,u}createSyncEngine(e,t){return function(i,r,s,u,d,f,m){const y=new ty(i,r,s,u,d,f);return m&&(y.dc=!0),y}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=(0,k.Z)(function*(t){const i=ie(t);K("RemoteStore","RemoteStore shutting down."),i._u.add(5),yield Po(i),i.mu.shutdown(),i.gu.set("Unknown")}),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}function Qd(n,e,t){if(!t)throw new q(M.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function nm(n,e,t,i){if(!0===e&&!0===i)throw new q(M.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function im(n){if(!ee.isDocumentKey(n))throw new q(M.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function rm(n){if(ee.isDocumentKey(n))throw new q(M.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function gl(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const e=(t=n).constructor?t.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var t;return"function"==typeof n?"a function":Y()}function Pe(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new q(M.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=gl(n);throw new q(M.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function sm(n,e){if(e<=0)throw new q(M.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}const om=new Map;class am{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new q(M.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new q(M.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,nm("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class wu{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new am({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new q(M.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new q(M.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new am(e),void 0!==e.credentials&&(this._authCredentials=function(t){if(!t)return new ch;switch(t.type){case"gapi":return new $s(t.client,t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new q(M.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=om.get(e);t&&(K("ComponentProvider","Removing Datastore"),om.delete(e),t.terminate())}(this),Promise.resolve()}}class et{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Yn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new et(this.firestore,e,this._key)}}class Ot{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Ot(this.firestore,e,this._query)}}class Yn extends Ot{constructor(e,t,i){super(e,t,Xi(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new et(this.firestore,null,new ee(e))}withConverter(e){return new Yn(this.firestore,e,this._path)}}function cm(n,e,...t){if(n=(0,Q.m9)(n),Qd("collection","path",e),n instanceof wu){const i=Me.fromString(e,...t);return rm(i),new Yn(n,null,i)}{if(!(n instanceof et||n instanceof Yn))throw new q(M.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Me.fromString(e,...t));return rm(i),new Yn(n.firestore,null,i)}}function _l(n,e,...t){if(n=(0,Q.m9)(n),1===arguments.length&&(e=pc.R()),Qd("doc","path",e),n instanceof wu){const i=Me.fromString(e,...t);return im(i),new et(n,null,new ee(i))}{if(!(n instanceof et||n instanceof Yn))throw new q(M.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Me.fromString(e,...t));return im(i),new et(n.firestore,n instanceof Yn?n.converter:null,new ee(i))}}function lm(n,e){return n=(0,Q.m9)(n),e=(0,Q.m9)(e),(n instanceof et||n instanceof Yn)&&(e instanceof et||e instanceof Yn)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function Jd(n,e){return n=(0,Q.m9)(n),e=(0,Q.m9)(e),n instanceof Ot&&e instanceof Ot&&n.firestore===e.firestore&&$r(n._query,e._query)&&n.converter===e.converter}function hm(n,e=10240){let t=0;return{read:()=>(0,k.Z)(function*(){if(t<n.byteLength){const i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})(),cancel:()=>(0,k.Z)(function*(){})(),releaseLock(){},closed:Promise.reject("unimplemented")}}class yl{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Rc(this.observer.next,e)}error(e){this.observer.error?this.Rc(this.observer.error,e):ot("Uncaught Error in snapshot listener:",e.toString())}bc(){this.muted=!0}Rc(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class wy{constructor(e,t){this.Pc=e,this.yt=t,this.metadata=new lt,this.buffer=new Uint8Array,this.vc=new TextDecoder("utf-8"),this.Vc().then(i=>{i&&i.Ou()?this.metadata.resolve(i.ku.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(null==i?void 0:i.ku)}`))},i=>this.metadata.reject(i))}close(){return this.Pc.cancel()}getMetadata(){var e=this;return(0,k.Z)(function*(){return e.metadata.promise})()}mc(){var e=this;return(0,k.Z)(function*(){return yield e.getMetadata(),e.Vc()})()}Vc(){var e=this;return(0,k.Z)(function*(){const t=yield e.Sc();if(null===t)return null;const i=e.vc.decode(t),r=Number(i);isNaN(r)&&e.Dc(`length string (${i}) is not valid number`);const s=yield e.Cc(r);return new Q_(JSON.parse(s),t.length+r)})()}xc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}Sc(){var e=this;return(0,k.Z)(function*(){for(;e.xc()<0&&!(yield e.Nc()););if(0===e.buffer.length)return null;const t=e.xc();t<0&&e.Dc("Reached the end of bundle when a length string is expected.");const i=e.buffer.slice(0,t);return e.buffer=e.buffer.slice(t),i})()}Cc(e){var t=this;return(0,k.Z)(function*(){for(;t.buffer.length<e;)(yield t.Nc())&&t.Dc("Reached the end of bundle when more is expected.");const i=t.vc.decode(t.buffer.slice(0,e));return t.buffer=t.buffer.slice(e),i})()}Dc(e){throw this.Pc.cancel(),new Error(`Invalid bundle format: ${e}`)}Nc(){var e=this;return(0,k.Z)(function*(){const t=yield e.Pc.read();if(!t.done){const i=new Uint8Array(e.buffer.length+t.value.length);i.set(e.buffer),i.set(t.value,e.buffer.length),e.buffer=i}return t.done})()}}class Ay{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var t=this;return(0,k.Z)(function*(){if(t.ensureCommitNotCalled(),t.mutations.length>0)throw new q(M.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const i=yield(r=(0,k.Z)(function*(s,u){const d=ie(s),f=is(d.yt)+"/documents",m={documents:u.map(B=>wi(d.yt,B))},y=yield d._o("BatchGetDocuments",f,m,u.length),w=new Map;y.forEach(B=>{const G=function h(n,e){return"found"in e?function(t,i){le(!!i.found);const r=In(t,i.found.name),s=st(i.found.updateTime),u=i.found.createTime?st(i.found.createTime):fe.min(),d=new It({mapValue:{fields:i.found.fields}});return Ye.newFoundDocument(r,s,u,d)}(n,e):"missing"in e?function(t,i){le(!!i.missing),le(!!i.readTime);const r=In(t,i.missing),s=st(i.readTime);return Ye.newNoDocument(r,s)}(n,e):Y()}(d.yt,B);w.set(G.key.toString(),G)});const C=[];return u.forEach(B=>{const G=w.get(B.toString());le(!!G),C.push(G)}),C}),function(s,u){return r.apply(this,arguments)})(t.datastore,e);var r;return i.forEach(r=>t.recordVersion(r)),i})()}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(i){this.lastWriteError=i}this.writtenDocs.add(e.toString())}delete(e){this.write(new rr(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,k.Z)(function*(){if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const t=e.readVersions;var i;e.mutations.forEach(i=>{t.delete(i.key.toString())}),t.forEach((i,r)=>{const s=ee.fromPath(r);e.mutations.push(new eu(s,e.precondition(s)))}),yield(i=(0,k.Z)(function*(r,s){const u=ie(r),d=is(u.yt)+"/documents",f={writes:s.map(m=>_(u.yt,m))};yield u.ao("Commit",d,f)}),function(r,s){return i.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Y();t=fe.min()}const i=this.readVersions.get(e.key.toString());if(i){if(!t.isEqual(i))throw new q(M.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(fe.min())?Xe.exists(!1):Xe.updateTime(t):Xe.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(fe.min()))throw new q(M.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Xe.updateTime(t)}return Xe.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class xy{constructor(e,t,i,r,s){this.asyncQueue=e,this.datastore=t,this.options=i,this.updateFunction=r,this.deferred=s,this.kc=i.maxAttempts,this.xo=new Xh(this.asyncQueue,"transaction_retry")}run(){this.kc-=1,this.Oc()}Oc(){var e=this;this.xo.Ro((0,k.Z)(function*(){const t=new Ay(e.datastore),i=e.Mc(t);i&&i.then(r=>{e.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{e.deferred.resolve(r)}).catch(s=>{e.Fc(s)}))}).catch(r=>{e.Fc(r)})}))}Mc(e){try{const t=this.updateFunction(e);return!Zr(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Fc(e){this.kc>0&&this.$c(e)?(this.kc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Oc(),Promise.resolve()))):this.deferred.reject(e)}$c(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!Kc(t)}return!1}}class ky{constructor(e,t,i,r){var s=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=gt.UNAUTHENTICATED,this.clientId=pc.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(i,function(){var u=(0,k.Z)(function*(d){K("FirestoreClient","Received user=",d.uid),yield s.authCredentialListener(d),s.user=d});return function(d){return u.apply(this,arguments)}}()),this.appCheckCredentials.start(i,u=>(K("FirestoreClient","Received new app check token=",u),this.appCheckCredentialListener(u,this.user)))}getConfiguration(){var e=this;return(0,k.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new q(M.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new lt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,k.Z)(function*(){try{e.onlineComponents&&(yield e.onlineComponents.terminate()),e.offlineComponents&&(yield e.offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(i){const r=Uo(i,"Failed to shutdown persistence");t.reject(r)}})),t.promise}}function dm(n,e){return Xd.apply(this,arguments)}function Xd(){return Xd=(0,k.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress(),K("FirestoreClient","Initializing OfflineComponentProvider");const t=yield n.getConfiguration();yield e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(function(){var r=(0,k.Z)(function*(s){i.isEqual(s)||(yield Ap(e.localStore,s),i=s)});return function(s){return r.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n.offlineComponents=e}),Xd.apply(this,arguments)}function fm(n,e){return ef.apply(this,arguments)}function ef(){return ef=(0,k.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress();const t=yield tf(n);K("FirestoreClient","Initializing OnlineComponentProvider");const i=yield n.getConfiguration();yield e.initialize(t,i),n.setCredentialChangeListener(r=>qp(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,s)=>qp(e.remoteStore,s)),n.onlineComponents=e}),ef.apply(this,arguments)}function tf(n){return nf.apply(this,arguments)}function nf(){return nf=(0,k.Z)(function*(n){return n.offlineComponents||(K("FirestoreClient","Using default OfflineComponentProvider"),yield dm(n,new em)),n.offlineComponents}),nf.apply(this,arguments)}function vl(n){return rf.apply(this,arguments)}function rf(){return rf=(0,k.Z)(function*(n){return n.onlineComponents||(K("FirestoreClient","Using default OnlineComponentProvider"),yield fm(n,new Yd)),n.onlineComponents}),rf.apply(this,arguments)}function pm(n){return tf(n).then(e=>e.persistence)}function Il(n){return tf(n).then(e=>e.localStore)}function sf(n){return vl(n).then(e=>e.remoteStore)}function of(n){return vl(n).then(e=>e.syncEngine)}function qo(n){return af.apply(this,arguments)}function af(){return af=(0,k.Z)(function*(n){const e=yield vl(n),t=e.eventManager;return t.onListen=ny.bind(null,e.syncEngine),t.onUnlisten=iy.bind(null,e.syncEngine),t}),af.apply(this,arguments)}function gm(n,e,t={}){const i=new lt;return n.asyncQueue.enqueueAndForget((0,k.Z)(function*(){return function(r,s,u,d,f){const m=new yl({next:w=>{s.enqueueAndForget(()=>bd(r,y));const C=w.docs.has(u);!C&&w.fromCache?f.reject(new q(M.UNAVAILABLE,"Failed to get document because the client is offline.")):C&&w.fromCache&&d&&"server"===d.source?f.reject(new q(M.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):f.resolve(w)},error:w=>f.reject(w)}),y=new Td(Xi(u.path),m,{includeMetadataChanges:!0,Nu:!0});return vd(r,y)}(yield qo(n),n.asyncQueue,e,t,i)})),i.promise}function _m(n,e,t={}){const i=new lt;return n.asyncQueue.enqueueAndForget((0,k.Z)(function*(){return function(r,s,u,d,f){const m=new yl({next:w=>{s.enqueueAndForget(()=>bd(r,y)),w.fromCache&&"server"===d.source?f.reject(new q(M.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):f.resolve(w)},error:w=>f.reject(w)}),y=new Td(u,m,{includeMetadataChanges:!0,Nu:!0});return vd(r,y)}(yield qo(n),n.asyncQueue,e,t,i)})),i.promise}class Py{constructor(){this.Bc=Promise.resolve(),this.Lc=[],this.qc=!1,this.Uc=[],this.Kc=null,this.Gc=!1,this.Qc=!1,this.jc=[],this.xo=new Xh(this,"async_queue_retry"),this.Wc=()=>{const t=fl();t&&K("AsyncQueue","Visibility state changed to "+t.visibilityState),this.xo.Po()};const e=fl();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Wc)}get isShuttingDown(){return this.qc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.zc(),this.Hc(e)}enterRestrictedMode(e){if(!this.qc){this.qc=!0,this.Qc=e||!1;const t=fl();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Wc)}}enqueue(e){if(this.zc(),this.qc)return new Promise(()=>{});const t=new lt;return this.Hc(()=>this.qc&&this.Qc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Lc.push(e),this.Jc()))}Jc(){var e=this;return(0,k.Z)(function*(){if(0!==e.Lc.length){try{yield e.Lc[0](),e.Lc.shift(),e.xo.reset()}catch(t){if(!Zn(t))throw t;K("AsyncQueue","Operation failed with retryable error: "+t)}e.Lc.length>0&&e.xo.Ro(()=>e.Jc())}})()}Hc(e){const t=this.Bc.then(()=>(this.Gc=!0,e().catch(i=>{throw this.Kc=i,this.Gc=!1,ot("INTERNAL UNHANDLED ERROR: ",function(s){let u=s.message||"";return s.stack&&(u=s.stack.includes(s.message)?s.stack:s.message+"\n"+s.stack),u}(i)),i}).then(i=>(this.Gc=!1,i))));return this.Bc=t,t}enqueueAfterDelay(e,t,i){this.zc(),this.jc.indexOf(e)>-1&&(t=0);const r=yd.createAndSchedule(this,e,t,i,s=>this.Yc(s));return this.Uc.push(r),r}zc(){this.Kc&&Y()}verifyOperationInProgress(){}Xc(){var e=this;return(0,k.Z)(function*(){let t;do{t=e.Bc,yield t}while(t!==e.Bc)})()}Zc(e){for(const t of this.Uc)if(t.timerId===e)return!0;return!1}ta(e){return this.Xc().then(()=>{this.Uc.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(const t of this.Uc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Xc()})}ea(e){this.jc.push(e)}Yc(e){const t=this.Uc.indexOf(e);this.Uc.splice(t,1)}}function uf(n){return function(e,t){if("object"!=typeof e||null===e)return!1;const i=e;for(const r of["next","error","complete"])if(r in i&&"function"==typeof i[r])return!0;return!1}(n)}class Ly{constructor(){this._progressObserver={},this._taskCompletionResolver=new lt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,i){this._progressObserver={next:e,error:t,complete:i}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class tt extends wu{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new Py,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||ym(this),this._firestoreClient.terminate()}}function ht(n){return n._firestoreClient||ym(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function ym(n){var e;const t=n._freezeSettings(),i=(s=(null===(e=n._app)||void 0===e?void 0:e.options.appId)||"",new ph(n._databaseId,s,n._persistenceKey,(d=t).host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,d.useFetchStreams));var s,d;n._firestoreClient=new ky(n._authCredentials,n._appCheckCredentials,n._queue,i)}function vm(n,e,t){const i=new lt;return n.asyncQueue.enqueue((0,k.Z)(function*(){try{yield dm(n,t),yield fm(n,e),i.resolve()}catch(r){const s=r;if(!("FirebaseError"===(u=s).name?u.code===M.FAILED_PRECONDITION||u.code===M.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&u instanceof DOMException)||22===u.code||20===u.code||11===u.code))throw s;en("Error enabling offline persistence. Falling back to persistence disabled: "+s),i.reject(s)}var u})).then(()=>i.promise)}function Im(n){if(n._initialized||n._terminated)throw new q(M.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Qn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Qn(at.fromBase64String(e))}catch(t){throw new q(M.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Qn(at.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class xi{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new q(M.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new it(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class hs{constructor(e){this._methodName=e}}class bl{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new q(M.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new q(M.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return we(this._lat,e._lat)||we(this._long,e._long)}}const jy=/^__.*__$/;class zy{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return null!==this.fieldMask?new Sn(e,this.data,this.fieldMask,t,this.fieldTransforms):new ir(e,this.data,t,this.fieldTransforms)}}class bm{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new Sn(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function wm(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Y()}}class wl{constructor(e,t,i,r,s,u){this.settings=e,this.databaseId=t,this.yt=i,this.ignoreUndefinedProperties=r,void 0===s&&this.na(),this.fieldTransforms=s||[],this.fieldMask=u||[]}get path(){return this.settings.path}get sa(){return this.settings.sa}ia(e){return new wl(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.yt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ra(e){var t;const i=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ia({path:i,oa:!1});return r.ua(e),r}ca(e){var t;const i=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ia({path:i,oa:!1});return r.na(),r}aa(e){return this.ia({path:void 0,oa:!0})}ha(e){return Al(e,this.settings.methodName,this.settings.la||!1,this.path,this.settings.fa)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}na(){if(this.path)for(let e=0;e<this.path.length;e++)this.ua(this.path.get(e))}ua(e){if(0===e.length)throw this.ha("Document fields must not be empty");if(wm(this.sa)&&jy.test(e))throw this.ha('Document fields cannot begin and end with "__"')}}class $y{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.yt=i||vu(e)}da(e,t,i,r=!1){return new wl({sa:e,methodName:t,fa:i,path:it.emptyPath(),oa:!1,la:r},this.databaseId,this.yt,this.ignoreUndefinedProperties)}}function ds(n){const e=n._freezeSettings(),t=vu(n._databaseId);return new $y(n._databaseId,!!e.ignoreUndefinedProperties,t)}function El(n,e,t,i,r,s={}){const u=n.da(s.merge||s.mergeFields?2:0,e,t,r);df("Data must be an object, but it was:",u,i);const d=Am(i,u);let f,m;if(s.merge)f=new St(u.fieldMask),m=u.fieldTransforms;else if(s.mergeFields){const y=[];for(const w of s.mergeFields){const C=ff(e,w,t);if(!u.contains(C))throw new q(M.INVALID_ARGUMENT,`Field '${C}' is specified in your field mask but missing from your input data.`);km(y,C)||y.push(C)}f=new St(y),m=u.fieldTransforms.filter(w=>f.covers(w.field))}else f=null,m=u.fieldTransforms;return new zy(new It(d),f,m)}class Eu extends hs{_toFieldTransform(e){if(2!==e.sa)throw e.ha(1===e.sa?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Eu}}function Em(n,e,t){return new wl({sa:3,fa:e.settings.fa,methodName:n._methodName,oa:t},e.databaseId,e.yt,e.ignoreUndefinedProperties)}class cf extends hs{_toFieldTransform(e){return new Hr(e.path,new zn)}isEqual(e){return e instanceof cf}}class Hy extends hs{constructor(e,t){super(e),this._a=t}_toFieldTransform(e){const t=Em(this,e,!0),i=this._a.map(s=>fs(s,t)),r=new vi(i);return new Hr(e.path,r)}isEqual(e){return this===e}}class Yy extends hs{constructor(e,t){super(e),this._a=t}_toFieldTransform(e){const t=Em(this,e,!0),i=this._a.map(s=>fs(s,t)),r=new Dn(i);return new Hr(e.path,r)}isEqual(e){return this===e}}class Qy extends hs{constructor(e,t){super(e),this.wa=t}_toFieldTransform(e){const t=new tr(e.yt,Io(e.yt,this.wa));return new Hr(e.path,t)}isEqual(e){return this===e}}function lf(n,e,t,i){const r=n.da(1,e,t);df("Data must be an object, but it was:",r,i);const s=[],u=It.empty();qt(i,(f,m)=>{const y=Tl(e,f,t);m=(0,Q.m9)(m);const w=r.ca(y);if(m instanceof Eu)s.push(y);else{const C=fs(m,w);null!=C&&(s.push(y),u.set(y,C))}});const d=new St(s);return new bm(u,d,r.fieldTransforms)}function hf(n,e,t,i,r,s){const u=n.da(1,e,t),d=[ff(e,i,t)],f=[r];if(s.length%2!=0)throw new q(M.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let C=0;C<s.length;C+=2)d.push(ff(e,s[C])),f.push(s[C+1]);const m=[],y=It.empty();for(let C=d.length-1;C>=0;--C)if(!km(m,d[C])){const B=d[C];let G=f[C];G=(0,Q.m9)(G);const ne=u.ca(B);if(G instanceof Eu)m.push(B);else{const ce=fs(G,ne);null!=ce&&(m.push(B),y.set(B,ce))}}const w=new St(m);return new bm(y,w,u.fieldTransforms)}function Tm(n,e,t,i=!1){return fs(t,n.da(i?4:3,e))}function fs(n,e){if(xm(n=(0,Q.m9)(n)))return df("Unsupported field value:",e,n),Am(n,e);if(n instanceof hs)return function(t,i){if(!wm(i.sa))throw i.ha(`${t._methodName}() can only be used with update() and set()`);if(!i.path)throw i.ha(`${t._methodName}() is not currently supported inside arrays`);const r=t._toFieldTransform(i);r&&i.fieldTransforms.push(r)}(n,e),null;if(void 0===n&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.oa&&4!==e.sa)throw e.ha("Nested arrays are not supported");return function(t,i){const r=[];let s=0;for(const u of t){let d=fs(u,i.aa(s));null==d&&(d={nullValue:"NULL_VALUE"}),r.push(d),s++}return{arrayValue:{values:r}}}(n,e)}return function(t,i){if(null===(t=(0,Q.m9)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Io(i.yt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const r=Qe.fromDate(t);return{timestampValue:or(i.yt,r)}}if(t instanceof Qe){const r=new Qe(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:or(i.yt,r)}}if(t instanceof bl)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Qn)return{bytesValue:vn(i.yt,t._byteString)};if(t instanceof et){const r=i.databaseId,s=t.firestore._databaseId;if(!s.isEqual(r))throw i.ha(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:ko(t.firestore._databaseId||i.databaseId,t._key.path)}}throw i.ha(`Unsupported field value: ${gl(t)}`)}(n,e)}function Am(n,e){const t={};return no(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):qt(n,(i,r)=>{const s=fs(r,e.ra(i));null!=s&&(t[i]=s)}),{mapValue:{fields:t}}}function xm(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof Qe||n instanceof bl||n instanceof Qn||n instanceof et||n instanceof hs)}function df(n,e,t){if(!xm(t)||"object"!=typeof(i=t)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i)){const i=gl(t);throw e.ha("an object"===i?n+" a custom object":n+" "+i)}var i}function ff(n,e,t){if((e=(0,Q.m9)(e))instanceof xi)return e._internalPath;if("string"==typeof e)return Tl(n,e);throw Al("Field path arguments must be of type string or ",n,!1,void 0,t)}const Jy=new RegExp("[~\\*/\\[\\]]");function Tl(n,e,t){if(e.search(Jy)>=0)throw Al(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new xi(...e.split("."))._internalPath}catch(i){throw Al(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Al(n,e,t,i,r){const s=i&&!i.isEmpty(),u=void 0!==r;let d=`Function ${e}() called with invalid data`;t&&(d+=" (via `toFirestore()`)"),d+=". ";let f="";return(s||u)&&(f+=" (found",s&&(f+=` in field ${i}`),u&&(f+=` in document ${r}`),f+=")"),new q(M.INVALID_ARGUMENT,d+n+f)}function km(n,e){return n.some(t=>t.isEqual(e))}class Tu{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new et(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Xy(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(xl("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class Xy extends Tu{data(){return super.data()}}function xl(n,e){return"string"==typeof e?Tl(n,e):e instanceof xi?e._internalPath:e._delegate._internalPath}function Cm(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new q(M.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class pf{}class Au extends pf{}function dr(n,e,...t){let i=[];e instanceof pf&&i.push(e),i=i.concat(t),function(r){const s=r.filter(d=>d instanceof Go).length,u=r.filter(d=>d instanceof xu).length;if(s>1||s>0&&u>0)throw new q(M.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const r of i)n=r._apply(n);return n}class xu extends Au{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new xu(e,t,i)}_apply(e){const t=this._parse(e);return Om(e._query,t),new Ot(e.firestore,e.converter,Ha(e._query,t))}_parse(e){const t=ds(e.firestore);return function(r,s,u,d,f,m,y){let w;if(f.isKeyField()){if("array-contains"===m||"array-contains-any"===m)throw new q(M.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if("in"===m||"not-in"===m){Rm(y,m);const C=[];for(const B of y)C.push(Sm(d,r,B));w={arrayValue:{values:C}}}else w=Sm(d,r,y)}else"in"!==m&&"not-in"!==m&&"array-contains-any"!==m||Rm(y,m),w=Tm(u,"where",y,"in"===m||"not-in"===m);return Re.create(f,m,w)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value)}}class Go extends pf{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Go(e,t)}_parse(e){const t=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return 1===t.length?t[0]:Fe.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(i,r){let s=i;const u=r.getFlattenedFilters();for(const d of u)Om(s,d),s=Ha(s,d)}(e._query,t),new Ot(e.firestore,e.converter,Ha(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class mf extends Au{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new mf(e,t)}_apply(e){const t=function(i,r,s){if(null!==i.startAt)throw new q(M.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==i.endAt)throw new q(M.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const u=new Qi(r,s);return function(d,f){if(null===za(d)){const m=er(d);null!==m&&Nm(0,m,f.field)}}(i,u),u}(e._query,this._field,this._direction);return new Ot(e.firestore,e.converter,function(i,r){const s=i.explicitOrderBy.concat([r]);return new Cn(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}class kl extends Au{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new kl(e,t,i)}_apply(e){return new Ot(e.firestore,e.converter,yo(e._query,this._limit,this._limitType))}}class Cl extends Au{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new Cl(e,t,i)}_apply(e){const t=Dm(e,this.type,this._docOrFields,this._inclusive);return new Ot(e.firestore,e.converter,(r=t,new Cn((i=e._query).path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,r,i.endAt)));var i,r}}class Dl extends Au{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new Dl(e,t,i)}_apply(e){const t=Dm(e,this.type,this._docOrFields,this._inclusive);return new Ot(e.firestore,e.converter,(r=t,new Cn((i=e._query).path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,r)));var i,r}}function Dm(n,e,t,i){if(t[0]=(0,Q.m9)(t[0]),t[0]instanceof Tu)return function(r,s,u,d,f){if(!d)throw new q(M.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${u}().`);const m=[];for(const y of jn(r))if(y.field.isKeyField())m.push(kn(s,d.key));else{const w=d.data.field(y.field);if(Gr(w))throw new q(M.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+y.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===w){const C=y.field.canonicalString();throw new q(M.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${C}' (used as the orderBy) does not exist.`)}m.push(w)}return new Wn(m,f)}(n._query,n.firestore._databaseId,e,t[0]._document,i);{const r=ds(n.firestore);return function(s,u,d,f,m,y){const w=s.explicitOrderBy;if(m.length>w.length)throw new q(M.INVALID_ARGUMENT,`Too many arguments provided to ${f}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const C=[];for(let B=0;B<m.length;B++){const G=m[B];if(w[B].field.isKeyField()){if("string"!=typeof G)throw new q(M.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${f}(), but got a ${typeof G}`);if(!$a(s)&&-1!==G.indexOf("/"))throw new q(M.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${f}() must be a plain document ID, but '${G}' contains a slash.`);const ne=s.path.child(Me.fromString(G));if(!ee.isDocumentKey(ne))throw new q(M.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${f}() must result in a valid document path, but '${ne}' is not because it contains an odd number of segments.`);const ce=new ee(ne);C.push(kn(u,ce))}else{const ne=Tm(d,f,G);C.push(ne)}}return new Wn(C,y)}(n._query,n.firestore._databaseId,r,e,t,i)}}function Sm(n,e,t){if("string"==typeof(t=(0,Q.m9)(t))){if(""===t)throw new q(M.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!$a(e)&&-1!==t.indexOf("/"))throw new q(M.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(Me.fromString(t));if(!ee.isDocumentKey(i))throw new q(M.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return kn(n,new ee(i))}if(t instanceof et)return kn(n,t._key);throw new q(M.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${gl(t)}.`)}function Rm(n,e){if(!Array.isArray(n)||0===n.length)throw new q(M.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(n.length>10)throw new q(M.INVALID_ARGUMENT,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function Om(n,e){if(e.isInequality()){const i=er(n),r=e.field;if(null!==i&&!i.isEqual(r))throw new q(M.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${i.toString()}' and '${r.toString()}'`);const s=za(n);null!==s&&Nm(0,r,s)}const t=function(i,r){for(const s of i)for(const u of s.getFlattenedFilters())if(r.indexOf(u.op)>=0)return u.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==t)throw new q(M.INVALID_ARGUMENT,t===e.op?`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`:`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function Nm(n,e,t){if(!t.isEqual(e))throw new q(M.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}class gf{convertValue(e,t="none"){switch(nn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Je(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(gi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw Y()}}convertObject(e,t){const i={};return qt(e.fields,(r,s)=>{i[r]=this.convertValue(s,t)}),i}convertGeoPoint(e){return new bl(Je(e.latitude),Je(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":const i=bc(e);return null==i?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(_i(e));default:return null}}convertTimestamp(e){const t=qn(e);return new Qe(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=Me.fromString(e);le(uu(i));const r=new pn(i.get(1),i.get(3)),s=new ee(i.popFirst(5));return r.isEqual(t)||ot(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function Sl(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class uv extends gf{constructor(e){super(),this.firestore=e}convertBytes(e){return new Qn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new et(this.firestore,null,t)}}class ps{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ki extends Tu{constructor(e,t,i,r,s,u){super(e,t,i,r,u),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new ku(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(xl("DocumentSnapshot.get",e));if(null!==i)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}}class ku extends ki{data(e={}){return super.data(e)}}class fr{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new ps(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new ku(this._firestore,this._userDataWriter,i.key,i,new ps(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new q(M.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,r){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(u=>({type:"added",doc:new ku(i._firestore,i._userDataWriter,u.doc.key,u.doc,new ps(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter),oldIndex:-1,newIndex:s++}))}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>r||3!==u.type).map(u=>{const d=new ku(i._firestore,i._userDataWriter,u.doc.key,u.doc,new ps(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);let f=-1,m=-1;return 0!==u.type&&(f=s.indexOf(u.doc.key),s=s.delete(u.doc.key)),1!==u.type&&(s=s.add(u.doc),m=s.indexOf(u.doc.key)),{type:cv(u.type),doc:d,oldIndex:f,newIndex:m}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function cv(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Y()}}function Pm(n,e){return n instanceof ki&&e instanceof ki?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(null===n._document?null===e._document:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof fr&&e instanceof fr&&n._firestore===e._firestore&&Jd(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}class pr extends gf{constructor(e){super(),this.firestore=e}convertBytes(e){return new Qn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new et(this.firestore,null,t)}}function Lm(n,e,t){n=Pe(n,et);const i=Pe(n.firestore,tt),r=Sl(n.converter,e,t);return Wo(i,[El(ds(i),"setDoc",n._key,r,null!==n.converter,t).toMutation(n._key,Xe.none())])}function Fm(n,e,t,...i){n=Pe(n,et);const r=Pe(n.firestore,tt),s=ds(r);let u;return u="string"==typeof(e=(0,Q.m9)(e))||e instanceof xi?hf(s,"updateDoc",n._key,e,t,i):lf(s,"updateDoc",n._key,e),Wo(r,[u.toMutation(n._key,Xe.exists(!0))])}function Um(n,...e){var t,i,r;n=(0,Q.m9)(n);let s={includeMetadataChanges:!1},u=0;"object"!=typeof e[u]||uf(e[u])||(s=e[u],u++);const d={includeMetadataChanges:s.includeMetadataChanges};if(uf(e[u])){const w=e[u];e[u]=null===(t=w.next)||void 0===t?void 0:t.bind(w),e[u+1]=null===(i=w.error)||void 0===i?void 0:i.bind(w),e[u+2]=null===(r=w.complete)||void 0===r?void 0:r.bind(w)}let f,m,y;if(n instanceof et)m=Pe(n.firestore,tt),y=Xi(n._key.path),f={next:w=>{e[u]&&e[u](_f(m,n,w))},error:e[u+1],complete:e[u+2]};else{const w=Pe(n,Ot);m=Pe(w.firestore,tt),y=w._query;const C=new pr(m);f={next:B=>{e[u]&&e[u](new fr(m,C,w,B))},error:e[u+1],complete:e[u+2]},Cm(n._query)}return function(w,C,B,G){const ne=new yl(G),ce=new Td(C,ne,B);return w.asyncQueue.enqueueAndForget((0,k.Z)(function*(){return vd(yield qo(w),ce)})),()=>{ne.bc(),w.asyncQueue.enqueueAndForget((0,k.Z)(function*(){return bd(yield qo(w),ce)}))}}(ht(m),y,d,f)}function Wo(n,e){return function(t,i){const r=new lt;return t.asyncQueue.enqueueAndForget((0,k.Z)(function*(){return function ry(n,e,t){return Dd.apply(this,arguments)}(yield of(t),i,r)})),r.promise}(ht(n),e)}function _f(n,e,t){const i=t.docs.get(e._key),r=new pr(n);return new ki(n,r,e._key,i,new ps(t.hasPendingWrites,t.fromCache),e.converter)}const vv={maxAttempts:5};class Vm{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=ds(e)}set(e,t,i){this._verifyNotCommitted();const r=mr(e,this._firestore),s=Sl(r.converter,t,i),u=El(this._dataReader,"WriteBatch.set",r._key,s,null!==r.converter,i);return this._mutations.push(u.toMutation(r._key,Xe.none())),this}update(e,t,i,...r){this._verifyNotCommitted();const s=mr(e,this._firestore);let u;return u="string"==typeof(t=(0,Q.m9)(t))||t instanceof xi?hf(this._dataReader,"WriteBatch.update",s._key,t,i,r):lf(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(u.toMutation(s._key,Xe.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=mr(e,this._firestore);return this._mutations=this._mutations.concat(new rr(t._key,Xe.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new q(M.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function mr(n,e){if((n=(0,Q.m9)(n)).firestore!==e)throw new q(M.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class Iv extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=ds(e)}get(e){const t=mr(e,this._firestore),i=new uv(this._firestore);return this._transaction.lookup([t._key]).then(r=>{if(!r||1!==r.length)return Y();const s=r[0];if(s.isFoundDocument())return new Tu(this._firestore,i,s.key,s,t.converter);if(s.isNoDocument())return new Tu(this._firestore,i,t._key,null,t.converter);throw Y()})}set(e,t,i){const r=mr(e,this._firestore),s=Sl(r.converter,t,i),u=El(this._dataReader,"Transaction.set",r._key,s,null!==r.converter,i);return this._transaction.set(r._key,u),this}update(e,t,i,...r){const s=mr(e,this._firestore);let u;return u="string"==typeof(t=(0,Q.m9)(t))||t instanceof xi?hf(this._dataReader,"Transaction.update",s._key,t,i,r):lf(this._dataReader,"Transaction.update",s._key,t),this._transaction.update(s._key,u),this}delete(e){const t=mr(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=mr(e,this._firestore),i=new pr(this._firestore);return super.get(e).then(r=>new ki(this._firestore,i,t._key,r._document,new ps(!1,!1),t.converter))}}function yf(n,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new q("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function Zm(){if("undefined"==typeof Uint8Array)throw new q("unimplemented","Uint8Arrays are not available in this environment.")}function qm(){if(!function Fa(){return"undefined"!=typeof atob}())throw new q("unimplemented","Blobs are unavailable in Firestore in this environment.")}!function(n,e=!0){Ur=P.SDK_VERSION,(0,P._registerComponent)(new W.wA("firestore",(t,{instanceIdentifier:i,options:r})=>{const s=t.getProvider("app").getImmediate(),u=new tt(new dc(t.getProvider("auth-internal")),new Sa(t.getProvider("app-check-internal")),function(d,f){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new q(M.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new pn(d.options.projectId,f)}(s,i),s);return r=Object.assign({useFetchStreams:e},r),u._setSettings(r),u},"PUBLIC").setMultipleInstances(!0)),(0,P.registerVersion)(lc,"3.8.0",n),(0,P.registerVersion)(lc,"3.8.0","esm2017")}();class Cu{constructor(e){this._delegate=e}static fromBase64String(e){return qm(),new Cu(Qn.fromBase64String(e))}static fromUint8Array(e){return Zm(),new Cu(Qn.fromUint8Array(e))}toBase64(){return qm(),this._delegate.toBase64()}toUint8Array(){return Zm(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function vf(n){return function Dv(n,e){if("object"!=typeof n||null===n)return!1;const t=n;for(const i of e)if(i in t&&"function"==typeof t[i])return!0;return!1}(n,["next","error","complete"])}class Sv{enableIndexedDbPersistence(e,t){return function Uy(n,e){Im(n=Pe(n,tt));const t=ht(n),i=n._freezeSettings(),r=new Yd;return vm(t,r,new tm(r,i.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function Vy(n){Im(n=Pe(n,tt));const e=ht(n),t=n._freezeSettings(),i=new Yd;return vm(e,i,new Iy(i,t.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function By(n){if(n._initialized&&!n._terminated)throw new q(M.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new lt;return n._queue.enqueueAndForgetEvenWhileRestricted((0,k.Z)(function*(){try{yield(t=(0,k.Z)(function*(i){if(!tn.C())return Promise.resolve();const r=i+"main";yield tn.delete(r)}),function(i){return t.apply(this,arguments)})(Gh(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}var t})),e.promise}(e._delegate)}}class Gm{constructor(e,t,i){this._delegate=t,this._persistenceProvider=i,this.INTERNAL={delete:()=>this.terminate()},e instanceof pn||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&en("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,i={}){!function um(n,e,t,i={}){var r;const s=(n=Pe(n,wu))._getSettings();if("firestore.googleapis.com"!==s.host&&s.host!==e&&en("Host has been set in both settings() and useEmulator(), emulator host will be used"),n._setSettings(Object.assign(Object.assign({},s),{host:`${e}:${t}`,ssl:!1})),i.mockUserToken){let u,d;if("string"==typeof i.mockUserToken)u=i.mockUserToken,d=gt.MOCK_USER;else{u=(0,Q.Sg)(i.mockUserToken,null===(r=n._app)||void 0===r?void 0:r.options.projectId);const f=i.mockUserToken.sub||i.mockUserToken.user_id;if(!f)throw new q(M.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new gt(f)}n._authCredentials=new zs(new Da(u,d))}}(this._delegate,e,t,i)}enableNetwork(){return function qy(n){return function Cy(n){return n.asyncQueue.enqueue((0,k.Z)(function*(){const e=yield pm(n),t=yield sf(n);return e.setNetworkEnabled(!0),function(i){const r=ie(i);return r._u.delete(0),Iu(r)}(t)}))}(ht(n=Pe(n,tt)))}(this._delegate)}disableNetwork(){return function Gy(n){return function Dy(n){return n.asyncQueue.enqueue((0,k.Z)(function*(){const e=yield pm(n),t=yield sf(n);return e.setNetworkEnabled(!1),(i=(0,k.Z)(function*(r){const s=ie(r);s._u.add(0),yield Po(s),s.gu.set("Offline")}),function(r){return i.apply(this,arguments)})(t);var i}))}(ht(n=Pe(n,tt)))}(this._delegate)}enablePersistence(e){let t=!1,i=!1;return e&&(t=!!e.synchronizeTabs,i=!!e.experimentalForceOwningTab,nm("synchronizeTabs",t,"experimentalForceOwningTab",i)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,i)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function Zy(n){return function(e){const t=new lt;return e.asyncQueue.enqueueAndForget((0,k.Z)(function*(){return function uy(n,e){return Md.apply(this,arguments)}(yield of(e),t)})),t.promise}(ht(n=Pe(n,tt)))}(this._delegate)}onSnapshotsInSync(e){return function yv(n,e){return function Oy(n,e){const t=new yl(e);return n.asyncQueue.enqueueAndForget((0,k.Z)(function*(){return i=yield qo(n),r=t,ie(i).Ru.add(r),void r.next();var i,r})),()=>{t.bc(),n.asyncQueue.enqueueAndForget((0,k.Z)(function*(){return i=yield qo(n),r=t,void ie(i).Ru.delete(r);var i,r}))}}(ht(n=Pe(n,tt)),uf(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new q("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Ko(this,cm(this._delegate,e))}catch(t){throw Wt(t,"collection()","Firestore.collection()")}}doc(e){try{return new wn(this,_l(this._delegate,e))}catch(t){throw Wt(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Kt(this,function by(n,e){if(n=Pe(n,wu),Qd("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new q(M.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Ot(n,null,(t=e,new Cn(Me.emptyPath(),t)));var t}(this._delegate,e))}catch(t){throw Wt(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function bv(n,e,t){n=Pe(n,tt);const i=Object.assign(Object.assign({},vv),t);return function(r){if(r.maxAttempts<1)throw new q(M.INVALID_ARGUMENT,"Max attempts must be at least 1")}(i),function(r,s,u){const d=new lt;return r.asyncQueue.enqueueAndForget((0,k.Z)(function*(){const f=yield function mm(n){return vl(n).then(e=>e.datastore)}(r);new xy(r.asyncQueue,f,u,s,d).run()})),d.promise}(ht(n),r=>e(new Iv(n,r)),i)}(this._delegate,t=>e(new Wm(this,t)))}batch(){return ht(this._delegate),new Km(new Vm(this._delegate,e=>Wo(this._delegate,e)))}loadBundle(e){return function Wy(n,e){const t=ht(n=Pe(n,tt)),i=new Ly;return function Ny(n,e,t,i){const r=function(s,u){let d;return d="string"==typeof s?(new TextEncoder).encode(s):s,f=function(f,m){if(f instanceof Uint8Array)return hm(f,m);if(f instanceof ArrayBuffer)return hm(new Uint8Array(f),m);if(f instanceof ReadableStream)return f.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(d),new wy(f,u);var f}(t,vu(e));n.asyncQueue.enqueueAndForget((0,k.Z)(function*(){!function vy(n,e,t){const i=ie(n);var r;(r=(0,k.Z)(function*(s,u,d){try{const f=yield u.getMetadata();if(yield function(C,B){const G=ie(C),ne=st(B.createTime);return G.persistence.runTransaction("hasNewerBundle","readonly",ce=>G.Ns.getBundleMetadata(ce,B.id)).then(ce=>!!ce&&ce.createTime.compareTo(ne)>=0)}(s.localStore,f))return yield u.close(),d._completeWith({taskState:"Success",documentsLoaded:(C=f).totalDocuments,bytesLoaded:C.totalBytes,totalDocuments:C.totalDocuments,totalBytes:C.totalBytes}),Promise.resolve(new Set);d._updateProgress(Kp(f));const m=new J_(f,s.localStore,u.yt);let y=yield u.mc();for(;y;){const C=yield m.Fu(y);C&&d._updateProgress(C),y=yield u.mc()}const w=yield m.complete();return yield Ai(s,w.Lu,void 0),yield function(C,B){const G=ie(C);return G.persistence.runTransaction("Save bundle","readwrite",ne=>G.Ns.saveBundleMetadata(ne,B))}(s.localStore,f),d._completeWith(w.progress),Promise.resolve(w.Bu)}catch(f){return en("SyncEngine",`Loading bundle failed with ${f}`),d._failWith(f),Promise.resolve(new Set)}var C}),function(s,u,d){return r.apply(this,arguments)})(i,e,t).then(r=>{i.sharedClientState.notifyBundleLoaded(r)})}(yield of(n),r,i)}))}(t,n._databaseId,e,i),i}(this._delegate,e)}namedQuery(e){return function Ky(n,e){return function My(n,e){return n.asyncQueue.enqueue((0,k.Z)(function*(){return function(t,i){const r=ie(t);return r.persistence.runTransaction("Get named query","readonly",s=>r.Ns.getNamedQuery(s,i))}(yield Il(n),e)}))}(ht(n=Pe(n,tt)),e).then(t=>t?new Ot(n,null,t.query):null)}(this._delegate,e).then(t=>t?new Kt(this,t):null)}}class Rl extends gf{constructor(e){super(),this.firestore=e}convertBytes(e){return new Cu(new Qn(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return wn.forKey(t,this.firestore,null)}}class Wm{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Rl(e)}get(e){const t=gs(e);return this._delegate.get(t).then(i=>new Du(this._firestore,new ki(this._firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,t.converter)))}set(e,t,i){const r=gs(e);return i?(yf("Transaction.set",i),this._delegate.set(r,t,i)):this._delegate.set(r,t),this}update(e,t,i,...r){const s=gs(e);return 2===arguments.length?this._delegate.update(s,t):this._delegate.update(s,t,i,...r),this}delete(e){const t=gs(e);return this._delegate.delete(t),this}}class Km{constructor(e){this._delegate=e}set(e,t,i){const r=gs(e);return i?(yf("WriteBatch.set",i),this._delegate.set(r,t,i)):this._delegate.set(r,t),this}update(e,t,i,...r){const s=gs(e);return 2===arguments.length?this._delegate.update(s,t):this._delegate.update(s,t,i,...r),this}delete(e){const t=gs(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class ms{constructor(e,t,i){this._firestore=e,this._userDataWriter=t,this._delegate=i}fromFirestore(e,t){const i=new ku(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Su(this._firestore,i),null!=t?t:{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const i=ms.INSTANCES;let r=i.get(e);r||(r=new WeakMap,i.set(e,r));let s=r.get(t);return s||(s=new ms(e,new Rl(e),t),r.set(t,s)),s}}ms.INSTANCES=new WeakMap;class wn{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Rl(e)}static forPath(e,t,i){if(e.length%2!=0)throw new q("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new wn(t,new et(t._delegate,i,new ee(e)))}static forKey(e,t,i){return new wn(t,new et(t._delegate,i,e))}get id(){return this._delegate.id}get parent(){return new Ko(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Ko(this.firestore,cm(this._delegate,e))}catch(t){throw Wt(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,Q.m9)(e))instanceof et&&lm(this._delegate,e)}set(e,t){t=yf("DocumentReference.set",t);try{return t?Lm(this._delegate,e,t):Lm(this._delegate,e)}catch(i){throw Wt(i,"setDoc()","DocumentReference.set()")}}update(e,t,...i){try{return 1===arguments.length?Fm(this._delegate,e):Fm(this._delegate,e,t,...i)}catch(r){throw Wt(r,"updateDoc()","DocumentReference.update()")}}delete(){return function gv(n){return Wo(Pe(n.firestore,tt),[new rr(n._key,Xe.none())])}(this._delegate)}onSnapshot(...e){const t=jm(e),i=zm(e,r=>new Du(this.firestore,new ki(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)));return Um(this._delegate,t,i)}get(e){let t;return t="cache"===(null==e?void 0:e.source)?function hv(n){n=Pe(n,et);const e=Pe(n.firestore,tt),t=ht(e),i=new pr(e);return function Sy(n,e){const t=new lt;return n.asyncQueue.enqueueAndForget((0,k.Z)(function*(){return(i=(0,k.Z)(function*(r,s,u){try{const d=yield function(f,m){const y=ie(f);return y.persistence.runTransaction("read document","readonly",w=>y.localDocuments.getDocument(w,m))}(r,s);d.isFoundDocument()?u.resolve(d):d.isNoDocument()?u.resolve(null):u.reject(new q(M.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(d){const f=Uo(d,`Failed to get document '${s} from cache`);u.reject(f)}}),function(r,s,u){return i.apply(this,arguments)})(yield Il(n),e,t);var i})),t.promise}(t,n._key).then(r=>new ki(e,i,n._key,r,new ps(null!==r&&r.hasLocalMutations,!0),n.converter))}(this._delegate):"server"===(null==e?void 0:e.source)?function dv(n){n=Pe(n,et);const e=Pe(n.firestore,tt);return gm(ht(e),n._key,{source:"server"}).then(t=>_f(e,n,t))}(this._delegate):function lv(n){n=Pe(n,et);const e=Pe(n.firestore,tt);return gm(ht(e),n._key).then(t=>_f(e,n,t))}(this._delegate),t.then(i=>new Du(this.firestore,new ki(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)))}withConverter(e){return new wn(this.firestore,this._delegate.withConverter(e?ms.getInstance(this.firestore,e):null))}}function Wt(n,e,t){return n.message=n.message.replace(e,t),n}function jm(n){for(const e of n)if("object"==typeof e&&!vf(e))return e;return{}}function zm(n,e){var t,i;let r;return r=vf(n[0])?n[0]:vf(n[1])?n[1]:"function"==typeof n[0]?{next:n[0],error:n[1],complete:n[2]}:{next:n[1],error:n[2],complete:n[3]},{next:s=>{r.next&&r.next(e(s))},error:null===(t=r.error)||void 0===t?void 0:t.bind(r),complete:null===(i=r.complete)||void 0===i?void 0:i.bind(r)}}class Du{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new wn(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return Pm(this._delegate,e._delegate)}}class Su extends Du{data(e){const t=this._delegate.data(e);return function Ca(n,e){n||Y()}(void 0!==t),t}}class Kt{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Rl(e)}where(e,t,i){try{return new Kt(this.firestore,dr(this._delegate,function ev(n,e,t){const i=e,r=xl("where",n);return xu._create(r,i,t)}(e,t,i)))}catch(r){throw Wt(r,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Kt(this.firestore,dr(this._delegate,function tv(n,e="asc"){const t=e,i=xl("orderBy",n);return mf._create(i,t)}(e,t)))}catch(i){throw Wt(i,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Kt(this.firestore,dr(this._delegate,function nv(n){return sm("limit",n),kl._create("limit",n,"F")}(e)))}catch(t){throw Wt(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Kt(this.firestore,dr(this._delegate,function iv(n){return sm("limitToLast",n),kl._create("limitToLast",n,"L")}(e)))}catch(t){throw Wt(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Kt(this.firestore,dr(this._delegate,function rv(...n){return Cl._create("startAt",n,!0)}(...e)))}catch(t){throw Wt(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Kt(this.firestore,dr(this._delegate,function sv(...n){return Cl._create("startAfter",n,!1)}(...e)))}catch(t){throw Wt(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Kt(this.firestore,dr(this._delegate,function ov(...n){return Dl._create("endBefore",n,!1)}(...e)))}catch(t){throw Wt(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Kt(this.firestore,dr(this._delegate,function av(...n){return Dl._create("endAt",n,!0)}(...e)))}catch(t){throw Wt(t,"endAt()","Query.endAt()")}}isEqual(e){return Jd(this._delegate,e._delegate)}get(e){let t;return t="cache"===(null==e?void 0:e.source)?function pv(n){n=Pe(n,Ot);const e=Pe(n.firestore,tt),t=ht(e),i=new pr(e);return function Ry(n,e){const t=new lt;return n.asyncQueue.enqueueAndForget((0,k.Z)(function*(){return(i=(0,k.Z)(function*(r,s,u){try{const d=yield ll(r,s,!0),f=new $p(s,d.Hi),m=f.Wu(d.documents),y=f.applyChanges(m,!1);u.resolve(y.snapshot)}catch(d){const f=Uo(d,`Failed to execute query '${s} against cache`);u.reject(f)}}),function(r,s,u){return i.apply(this,arguments)})(yield Il(n),e,t);var i})),t.promise}(t,n._query).then(r=>new fr(e,i,n,r))}(this._delegate):"server"===(null==e?void 0:e.source)?function mv(n){n=Pe(n,Ot);const e=Pe(n.firestore,tt),t=ht(e),i=new pr(e);return _m(t,n._query,{source:"server"}).then(r=>new fr(e,i,n,r))}(this._delegate):function fv(n){n=Pe(n,Ot);const e=Pe(n.firestore,tt),t=ht(e),i=new pr(e);return Cm(n._query),_m(t,n._query).then(r=>new fr(e,i,n,r))}(this._delegate),t.then(i=>new If(this.firestore,new fr(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)))}onSnapshot(...e){const t=jm(e),i=zm(e,r=>new If(this.firestore,new fr(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)));return Um(this._delegate,t,i)}withConverter(e){return new Kt(this.firestore,this._delegate.withConverter(e?ms.getInstance(this.firestore,e):null))}}class Ov{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Su(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class If{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Kt(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Su(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new Ov(this._firestore,t))}forEach(e,t){this._delegate.forEach(i=>{e.call(t,new Su(this._firestore,i))})}isEqual(e){return Pm(this._delegate,e._delegate)}}class Ko extends Kt{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new wn(this.firestore,e):null}doc(e){try{return new wn(this.firestore,void 0===e?_l(this._delegate):_l(this._delegate,e))}catch(t){throw Wt(t,"doc()","CollectionReference.doc()")}}add(e){return function _v(n,e){const t=Pe(n.firestore,tt),i=_l(n),r=Sl(n.converter,e);return Wo(t,[El(ds(n.firestore),"addDoc",i._key,r,null!==n.converter,{}).toMutation(i._key,Xe.exists(!1))]).then(()=>i)}(this._delegate,e).then(t=>new wn(this.firestore,t))}isEqual(e){return lm(this._delegate,e._delegate)}withConverter(e){return new Ko(this.firestore,this._delegate.withConverter(e?ms.getInstance(this.firestore,e):null))}}function gs(n){return Pe(n,et)}class bf{constructor(...e){this._delegate=new xi(...e)}static documentId(){return new bf(it.keyField().canonicalString())}isEqual(e){return(e=(0,Q.m9)(e))instanceof xi&&this._delegate._internalPath.isEqual(e._internalPath)}}class _s{constructor(e){this._delegate=e}static serverTimestamp(){const e=function Ev(){return new cf("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new _s(e)}static delete(){const e=function wv(){return new Eu("deleteField")}();return e._methodName="FieldValue.delete",new _s(e)}static arrayUnion(...e){const t=function Tv(...n){return new Hy("arrayUnion",n)}(...e);return t._methodName="FieldValue.arrayUnion",new _s(t)}static arrayRemove(...e){const t=function Av(...n){return new Yy("arrayRemove",n)}(...e);return t._methodName="FieldValue.arrayRemove",new _s(t)}static increment(e){const t=function xv(n){return new Qy("increment",n)}(e);return t._methodName="FieldValue.increment",new _s(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const Nv={Firestore:Gm,GeoPoint:bl,Timestamp:Qe,Blob:Cu,Transaction:Wm,WriteBatch:Km,DocumentReference:wn,DocumentSnapshot:Du,Query:Kt,QueryDocumentSnapshot:Su,QuerySnapshot:If,CollectionReference:Ko,FieldPath:bf,FieldValue:_s,setLogLevel:function Rv(n){!function Un(n){Xt.setLogLevel(n)}(n)},CACHE_SIZE_UNLIMITED:-1};!function Pv(n){(function Mv(n,e){n.INTERNAL.registerComponent(new W.wA("firestore-compat",t=>{const i=t.getProvider("app-compat").getImmediate(),r=t.getProvider("firestore").getImmediate();return e(i,r)},"PUBLIC").setServiceProps(Object.assign({},Nv)))})(n,(e,t)=>new Gm(e,t,new Sv)),n.registerVersion("@firebase/firestore-compat","0.3.0")}(te.Z);var Lv=R(7579),Fv=R(6451),Ol=R(5363),gr=R(3900),$m=R(4782),Uv=R(590),Vv=R(576);function Hm(n,e){return(0,Vv.m)(e)?(0,gr.w)(()=>n,e):(0,gr.w)(()=>n)}var wf=R(9468);R(259);const Tf=new Map,Qm={activated:!1,tokenObservers:[]},Wv={initialized:!1,enabled:!1};function Nt(n){return Tf.get(n)||Object.assign({},Qm)}function Ml(){return Wv}class Yv{constructor(e,t,i,r,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=i,this.lowerBound=r,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=r,r>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){var t=this;return(0,k.Z)(function*(){t.stop();try{t.pending=new Q.BH,yield function Qv(n){return new Promise(e=>{setTimeout(e,n)})}(t.getNextRun(e)),t.pending.resolve(),yield t.pending.promise,t.pending=new Q.BH,yield t.operation(),t.pending.resolve(),yield t.pending.promise,t.process(!0).catch(()=>{})}catch(i){t.retryPolicy(i)?t.process(!1).catch(()=>{}):t.stop()}})()}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}}const jt=new Q.LL("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function Xm(n){if(!Nt(n).activated)throw jt.create("use-before-activation",{appName:n.name})}function kf(n,e){return Cf.apply(this,arguments)}function Cf(){return Cf=(0,k.Z)(function*({url:n,body:e},t){const i={"Content-Type":"application/json"},r=t.getImmediate({optional:!0});if(r){const w=yield r.getHeartbeatsHeader();w&&(i["X-Firebase-Client"]=w)}const s={method:"POST",body:JSON.stringify(e),headers:i};let u,d;try{u=yield fetch(n,s)}catch(w){throw jt.create("fetch-network-error",{originalErrorMessage:null==w?void 0:w.message})}if(200!==u.status)throw jt.create("fetch-status-error",{httpStatus:u.status});try{d=yield u.json()}catch(w){throw jt.create("fetch-parse-error",{originalErrorMessage:null==w?void 0:w.message})}const f=d.ttl.match(/^([\d.]+)(s)$/);if(!f||!f[2]||isNaN(Number(f[1])))throw jt.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${d.ttl}`});const m=1e3*Number(f[1]),y=Date.now();return{token:d.token,expireTimeMillis:y+m,issuedAtTimeMillis:y}}),Cf.apply(this,arguments)}function t0(n,e){const{projectId:t,appId:i,apiKey:r}=n.options;return{url:`https://content-firebaseappcheck.googleapis.com/v1/projects/${t}/apps/${i}:exchangeDebugToken?key=${r}`,body:{debug_token:e}}}const Ru="firebase-app-check-store";let Fl=null;function tg(){return Fl||(Fl=new Promise((n,e)=>{try{const t=indexedDB.open("firebase-app-check-database",1);t.onsuccess=i=>{n(i.target.result)},t.onerror=i=>{var r;e(jt.create("storage-open",{originalErrorMessage:null===(r=i.target.error)||void 0===r?void 0:r.message}))},t.onupgradeneeded=i=>{0===i.oldVersion&&i.target.result.createObjectStore(Ru,{keyPath:"compositeKey"})}}catch(t){e(jt.create("storage-open",{originalErrorMessage:null==t?void 0:t.message}))}}),Fl)}function Df(){return Df=(0,k.Z)(function*(n,e){const i=(yield tg()).transaction(Ru,"readwrite"),s=i.objectStore(Ru).put({compositeKey:n,value:e});return new Promise((u,d)=>{s.onsuccess=f=>{u()},i.onerror=f=>{var m;d(jt.create("storage-set",{originalErrorMessage:null===(m=f.target.error)||void 0===m?void 0:m.message}))}})}),Df.apply(this,arguments)}const Ou=new ae.Yd("@firebase/app-check");function Of(n,e){return(0,Q.hl)()?function o0(n,e){return function ng(n,e){return Df.apply(this,arguments)}(function rg(n){return`${n.options.appId}-${n.name}`}(n),e)}(n,e).catch(t=>{Ou.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function sg(){return Ml().enabled}function og(){return Mf.apply(this,arguments)}function Mf(){return Mf=(0,k.Z)(function*(){const n=Ml();if(n.enabled&&n.token)return n.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")}),Mf.apply(this,arguments)}const d0={error:"UNKNOWN_ERROR"};function f0(n){return Q.US.encodeString(JSON.stringify(n),!1)}function Ul(n){return Pf.apply(this,arguments)}function Pf(){return Pf=(0,k.Z)(function*(n,e=!1){const t=n.app;Xm(t);const i=Nt(t);let s,r=i.token;if(r&&!jo(r)&&(i.token=void 0,r=void 0),!r){const f=yield i.cachedTokenPromise;f&&(jo(f)?r=f:yield Of(t,void 0))}if(!e&&r&&jo(r))return{token:r.token};let d,u=!1;if(sg()){i.exchangeTokenPromise||(i.exchangeTokenPromise=kf(t0(t,yield og()),n.heartbeatServiceProvider).finally(()=>{i.exchangeTokenPromise=void 0}),u=!0);const f=yield i.exchangeTokenPromise;return yield Of(t,f),i.token=f,{token:f.token}}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally(()=>{i.exchangeTokenPromise=void 0}),u=!0),r=yield Nt(t).exchangeTokenPromise}catch(f){"appCheck/throttled"===f.code?Ou.warn(f.message):Ou.error(f),s=f}return r?s?d=jo(r)?{token:r.token,internalError:s}:cg(s):(d={token:r.token},i.token=r,yield Of(t,r)):d=cg(s),u&&ug(t,d),d}),Pf.apply(this,arguments)}function Ff(n,e){const t=Nt(n),i=t.tokenObservers.filter(r=>r.next!==e);0===i.length&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=i}function ag(n){const{app:e}=n,t=Nt(e);let i=t.tokenRefresher;i||(i=function p0(n){const{app:e}=n;return new Yv((0,k.Z)(function*(){let i;if(i=Nt(e).token?yield Ul(n,!0):yield Ul(n),i.error)throw i.error;if(i.internalError)throw i.internalError}),()=>!0,()=>{const t=Nt(e);if(t.token){let i=t.token.issuedAtTimeMillis+.5*(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)+3e5;return i=Math.min(i,t.token.expireTimeMillis-3e5),Math.max(0,i-Date.now())}return 0},3e4,96e4)}(n),t.tokenRefresher=i),!i.isRunning()&&t.isTokenAutoRefreshEnabled&&i.start()}function ug(n,e){const t=Nt(n).tokenObservers;for(const i of t)try{"EXTERNAL"===i.type&&null!=e.error?i.error(e.error):i.next(e)}catch(r){}}function jo(n){return n.expireTimeMillis-Date.now()>0}function cg(n){return{token:f0(d0),error:n}}class m0{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){const{tokenObservers:e}=Nt(this.app);for(const t of e)Ff(this.app,t.next);return Promise.resolve()}}const _g="app-check-internal";!function D0(){(0,P._registerComponent)(new W.wA("app-check",n=>function g0(n,e){return new m0(n,e)}(n.getProvider("app").getImmediate(),n.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(_g).initialize()})),(0,P._registerComponent)(new W.wA(_g,n=>function _0(n){return{getToken:e=>Ul(n,e),addTokenListener:e=>function Lf(n,e,t,i){const{app:r}=n,s=Nt(r);if(s.tokenObservers=[...s.tokenObservers,{next:t,error:i,type:e}],s.token&&jo(s.token)){const d=s.token;Promise.resolve().then(()=>{t({token:d.token}),ag(n)}).catch(()=>{})}s.cachedTokenPromise.then(()=>ag(n))}(n,"INTERNAL",e),removeTokenListener:e=>Ff(n.app,e)}}(n.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),(0,P.registerVersion)("@firebase/app-check","0.6.0")}();class Zf{constructor(){return(0,U.vb)("app-check")}}"undefined"!=typeof window&&window,R(9260);const vg=new v.OlP("angularfire2.auth.use-emulator"),Ig=new v.OlP("angularfire2.auth.settings"),bg=new v.OlP("angularfire2.auth.tenant-id"),wg=new v.OlP("angularfire2.auth.langugage-code"),Eg=new v.OlP("angularfire2.auth.use-device-language"),Tg=new v.OlP("angularfire.auth.persistence"),Ag=(n,e,t,i,r,s,u,d)=>(0,xe.cc)(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{const f=e.runOutsideAngular(()=>n.auth());if(t&&f.useEmulator(...t),i&&(f.tenantId=i),f.languageCode=r,s&&f.useDeviceLanguage(),u)for(const[m,y]of Object.entries(u))f.settings[m]=y;return d&&f.setPersistence(d),f},[t,i,r,s,u,d]);let xg=(()=>{class n{constructor(t,i,r,s,u,d,f,m,y,w,C,B){const G=new Lv.x,ne=(0,he.of)(void 0).pipe((0,Ol.Q)(u.outsideAngular),(0,gr.w)(()=>s.runOutsideAngular(()=>Promise.resolve().then(R.bind(R,9169)))),(0,Ee.U)(()=>(0,xe.on)(t,s,i)),(0,Ee.U)(ce=>Ag(ce,s,d,m,y,w,f,C)),(0,$m.d)({bufferSize:1,refCount:!1}));if((0,Be.PM)(r))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=(0,he.of)(null);else{ne.pipe((0,Uv.P)()).subscribe();const Ue=ne.pipe((0,gr.w)(Ce=>Ce.getRedirectResult().then(ke=>ke,()=>null)),U.iC,(0,$m.d)({bufferSize:1,refCount:!1})),je=ne.pipe((0,gr.w)(Ce=>new g.y(ke=>({unsubscribe:s.runOutsideAngular(()=>Ce.onAuthStateChanged(De=>ke.next(De),De=>ke.error(De),()=>ke.complete()))})))),Oe=ne.pipe((0,gr.w)(Ce=>new g.y(ke=>({unsubscribe:s.runOutsideAngular(()=>Ce.onIdTokenChanged(De=>ke.next(De),De=>ke.error(De),()=>ke.complete()))}))));this.authState=Ue.pipe(Hm(je),(0,wf.R)(u.outsideAngular),(0,Ol.Q)(u.insideAngular)),this.user=Ue.pipe(Hm(Oe),(0,wf.R)(u.outsideAngular),(0,Ol.Q)(u.insideAngular)),this.idToken=this.user.pipe((0,gr.w)(Ce=>Ce?(0,de.D)(Ce.getIdToken()):(0,he.of)(null))),this.idTokenResult=this.user.pipe((0,gr.w)(Ce=>Ce?(0,de.D)(Ce.getIdTokenResult()):(0,he.of)(null))),this.credential=(0,Fv.T)(Ue,G,this.authState.pipe((0,me.h)(Ce=>!Ce))).pipe((0,Ee.U)(Ce=>(null==Ce?void 0:Ce.user)?Ce:null),(0,wf.R)(u.outsideAngular),(0,Ol.Q)(u.insideAngular))}return(0,xe.pX)(this,ne,s,{spy:{apply:(ce,Ue,je)=>{(ce.startsWith("signIn")||ce.startsWith("createUser"))&&je.then(Oe=>G.next(Oe))}}})}}return n.\u0275fac=function(t){return new(t||n)(v.LFG(xe.Dh),v.LFG(xe.xv,8),v.LFG(v.Lbi),v.LFG(v.R0b),v.LFG(U.HU),v.LFG(vg,8),v.LFG(Ig,8),v.LFG(bg,8),v.LFG(wg,8),v.LFG(Eg,8),v.LFG(Tg,8),v.LFG(Zf,8))},n.\u0275prov=v.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})();function kg(n,e){return function P0(n,e=N.z){return new g.y(t=>{let i;return null!=e?e.schedule(()=>{i=n.onSnapshot({includeMetadataChanges:!0},t)}):i=n.onSnapshot({includeMetadataChanges:!0},t),()=>{null!=i&&i()}})}(n,e)}function Gf(n,e){return kg(n,e).pipe((0,Ee.U)(t=>({payload:t,type:"query"})))}function Bl(n,e){return Gf(n,e).pipe((0,ve.O)(void 0),Se(),(0,Ee.U)(([t,i])=>{const r=i.payload.docChanges(),s=r.map(u=>({type:u.type,payload:u}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((u,d)=>{const f=r.find(y=>y.doc.ref.isEqual(u.ref)),m=null==t?void 0:t.payload.docs.find(y=>y.ref.isEqual(u.ref));f&&JSON.stringify(f.doc.metadata)===JSON.stringify(u.metadata)||!f&&m&&JSON.stringify(m.metadata)===JSON.stringify(u.metadata)||s.push({type:"modified",payload:{oldIndex:d,newIndex:d,type:"modified",doc:u}})}),s}))}function Cg(n,e,t){return Bl(n,t).pipe((0,Te.R)((i,r)=>function F0(n,e,t){return e.forEach(i=>{t.indexOf(i.type)>-1&&(n=function U0(n,e){switch(e.type){case"added":if(!n[e.newIndex]||!n[e.newIndex].doc.ref.isEqual(e.doc.ref))return Wf(n,e.newIndex,0,e);break;case"modified":if(null==n[e.oldIndex]||n[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}return Wf(n,e.newIndex,1,e)}break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return Wf(n,e.oldIndex,1)}return n}(n,i))}),n}(i,r.map(s=>s.payload),e),[]),(0,oe.x)(),(0,Ee.U)(i=>i.map(r=>({type:r.type,payload:r}))))}function Wf(n,e,t,...i){const r=n.slice();return r.splice(e,t,...i),r}function Dg(n){return(!n||0===n.length)&&(n=["added","removed","modified"]),n}class Sg{constructor(e,t,i){this.ref=e,this.query=t,this.afs=i}stateChanges(e){let t=Bl(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe((0,Ee.U)(i=>i.filter(r=>e.indexOf(r.type)>-1)))),t.pipe((0,ve.O)(void 0),Se(),(0,me.h)(([i,r])=>r.length>0||!i),(0,Ee.U)(([i,r])=>r),U.iC)}auditTrail(e){return this.stateChanges(e).pipe((0,Te.R)((t,i)=>[...t,...i],[]))}snapshotChanges(e){const t=Dg(e);return Cg(this.query,t,this.afs.schedulers.outsideAngular).pipe(U.iC)}valueChanges(e={}){return Gf(this.query,this.afs.schedulers.outsideAngular).pipe((0,Ee.U)(t=>t.payload.docs.map(i=>e.idField?Object.assign(Object.assign({},i.data()),{[e.idField]:i.id}):i.data())),U.iC)}get(e){return(0,de.D)(this.query.get(e)).pipe(U.iC)}add(e){return this.ref.add(e)}doc(e){return new Rg(this.ref.doc(e),this.afs)}}class Rg{constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){const i=this.ref.collection(e),{ref:r,query:s}=Og(i,t);return new Sg(r,s,this.afs)}snapshotChanges(){return function L0(n,e){return kg(n,e).pipe((0,ve.O)(void 0),Se(),(0,Ee.U)(([t,i])=>i.exists?(null==t?void 0:t.exists)?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(U.iC)}valueChanges(e={}){return this.snapshotChanges().pipe((0,Ee.U)(({payload:t})=>e.idField?Object.assign(Object.assign({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return(0,de.D)(this.ref.get(e)).pipe(U.iC)}}class V0{constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return e&&0!==e.length?Bl(this.query,this.afs.schedulers.outsideAngular).pipe((0,Ee.U)(t=>t.filter(i=>e.indexOf(i.type)>-1)),(0,me.h)(t=>t.length>0),U.iC):Bl(this.query,this.afs.schedulers.outsideAngular).pipe(U.iC)}auditTrail(e){return this.stateChanges(e).pipe((0,Te.R)((t,i)=>[...t,...i],[]))}snapshotChanges(e){const t=Dg(e);return Cg(this.query,t,this.afs.schedulers.outsideAngular).pipe(U.iC)}valueChanges(e={}){return Gf(this.query,this.afs.schedulers.outsideAngular).pipe((0,Ee.U)(i=>i.payload.docs.map(r=>e.idField?Object.assign({[e.idField]:r.id},r.data()):r.data())),U.iC)}get(e){return(0,de.D)(this.query.get(e)).pipe(U.iC)}}const B0=new v.OlP("angularfire2.enableFirestorePersistence"),Z0=new v.OlP("angularfire2.firestore.persistenceSettings"),q0=new v.OlP("angularfire2.firestore.settings"),G0=new v.OlP("angularfire2.firestore.use-emulator");function Og(n,e=(t=>t)){return{query:e(n),ref:n}}let W0=(()=>{class n{constructor(t,i,r,s,u,d,f,m,y,w,C,B,G,ne,ce,Ue,je){this.schedulers=f;const Oe=(0,xe.on)(t,d,i),Ce=y;w&&Ag(Oe,d,C,G,ne,ce,B,Ue),[this.firestore,this.persistenceEnabled$]=(0,xe.cc)(`${Oe.name}.firestore`,"AngularFirestore",Oe.name,()=>{const ke=d.runOutsideAngular(()=>Oe.firestore());if(s&&ke.settings(s),Ce&&ke.useEmulator(...Ce),r&&!(0,Be.PM)(u)){const De=()=>{try{return(0,de.D)(ke.enablePersistence(m||void 0).then(()=>!0,()=>!1))}catch(bt){return"undefined"!=typeof console&&console.warn(bt),(0,he.of)(!1)}};return[ke,d.runOutsideAngular(De)]}return[ke,(0,he.of)(!1)]},[s,Ce,r])}collection(t,i){let r;r="string"==typeof t?this.firestore.collection(t):t;const{ref:s,query:u}=Og(r,i),d=this.schedulers.ngZone.run(()=>s);return new Sg(d,u,this)}collectionGroup(t,i){const r=i||(u=>u),s=this.firestore.collectionGroup(t);return new V0(r(s),this)}doc(t){let i;i="string"==typeof t?this.firestore.doc(t):t;const r=this.schedulers.ngZone.run(()=>i);return new Rg(r,this)}createId(){return this.firestore.collection("_").doc().id}}return n.\u0275fac=function(t){return new(t||n)(v.LFG(xe.Dh),v.LFG(xe.xv,8),v.LFG(B0,8),v.LFG(q0,8),v.LFG(v.Lbi),v.LFG(v.R0b),v.LFG(U.HU),v.LFG(Z0,8),v.LFG(G0,8),v.LFG(xg,8),v.LFG(vg,8),v.LFG(Ig,8),v.LFG(bg,8),v.LFG(wg,8),v.LFG(Eg,8),v.LFG(Tg,8),v.LFG(Zf,8))},n.\u0275prov=v.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})()},5619:(Yt,Ke,R)=>{R.d(Ke,{v:()=>ve});var v=R(5e3),N=R(4968),g=R(641),de=R(5216),he=R(432),U=R(2340);class Ie extends he.C{constructor(Te){super(void 0,Te),this.size=64}drawPosition(){}drawActorName(){}drawShape(){this._img||(this._img=document.createElement("img"),this._img.src=U.N.production?"/vb_positions/assets/icons/icon-192x192.png":"/assets/icons/icon-192x192.png",this._img.onload=()=>this.draw()),this.context.drawImage(this._img,this.x-this.size/2,this.y-this.size/2,this.size,this.size)}isHit(Te,oe){return Te>=this.x-this.size/2&&Te<=this.x+this.size/2&&oe>=this.y-this.size/2&&oe<=this.y+this.size/2}copy(Te){return new Ie(this.context)}}var ze=R(3371);const Se=["field"];let ve=(()=>{class Ee{constructor(){this.measureMode=!1,this.actors=[],this.lines=[],this.courtMode=de.T.MOVE_ACTOR,this.drawColor=ze.D.Black,this.customRender=()=>{},this.onRender=new v.vpe,this.onReady=new v.vpe,this.onLineAdded=new v.vpe,this.onLineErased=new v.vpe,this.volleyballPosition=new v.vpe,this.mouseDown=!1}ngAfterViewInit(){this.context=this.fieldElement.nativeElement.getContext("2d"),this.context.canvas.width=this.context.canvas.getBoundingClientRect().width,this.context.canvas.height=this.context.canvas.getBoundingClientRect().height;for(const oe of[["touchstart","mousedown"],["touchmove","mousemove"]])this.context.canvas.addEventListener(oe[0],me=>{const xe=me.touches[0];this.fieldElement.nativeElement.dispatchEvent(new MouseEvent(oe[1],{clientX:xe.clientX,clientY:xe.clientY}))});this.context.canvas.addEventListener("touchend",()=>this.onMouseUp()),this.context.canvas.addEventListener("touchcancel",()=>this.onMouseUp()),this.fieldElement.nativeElement.addEventListener("mousedown",oe=>this.onMouseDown(oe)),this.fieldElement.nativeElement.addEventListener("mouseup",()=>this.onMouseUp()),this.fieldElement.nativeElement.addEventListener("mouseleave",()=>this.onMouseUp()),this.fieldElement.nativeElement.addEventListener("mousemove",oe=>this.onMouseMove(oe)),this.measureMode&&(this._volleyball=new Ie(this.context),this._volleyball.setPosition(this.context.canvas.width/2,this.context.canvas.height/2)),(0,N.R)(window,"resize").subscribe(()=>this.render()),setTimeout(()=>this.onReady.emit(this.context),100),setTimeout(()=>this.render(),50),setTimeout(()=>this.render(),500)}ngOnChanges(){!this.context||this.render()}onMouseDown(oe){const me=this.context.canvas.getBoundingClientRect(),xe=oe.clientX-me.left,Be=oe.clientY-me.top;if(this.mouseDown=!0,this._volleyball&&this._volleyball.isHit(xe,Be))this.draggedShape=this._volleyball;else if(this.courtMode===de.T.MOVE_ACTOR)for(let l=this.actors.length-1;l>=0;--l){const te=this.actors[l];if(te.isHit(xe,Be))return void(this.draggedShape=te)}else this.courtMode===de.T.DRAW_LINE&&(this.drawnLine=new g.x(this.context,this.drawColor),this.drawnLine.addPosition(xe,Be))}onMouseUp(){this.drawnLine&&this.onLineAdded.emit(this.drawnLine),this.draggedShape=void 0,this.drawnLine=void 0,this.mouseDown=!1}onMouseMove(oe){const me=this.context.canvas.getBoundingClientRect(),xe=oe.clientX-me.left,Be=oe.clientY-me.top;if(this.courtMode===de.T.ERASE_LINE){if(this.mouseDown){const l=this.lines.find(te=>te.isHit(xe,Be));if(!l)return;this.onLineErased.emit(l)}}else if(this.draggedShape)this._volleyball&&this.emitVolleyballPosition(),this.draggedShape.setPosition(xe,Be);else{if(!this.drawnLine)return;this.drawnLine.addPosition(xe,Be)}this.render()}render(){this.context.canvas.width=this.context.canvas.getBoundingClientRect().width,this.context.canvas.height=this.context.canvas.getBoundingClientRect().height,this.initCourt(),this.actors.forEach(oe=>oe.draw()),this.lines.forEach(oe=>oe.draw()),this.drawnLine&&this.drawnLine.draw(),this._volleyball&&this._volleyball.draw(),this.customRender(this.context),this.onRender.emit()}initCourt(){const oe=this.context.canvas.getBoundingClientRect().width,me=this.context.canvas.getBoundingClientRect().height;this.context.clearRect(0,0,oe,me),this.context.fillStyle=Ee.OUTER_COLOR,this.context.fillRect(0,0,oe,me);const xe=.025*oe,l=(me-.025*me)/10,te=(oe-2*xe)/9,k=xe,P=oe-2*xe;this.context.fillStyle=Ee.FRONT_FIELD_COLOR,this.context.fillRect(k,0,P,4*l),this.context.fillStyle=Ee.BACK_FIELD_COLOR,this.context.fillRect(k,4*l,P,6*l);const W=l/20,ae=te/20;this.context.fillStyle=Ee.LINE_COLOR,this.context.fillRect(k,0,ae,10*l),this.context.fillRect(P+k-ae,0,ae,10*l),this.context.fillRect(k,4*l,P,W),this.context.fillRect(k,10*l,P,W),this.context.fillRect(k,l-3*W,P,3*W)}emitVolleyballPosition(){if(!this._volleyball)return;const oe=this._volleyball.getFieldPosition(),me=[225,1e3];this.volleyballPosition.emit([oe.x,oe.y,Number(((oe.x-me[0])/1e3).toFixed(2)),Number(((oe.y-me[1])/1e3).toFixed(2))])}}return Ee.OUTER_COLOR="#469ABB",Ee.LINE_COLOR="#FFFFFF",Ee.FRONT_FIELD_COLOR="#FF5202",Ee.BACK_FIELD_COLOR="#F8A941",Ee.\u0275fac=function(oe){return new(oe||Ee)},Ee.\u0275cmp=v.Xpm({type:Ee,selectors:[["vpms-court"]],viewQuery:function(oe,me){if(1&oe&&v.Gf(Se,5),2&oe){let xe;v.iGM(xe=v.CRH())&&(me.fieldElement=xe.first)}},inputs:{measureMode:"measureMode",actors:"actors",lines:"lines",courtMode:"courtMode",drawColor:"drawColor",customRender:"customRender"},outputs:{onRender:"onRender",onReady:"onReady",onLineAdded:"onLineAdded",onLineErased:"onLineErased",volleyballPosition:"volleyballPosition"},features:[v.TTD],decls:2,vars:0,consts:[["field",""]],template:function(oe,me){1&oe&&v._UZ(0,"canvas",null,0)},styles:["[_ngcontent-%COMP%]:root{--vpms-primary-palette-50: #DAE8F3;--vpms-primary-palette-100: #9DC1DF;--vpms-primary-palette-200: #80AED5;--vpms-primary-palette-300: #609ACA;--vpms-primary-palette-400: #2F7BBA;--vpms-primary-palette-500: #0A64AE;--vpms-primary-palette-600: #095A9D;--vpms-primary-palette-700: #063C68;--vpms-primary-palette-800: #042846;--vpms-primary-palette-900: #021423;--vpms-accent-palette-50: #FEF2F8;--vpms-accent-palette-100: #F8BFDF;--vpms-accent-palette-200: #F599CB;--vpms-accent-palette-300: #EF66B1;--vpms-accent-palette-400: #EA3397;--vpms-accent-palette-500: #E5007D;--vpms-accent-palette-600: #CE0071;--vpms-accent-palette-700: #AC005E;--vpms-accent-palette-800: #7E0045;--vpms-accent-palette-900: #50002C;--vpms-grayscale-0: #FFFFFF;--vpms-grayscale-50: #FAFAFA;--vpms-grayscale-100: #F2F2F2;--vpms-grayscale-200: #E6E6E6;--vpms-grayscale-250: #DADAD9;--vpms-grayscale-300: #CCCCCC;--vpms-grayscale-400: #B3B3B3;--vpms-grayscale-500: #999999;--vpms-grayscale-600: #808080;--vpms-grayscale-700: #666666;--vpms-grayscale-800: #4D4D4D;--vpms-grayscale-900: #333333;--vpms-grayscale-1000: #000000}[_nghost-%COMP%]{display:block;height:100%}canvas[_ngcontent-%COMP%]{display:block;height:100%;width:100%;touch-action:none}"]}),Ee})()},701:(Yt,Ke,R)=>{R.r(Ke),R.d(Ke,{FieldModule:()=>zo});var v=R(9298),N=R(1062),g=R(2705),de=R(432);let he=(()=>{class x extends de.C{constructor(b,I,Z,X,ye){super(b,I,X,ye),this.dashed=Z}drawShape(){this.context.beginPath(),this.context.ellipse(this.x,this.y,x.RADIUS*this.sizeCoefficientX(),x.RADIUS*this.sizeCoefficientY(),0,0,2*Math.PI),this.context.fillStyle=de.C.ACTOR_COLOR,this.context.fill(),this.context.lineWidth=3,this.context.strokeStyle="#003300",this.context.setLineDash(this.dashed?[6]:[]),this.context.stroke()}drawPosition(){const b=this.currentPosition();!b||(this.context.font="30px Roboto",this.context.fillStyle="#000000",this.context.textAlign="center",this.context.fillText(b.value.toString(),this.x,this.y+12))}drawActorName(){!this.actor.player_name||(this.context.font="20px Roboto",this.context.fillStyle="#000000",this.context.textAlign="center",this.context.fillText(this.actor.player_name,this.x,this.y+x.RADIUS*this.sizeCoefficientY()*1.5+5))}isHit(b,I){return b>=this.x-x.RADIUS*this.sizeCoefficientX()&&b<=this.x+x.RADIUS*this.sizeCoefficientX()&&I>=this.y-x.RADIUS*this.sizeCoefficientY()&&I<=this.y+x.RADIUS*this.sizeCoefficientY()}copy(b){return new x(b,this.context,this.dashed,this.fieldPosition,this.rotationOffset)}}return x.RADIUS=25,x})();var U=R(3075);class Ie{constructor(F){if(F<1||F>6)throw new Error("Player position must be between 1 and 6.");this._position=F}get value(){return this._position}rotate(F){let I=this._position+(F._position-1);return I>6&&(I-=6),new Ie(I)}}var ze=R(7691);let Se=(()=>{class x extends de.C{constructor(b,I,Z,X){super(b,I,Z,X)}drawShape(){this.context.beginPath(),this.context.ellipse(this.x,this.y,x.RADIUS*this.sizeCoefficientX(),x.RADIUS*this.sizeCoefficientY(),0,0,Math.PI,!0),this.context.fillStyle=de.C.ACTOR_COLOR,this.context.fill(),this.context.setLineDash([]),this.context.closePath(),this.context.lineWidth=3,this.context.strokeStyle="#003300",this.context.stroke()}drawPosition(){const b=this.currentPosition();!b||(this.context.font="30px Roboto",this.context.fillStyle="#000000",this.context.textAlign="center",this.context.fillText(b.value.toString(),this.x,this.y-6))}drawActorName(){!this.actor.player_name||(this.context.font="20px Roboto",this.context.fillStyle="#000000",this.context.textAlign="center",this.context.fillText(this.actor.player_name,this.x,this.y+x.RADIUS/2*this.sizeCoefficientY()+3))}isHit(b,I){return b>=this.x-x.RADIUS*this.sizeCoefficientX()&&b<=this.x+x.RADIUS*this.sizeCoefficientX()&&I>=this.y-x.RADIUS*this.sizeCoefficientY()&&I<=this.y}copy(b){return new x(b,this.context,this.fieldPosition,this.rotationOffset)}}return x.RADIUS=30,x})();var ve=(()=>{return(x=ve||(ve={})).Setter="Setter",x.MiddleBlocker="Middle blocker",x.Libero="Libero",x.OutsideHitter="Outside hitter",x.OppositeHitter="Opposite hitter",x.DefensiveSpecialist="Defensive specialist",ve;var x})();let Ee=(()=>{class x extends de.C{constructor(b,I,Z,X,ye){super(b,I,X,ye),this.dashed=Z}drawActorName(){!this.actor.player_name||(this.context.font="20px Roboto",this.context.fillStyle="#000000",this.context.textAlign="center",this.context.fillText(this.actor.player_name,this.x,this.y+x.SIZE*this.sizeCoefficientY()*1.6+5))}drawPosition(){const b=this.currentPosition();!b||(this.context.font="30px Roboto",this.context.fillStyle="#000000",this.context.textAlign="center",this.context.fillText(b.value.toString(),this.x-2,this.y+20))}drawShape(){this.context.beginPath(),this.context.lineWidth=4,this.context.strokeStyle="#003300",this.context.setLineDash(this.dashed?[6]:[]),this.context.moveTo(this.x-x.SIZE*this.sizeCoefficientX(),this.y+x.SIZE*this.sizeCoefficientY()),this.context.lineTo(this.x+x.SIZE*this.sizeCoefficientX(),this.y+x.SIZE*this.sizeCoefficientY()),this.context.lineTo(this.x,this.y-x.SIZE*this.sizeCoefficientY()),this.context.closePath(),this.context.stroke(),this.context.fillStyle=de.C.ACTOR_COLOR,this.context.fill()}isHit(b,I){return b>=this.x-x.SIZE*this.sizeCoefficientX()&&b<=this.x+x.SIZE*this.sizeCoefficientX()&&I>=this.y-x.SIZE*this.sizeCoefficientY()&&I<=this.y+x.SIZE*this.sizeCoefficientY()}copy(b){return new x(b,this.context,this.dashed,this.fieldPosition,this.rotationOffset)}}return x.SIZE=25,x})();var Te=R(641);let oe=(()=>{class x extends de.C{constructor(b,I,Z,X){super(b,I,Z,X)}drawActorName(){!this.actor.player_name||(this.context.font="20px Roboto",this.context.fillStyle="#000000",this.context.textAlign="center",this.context.fillText(this.actor.player_name,this.x,this.y+x.SIZE*this.sizeCoefficientY()*1.6+5))}drawPosition(){const b=this.currentPosition();!b||(this.context.font="30px Roboto",this.context.fillStyle="#000000",this.context.textAlign="center",this.context.fillText(b.value.toString(),this.x,this.y+x.SIZE/2*this.sizeCoefficientY()-2))}drawShape(){this.context.beginPath(),this.context.lineWidth=4,this.context.strokeStyle="#003300",this.context.setLineDash([]),this.context.moveTo(this.x-x.SIZE*this.sizeCoefficientX(),this.y+x.SIZE*this.sizeCoefficientY()),this.context.lineTo(this.x+x.SIZE*this.sizeCoefficientX(),this.y+x.SIZE*this.sizeCoefficientY()),this.context.lineTo(this.x+x.SIZE*this.sizeCoefficientX(),this.y-x.SIZE*this.sizeCoefficientY()),this.context.lineTo(this.x-x.SIZE*this.sizeCoefficientX(),this.y-x.SIZE*this.sizeCoefficientY()),this.context.closePath(),this.context.stroke(),this.context.fillStyle=de.C.ACTOR_COLOR,this.context.fill()}isHit(b,I){return b>=this.x-x.SIZE*this.sizeCoefficientX()&&b<=this.x+x.SIZE*this.sizeCoefficientX()&&I>=this.y-x.SIZE*this.sizeCoefficientY()&&I<=this.y+x.SIZE*this.sizeCoefficientY()}copy(b){return new x(b,this.context,this.fieldPosition,this.rotationOffset)}}return x.SIZE=25,x})();var me=R(3371);class xe{static fromActorDto(F,b,I){const Z={x:b.f.x,y:b.f.y},X="NULL"===b.ro?void 0:new Ie(b.ro);switch(F.player_role){case ve.Setter:return new Se(F,I,Z,X);case ve.MiddleBlocker:case ve.Libero:return new Ee(F,I,!1,Z,X);case ve.DefensiveSpecialist:return new oe(F,I,Z,X);case ve.OutsideHitter:return new he(F,I,!1,Z,X);case ve.OppositeHitter:return new he(F,I,!0,Z,X)}}static fromLineDto(F,b){var I;const Z=Math.max(...Object.keys(F.f).map(ye=>Number(ye))),X=[];for(let ye=0;ye<=Z;++ye)X.push({x:Number(F.f[ye.toString()].x),y:Number(F.f[ye.toString()].y)});return new Te.x(b,null!==(I=F.c)&&void 0!==I?I:me.D.Black,X)}}class Be{constructor(F,b,I,Z,X){this.position=F,this.player_role=b,this.player_name=I,this._UUID=Z||(0,ze.k)(),X&&(this._shape=X)}get UUID(){return this._UUID}get shape(){return this._shape}static fromDto(F,b){const I=new Be(new Ie(F.p),F.pr,"NULL"===F.pn?void 0:F.pn,F.u),Z=xe.fromActorDto(I,F.s,b);return I.setShape(Z),I}toDto(){var F;return{pn:null!==(F=this.player_name)&&void 0!==F?F:"NULL",pr:this.player_role,p:this.position.value,u:this.UUID,s:this.shape.toDto()}}setShape(F){this._shape=F}draw(){this.shape.draw()}toString(){return this.player_name?`${this.player_name} (${this.position.value}) - ${this.player_role.toString()}`:`Unnamed actor (${this.position.value}) - ${this.player_role.toString()}`}copy(){const F=new Be(this.position,this.player_role,this.player_name,void 0,void 0);return F.setShape(this.shape.copy(F)),F}}var l=R(5e3),te=R(8966),k=R(7322),P=R(7531),W=R(4107),ae=R(508);let Q=(()=>{class x{constructor(){}}return x.\u0275fac=function(b){return new(b||x)},x.\u0275cmp=l.Xpm({type:x,selectors:[["vpms-position-form-field"]],inputs:{formGroup:"formGroup"},decls:18,vars:10,consts:[[3,"formGroup"],["appearance","fill"],["formControlName","position"],[3,"value"]],template:function(b,I){1&b&&(l.ynx(0,0),l.TgZ(1,"mat-form-field",1)(2,"mat-label"),l._uU(3),l.ALo(4,"translate"),l.qZA(),l.TgZ(5,"mat-select",2)(6,"mat-option",3),l._uU(7,"1"),l.qZA(),l.TgZ(8,"mat-option",3),l._uU(9,"2"),l.qZA(),l.TgZ(10,"mat-option",3),l._uU(11,"3"),l.qZA(),l.TgZ(12,"mat-option",3),l._uU(13,"4"),l.qZA(),l.TgZ(14,"mat-option",3),l._uU(15,"5"),l.qZA(),l.TgZ(16,"mat-option",3),l._uU(17,"6"),l.qZA()()(),l.BQk()),2&b&&(l.Q6J("formGroup",I.formGroup),l.xp6(3),l.Oqu(l.lcZ(4,8,"add_actor_dialog.placeholder.position")),l.xp6(3),l.Q6J("value",1),l.xp6(2),l.Q6J("value",2),l.xp6(2),l.Q6J("value",3),l.xp6(2),l.Q6J("value",4),l.xp6(2),l.Q6J("value",5),l.xp6(2),l.Q6J("value",6))},directives:[U.JL,U.sg,k.KE,k.hX,W.gD,U.JJ,U.u,ae.ey],pipes:[N.X$],styles:["[_ngcontent-%COMP%]:root{--vpms-primary-palette-50: #DAE8F3;--vpms-primary-palette-100: #9DC1DF;--vpms-primary-palette-200: #80AED5;--vpms-primary-palette-300: #609ACA;--vpms-primary-palette-400: #2F7BBA;--vpms-primary-palette-500: #0A64AE;--vpms-primary-palette-600: #095A9D;--vpms-primary-palette-700: #063C68;--vpms-primary-palette-800: #042846;--vpms-primary-palette-900: #021423;--vpms-accent-palette-50: #FEF2F8;--vpms-accent-palette-100: #F8BFDF;--vpms-accent-palette-200: #F599CB;--vpms-accent-palette-300: #EF66B1;--vpms-accent-palette-400: #EA3397;--vpms-accent-palette-500: #E5007D;--vpms-accent-palette-600: #CE0071;--vpms-accent-palette-700: #AC005E;--vpms-accent-palette-800: #7E0045;--vpms-accent-palette-900: #50002C;--vpms-grayscale-0: #FFFFFF;--vpms-grayscale-50: #FAFAFA;--vpms-grayscale-100: #F2F2F2;--vpms-grayscale-200: #E6E6E6;--vpms-grayscale-250: #DADAD9;--vpms-grayscale-300: #CCCCCC;--vpms-grayscale-400: #B3B3B3;--vpms-grayscale-500: #999999;--vpms-grayscale-600: #808080;--vpms-grayscale-700: #666666;--vpms-grayscale-800: #4D4D4D;--vpms-grayscale-900: #333333;--vpms-grayscale-1000: #000000}mat-button-toggle-group[_ngcontent-%COMP%]{margin-bottom:.5rem}"]}),x})(),qe=(()=>{class x{constructor(){this.PlayerRole=ve}}return x.\u0275fac=function(b){return new(b||x)},x.\u0275cmp=l.Xpm({type:x,selectors:[["vpms-player-role-form-field"]],inputs:{formGroup:"formGroup"},decls:24,vars:28,consts:[[3,"formGroup"],["appearance","fill"],["formControlName","player_role"],[3,"value"]],template:function(b,I){1&b&&(l.ynx(0,0),l.TgZ(1,"mat-form-field",1)(2,"mat-label"),l._uU(3),l.ALo(4,"translate"),l.qZA(),l.TgZ(5,"mat-select",2)(6,"mat-option",3),l._uU(7),l.ALo(8,"translate"),l.qZA(),l.TgZ(9,"mat-option",3),l._uU(10),l.ALo(11,"translate"),l.qZA(),l.TgZ(12,"mat-option",3),l._uU(13),l.ALo(14,"translate"),l.qZA(),l.TgZ(15,"mat-option",3),l._uU(16),l.ALo(17,"translate"),l.qZA(),l.TgZ(18,"mat-option",3),l._uU(19),l.ALo(20,"translate"),l.qZA(),l.TgZ(21,"mat-option",3),l._uU(22),l.ALo(23,"translate"),l.qZA()()(),l.BQk()),2&b&&(l.Q6J("formGroup",I.formGroup),l.xp6(3),l.Oqu(l.lcZ(4,14,"add_actor_dialog.placeholder.player_role")),l.xp6(3),l.Q6J("value",I.PlayerRole.Setter),l.xp6(1),l.Oqu(l.lcZ(8,16,"add_actor_dialog.player_roles.setter")),l.xp6(2),l.Q6J("value",I.PlayerRole.MiddleBlocker),l.xp6(1),l.Oqu(l.lcZ(11,18,"add_actor_dialog.player_roles.middle_blocker")),l.xp6(2),l.Q6J("value",I.PlayerRole.Libero),l.xp6(1),l.Oqu(l.lcZ(14,20,"add_actor_dialog.player_roles.libero")),l.xp6(2),l.Q6J("value",I.PlayerRole.DefensiveSpecialist),l.xp6(1),l.Oqu(l.lcZ(17,22,"add_actor_dialog.player_roles.defensive_specialist")),l.xp6(2),l.Q6J("value",I.PlayerRole.OutsideHitter),l.xp6(1),l.Oqu(l.lcZ(20,24,"add_actor_dialog.player_roles.outside_hitter")),l.xp6(2),l.Q6J("value",I.PlayerRole.OppositeHitter),l.xp6(1),l.Oqu(l.lcZ(23,26,"add_actor_dialog.player_roles.opposite_hitter")))},directives:[U.JL,U.sg,k.KE,k.hX,W.gD,U.JJ,U.u,ae.ey],pipes:[N.X$],styles:["[_ngcontent-%COMP%]:root{--vpms-primary-palette-50: #DAE8F3;--vpms-primary-palette-100: #9DC1DF;--vpms-primary-palette-200: #80AED5;--vpms-primary-palette-300: #609ACA;--vpms-primary-palette-400: #2F7BBA;--vpms-primary-palette-500: #0A64AE;--vpms-primary-palette-600: #095A9D;--vpms-primary-palette-700: #063C68;--vpms-primary-palette-800: #042846;--vpms-primary-palette-900: #021423;--vpms-accent-palette-50: #FEF2F8;--vpms-accent-palette-100: #F8BFDF;--vpms-accent-palette-200: #F599CB;--vpms-accent-palette-300: #EF66B1;--vpms-accent-palette-400: #EA3397;--vpms-accent-palette-500: #E5007D;--vpms-accent-palette-600: #CE0071;--vpms-accent-palette-700: #AC005E;--vpms-accent-palette-800: #7E0045;--vpms-accent-palette-900: #50002C;--vpms-grayscale-0: #FFFFFF;--vpms-grayscale-50: #FAFAFA;--vpms-grayscale-100: #F2F2F2;--vpms-grayscale-200: #E6E6E6;--vpms-grayscale-250: #DADAD9;--vpms-grayscale-300: #CCCCCC;--vpms-grayscale-400: #B3B3B3;--vpms-grayscale-500: #999999;--vpms-grayscale-600: #808080;--vpms-grayscale-700: #666666;--vpms-grayscale-800: #4D4D4D;--vpms-grayscale-900: #333333;--vpms-grayscale-1000: #000000}mat-button-toggle-group[_ngcontent-%COMP%]{margin-bottom:.5rem}"]}),x})();var $=R(7423);let T=(()=>{class x{constructor(b,I){this.fb=b,this.dialogRef=I}onSubmit(){this.dialogRef.close(new Be(new Ie(this.formGroup.value.position),this.formGroup.value.player_role,this.formGroup.value.player_name))}ngOnInit(){this.formGroup=this.fb.group({player_name:[null],position:[null,U.kI.required],player_role:[null,U.kI.required]})}}return x.\u0275fac=function(b){return new(b||x)(l.Y36(U.qu),l.Y36(te.so))},x.\u0275cmp=l.Xpm({type:x,selectors:[["vpms-add-actor-dialog"]],decls:18,vars:16,consts:[["mat-dialog-title",""],[3,"formGroup","submit"],["appearance","fill","tabindex","-1"],["matInput","","formControlName","player_name"],[3,"formGroup"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["mat-raised-button","","color","primary","type","button",2,"margin-top","1rem",3,"click"]],template:function(b,I){1&b&&(l.TgZ(0,"h1",0),l._uU(1),l.ALo(2,"translate"),l.qZA(),l.TgZ(3,"mat-dialog-content",1),l.NdJ("submit",function(){return I.onSubmit()}),l.TgZ(4,"form")(5,"mat-form-field",2)(6,"mat-label"),l._uU(7),l.ALo(8,"translate"),l.qZA(),l._UZ(9,"input",3),l.qZA(),l._UZ(10,"vpms-position-form-field",4)(11,"vpms-player-role-form-field",4),l.TgZ(12,"button",5),l._uU(13),l.ALo(14,"translate"),l.qZA(),l.TgZ(15,"button",6),l.NdJ("click",function(){return I.dialogRef.close()}),l._uU(16),l.ALo(17,"translate"),l.qZA()()()),2&b&&(l.xp6(1),l.Oqu(l.lcZ(2,8,"add_actor_dialog.title")),l.xp6(2),l.Q6J("formGroup",I.formGroup),l.xp6(4),l.Oqu(l.lcZ(8,10,"add_actor_dialog.placeholder.player_name")),l.xp6(3),l.Q6J("formGroup",I.formGroup),l.xp6(1),l.Q6J("formGroup",I.formGroup),l.xp6(1),l.Q6J("disabled",I.formGroup.invalid),l.xp6(1),l.hij(" ",l.lcZ(14,12,"add_actor_dialog.submit")," "),l.xp6(3),l.hij(" ",l.lcZ(17,14,"field.close")," "))},directives:[te.uh,te.xY,U.JL,U.sg,U._Y,k.KE,k.hX,P.Nt,U.Fj,U.JJ,U.u,Q,qe,$.lW],pipes:[N.X$],styles:["form[_ngcontent-%COMP%]{display:flex;flex-direction:column}"]}),x})();var ge=R(9808);function re(x,F){if(1&x&&(l.TgZ(0,"mat-option",7),l._uU(1),l.qZA()),2&x){const b=F.$implicit;l.Q6J("value",b.UUID),l.xp6(1),l.Oqu(b.toString())}}let Mt=(()=>{class x{constructor(b,I,Z){this.fb=b,this.dialogRef=I,this.data=Z}onSubmit(){this.dialogRef.close(this.formGroup.value.actor)}ngOnInit(){this.formGroup=this.fb.group({actor:[null,U.kI.required]})}}return x.\u0275fac=function(b){return new(b||x)(l.Y36(U.qu),l.Y36(te.so),l.Y36(te.WI))},x.\u0275cmp=l.Xpm({type:x,selectors:[["vpms-delete-actor-dialog"]],decls:17,vars:15,consts:[["mat-dialog-title",""],[3,"formGroup","submit"],["appearance","fill"],["formControlName","actor"],[3,"value",4,"ngFor","ngForOf"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["mat-raised-button","","color","primary","type","button",2,"margin-top","1rem",3,"click"],[3,"value"]],template:function(b,I){1&b&&(l.TgZ(0,"h1",0),l._uU(1),l.ALo(2,"translate"),l.qZA(),l.TgZ(3,"mat-dialog-content",1),l.NdJ("submit",function(){return I.onSubmit()}),l.TgZ(4,"form")(5,"mat-form-field",2)(6,"mat-label"),l._uU(7),l.ALo(8,"translate"),l.qZA(),l.TgZ(9,"mat-select",3),l.YNc(10,re,2,2,"mat-option",4),l.qZA()(),l.TgZ(11,"button",5),l._uU(12),l.ALo(13,"translate"),l.qZA(),l.TgZ(14,"button",6),l.NdJ("click",function(){return I.dialogRef.close()}),l._uU(15),l.ALo(16,"translate"),l.qZA()()()),2&b&&(l.xp6(1),l.Oqu(l.lcZ(2,7,"delete_actor_dialog.title")),l.xp6(2),l.Q6J("formGroup",I.formGroup),l.xp6(4),l.Oqu(l.lcZ(8,9,"delete_actor_dialog.placeholder.actor")),l.xp6(3),l.Q6J("ngForOf",I.data.actors),l.xp6(1),l.Q6J("disabled",I.formGroup.invalid),l.xp6(1),l.hij(" ",l.lcZ(13,11,"delete_actor_dialog.submit")," "),l.xp6(3),l.hij(" ",l.lcZ(16,13,"field.close")," "))},directives:[te.uh,te.xY,U.JL,U.sg,U._Y,k.KE,k.hX,W.gD,U.JJ,U.u,ge.sg,ae.ey,$.lW],pipes:[N.X$],styles:["form[_ngcontent-%COMP%]{display:flex;flex-direction:column}"]}),x})();class Ve{constructor(F,b,I,Z,X){this.rotation=F,this.name=b,this._UUID=null!=Z?Z:(0,ze.k)(),this._lines=null!=X?X:[],this._actors=null!=I?I:[]}get UUID(){return this._UUID}get lines(){return this._lines}get actors(){return this._actors}static fromDto(F,b){const I="NULL"===F.r?void 0:new Ie(F.r),Z=F.l.map(ye=>xe.fromLineDto(ye,b)),X=F.a.map(ye=>Be.fromDto(ye,b));return new Ve(I,"NULL"===F.n?void 0:F.n,X,F.u,Z)}draw(){this._actors.forEach(F=>F.draw())}toDto(){var F,b,I;return{n:null!==(F=this.name)&&void 0!==F?F:"NULL",r:null!==(I=null===(b=this.rotation)||void 0===b?void 0:b.value)&&void 0!==I?I:"NULL",u:this.UUID,l:this._lines.map(Z=>Z.toDto()),a:this.actors.map(Z=>Z.toDto())}}toString(){return this.name?this.rotation?`${this.name} (${this.rotation.value})`:`${this.name}`:this.rotation?`Unknown rotation (${this.rotation.value})`:"Unknown rotation"}addLine(F){this._lines.push(F)}removeLine(F){const b=this._lines.findIndex(I=>I===F);b<0||this._lines.splice(b,1)}addActor(F){this._actors.push(F)}removeActor(F){const b=this._actors.findIndex(I=>I.UUID===F);b<0||this._actors.splice(b,1)}}function Ut(x,F){if(1&x&&(l.TgZ(0,"mat-option",7),l._uU(1),l.qZA()),2&x){const b=F.$implicit;l.Q6J("value",b.UUID),l.xp6(1),l.Oqu(b.toString())}}let Jn=(()=>{class x{constructor(b,I,Z){this.fb=b,this.dialogRef=I,this.data=Z}onSubmit(){this.dialogRef.close(this.formGroup.value.rotation)}ngOnInit(){this.formGroup=this.fb.group({rotation:[null,U.kI.required]})}}return x.\u0275fac=function(b){return new(b||x)(l.Y36(U.qu),l.Y36(te.so),l.Y36(te.WI))},x.\u0275cmp=l.Xpm({type:x,selectors:[["vpms-delete-rotation-dialog"]],decls:17,vars:15,consts:[["mat-dialog-title",""],[3,"formGroup","submit"],["appearance","fill"],["formControlName","rotation"],[3,"value",4,"ngFor","ngForOf"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["mat-raised-button","","color","primary","type","button",2,"margin-top","1rem",3,"click"],[3,"value"]],template:function(b,I){1&b&&(l.TgZ(0,"h1",0),l._uU(1),l.ALo(2,"translate"),l.qZA(),l.TgZ(3,"mat-dialog-content",1),l.NdJ("submit",function(){return I.onSubmit()}),l.TgZ(4,"form")(5,"mat-form-field",2)(6,"mat-label"),l._uU(7),l.ALo(8,"translate"),l.qZA(),l.TgZ(9,"mat-select",3),l.YNc(10,Ut,2,2,"mat-option",4),l.qZA()(),l.TgZ(11,"button",5),l._uU(12),l.ALo(13,"translate"),l.qZA(),l.TgZ(14,"button",6),l.NdJ("click",function(){return I.dialogRef.close()}),l._uU(15),l.ALo(16,"translate"),l.qZA()()()),2&b&&(l.xp6(1),l.Oqu(l.lcZ(2,7,"delete_rotation_dialog.title")),l.xp6(2),l.Q6J("formGroup",I.formGroup),l.xp6(4),l.Oqu(l.lcZ(8,9,"delete_rotation_dialog.placeholder.rotation")),l.xp6(3),l.Q6J("ngForOf",I.data.rotations),l.xp6(1),l.Q6J("disabled",I.formGroup.invalid),l.xp6(1),l.hij(" ",l.lcZ(13,11,"delete_rotation_dialog.submit")," "),l.xp6(3),l.hij(" ",l.lcZ(16,13,"field.close")," "))},directives:[te.uh,te.xY,U.JL,U.sg,U._Y,k.KE,k.hX,W.gD,U.JJ,U.u,ge.sg,ae.ey,$.lW],pipes:[N.X$],styles:["form[_ngcontent-%COMP%]{display:flex;flex-direction:column}"]}),x})(),Pt=(()=>{class x{constructor(){}}return x.\u0275fac=function(b){return new(b||x)},x.\u0275cmp=l.Xpm({type:x,selectors:[["vpms-current-position-form-field"]],inputs:{formGroup:"formGroup"},decls:21,vars:14,consts:[[3,"formGroup"],["appearance","fill"],["formControlName","current_rotation"],[3,"value"]],template:function(b,I){1&b&&(l.ynx(0,0),l.TgZ(1,"mat-form-field",1)(2,"mat-label"),l._uU(3),l.ALo(4,"translate"),l.qZA(),l.TgZ(5,"mat-select",2)(6,"mat-option",3),l._uU(7),l.ALo(8,"translate"),l.qZA(),l.TgZ(9,"mat-option",3),l._uU(10,"1"),l.qZA(),l.TgZ(11,"mat-option",3),l._uU(12,"2"),l.qZA(),l.TgZ(13,"mat-option",3),l._uU(14,"3"),l.qZA(),l.TgZ(15,"mat-option",3),l._uU(16,"4"),l.qZA(),l.TgZ(17,"mat-option",3),l._uU(18,"5"),l.qZA(),l.TgZ(19,"mat-option",3),l._uU(20,"6"),l.qZA()()(),l.BQk()),2&b&&(l.Q6J("formGroup",I.formGroup),l.xp6(3),l.Oqu(l.lcZ(4,10,"add_rotation_dialog.placeholder.current_rotation")),l.xp6(3),l.Q6J("value",null),l.xp6(1),l.Oqu(l.lcZ(8,12,"add_rotation_dialog.without_positions")),l.xp6(2),l.Q6J("value",1),l.xp6(2),l.Q6J("value",2),l.xp6(2),l.Q6J("value",3),l.xp6(2),l.Q6J("value",4),l.xp6(2),l.Q6J("value",5),l.xp6(2),l.Q6J("value",6))},directives:[U.JL,U.sg,k.KE,k.hX,W.gD,U.JJ,U.u,ae.ey],pipes:[N.X$],styles:["[_ngcontent-%COMP%]:root{--vpms-primary-palette-50: #DAE8F3;--vpms-primary-palette-100: #9DC1DF;--vpms-primary-palette-200: #80AED5;--vpms-primary-palette-300: #609ACA;--vpms-primary-palette-400: #2F7BBA;--vpms-primary-palette-500: #0A64AE;--vpms-primary-palette-600: #095A9D;--vpms-primary-palette-700: #063C68;--vpms-primary-palette-800: #042846;--vpms-primary-palette-900: #021423;--vpms-accent-palette-50: #FEF2F8;--vpms-accent-palette-100: #F8BFDF;--vpms-accent-palette-200: #F599CB;--vpms-accent-palette-300: #EF66B1;--vpms-accent-palette-400: #EA3397;--vpms-accent-palette-500: #E5007D;--vpms-accent-palette-600: #CE0071;--vpms-accent-palette-700: #AC005E;--vpms-accent-palette-800: #7E0045;--vpms-accent-palette-900: #50002C;--vpms-grayscale-0: #FFFFFF;--vpms-grayscale-50: #FAFAFA;--vpms-grayscale-100: #F2F2F2;--vpms-grayscale-200: #E6E6E6;--vpms-grayscale-250: #DADAD9;--vpms-grayscale-300: #CCCCCC;--vpms-grayscale-400: #B3B3B3;--vpms-grayscale-500: #999999;--vpms-grayscale-600: #808080;--vpms-grayscale-700: #666666;--vpms-grayscale-800: #4D4D4D;--vpms-grayscale-900: #333333;--vpms-grayscale-1000: #000000}mat-button-toggle-group[_ngcontent-%COMP%]{margin-bottom:.5rem}"]}),x})();var Vt=R(7446);function Xn(x,F){if(1&x&&(l.TgZ(0,"mat-option",11),l._uU(1),l.qZA()),2&x){const b=F.$implicit;l.Q6J("value",b.UUID),l.xp6(1),l.Oqu(b.toString())}}let ei=(()=>{class x{constructor(b,I,Z){this.fb=b,this.dialogRef=I,this.data=Z}onSubmit(){this.dialogRef.close({rotation:new Ve(this.formGroup.value.current_rotation?new Ie(this.formGroup.value.current_rotation):void 0,this.formGroup.value.rotation_name),add_before:this.formGroup.value.add_before,copy_actors:this.formGroup.value.copy_actors})}ngOnInit(){this.formGroup=this.fb.group({rotation_name:null,current_rotation:[1],add_before:null,copy_actors:[!0,U.kI.required]})}}return x.\u0275fac=function(b){return new(b||x)(l.Y36(U.qu),l.Y36(te.so),l.Y36(te.WI))},x.\u0275cmp=l.Xpm({type:x,selectors:[["vpms-add-rotation-dialog"]],decls:26,vars:22,consts:[["mat-dialog-title",""],[3,"formGroup","submit"],["appearance","fill","tabindex","-1"],["matInput","","formControlName","rotation_name"],[3,"formGroup"],["appearance","fill"],["formControlName","add_before"],[3,"value",4,"ngFor","ngForOf"],["formControlName","copy_actors"],["mat-raised-button","","color","primary","type","submit",2,"margin-top","1rem",3,"disabled"],["mat-raised-button","","color","primary","type","button",2,"margin-top","1rem",3,"click"],[3,"value"]],template:function(b,I){1&b&&(l.TgZ(0,"h1",0),l._uU(1),l.ALo(2,"translate"),l.qZA(),l.TgZ(3,"mat-dialog-content",1),l.NdJ("submit",function(){return I.onSubmit()}),l.TgZ(4,"form")(5,"mat-form-field",2)(6,"mat-label"),l._uU(7),l.ALo(8,"translate"),l.qZA(),l._UZ(9,"input",3),l.qZA(),l._UZ(10,"vpms-current-position-form-field",4),l.TgZ(11,"mat-form-field",5)(12,"mat-label"),l._uU(13),l.ALo(14,"translate"),l.qZA(),l.TgZ(15,"mat-select",6),l.YNc(16,Xn,2,2,"mat-option",7),l.qZA()(),l.TgZ(17,"mat-checkbox",8),l._uU(18),l.ALo(19,"translate"),l.qZA(),l.TgZ(20,"button",9),l._uU(21),l.ALo(22,"translate"),l.qZA(),l.TgZ(23,"button",10),l.NdJ("click",function(){return I.dialogRef.close()}),l._uU(24),l.ALo(25,"translate"),l.qZA()()()),2&b&&(l.xp6(1),l.Oqu(l.lcZ(2,10,"add_rotation_dialog.title")),l.xp6(2),l.Q6J("formGroup",I.formGroup),l.xp6(4),l.Oqu(l.lcZ(8,12,"add_rotation_dialog.placeholder.rotation_name")),l.xp6(3),l.Q6J("formGroup",I.formGroup),l.xp6(3),l.Oqu(l.lcZ(14,14,"add_rotation_dialog.placeholder.add_before")),l.xp6(3),l.Q6J("ngForOf",I.data.rotations),l.xp6(2),l.hij(" ",l.lcZ(19,16,"add_rotation_dialog.placeholder.copy_actors")," "),l.xp6(2),l.Q6J("disabled",I.formGroup.invalid),l.xp6(1),l.hij(" ",l.lcZ(22,18,"add_rotation_dialog.submit")," "),l.xp6(3),l.hij(" ",l.lcZ(25,20,"field.close")," "))},directives:[te.uh,te.xY,U.JL,U.sg,U._Y,k.KE,k.hX,P.Nt,U.Fj,U.JJ,U.u,Pt,W.gD,ge.sg,ae.ey,Vt.oG,$.lW],pipes:[N.X$],styles:["form[_ngcontent-%COMP%]{display:flex;flex-direction:column}"]}),x})();class We{static store(F,b){const I=JSON.stringify(b);window.localStorage.setItem(F,I)}static retrieve(F){const b=window.localStorage.getItem(F);if(b)return JSON.parse(b)}static remove(F){window.localStorage.removeItem(F)}}var Lt=R(8996),Ze=R(7102);let xt=(()=>{class x{constructor(b,I,Z,X){this.fb=b,this.dialogRef=I,this.data=Z,this.store=X}onSubmit(){this.dialogRef.close(),window.navigator.clipboard.writeText(this.formGroup.value.copy_link)}ngOnInit(){this.formGroup=this.fb.group({copy_link:[{value:null,disabled:!1},U.kI.required]});const b=(0,ze.k)(30),I=this.store.collection("rotations");(0,Lt.D)(I.doc(b).set({version:this.data.version,rotations:this.data.rotations.map(Z=>Z.toDto()),current_rotation:this.data.current_rotation})).subscribe(()=>{this.formGroup.patchValue({copy_link:`${window.location.href}?store=${b}`})})}}return x.\u0275fac=function(b){return new(b||x)(l.Y36(U.qu),l.Y36(te.so),l.Y36(te.WI),l.Y36(Ze.ST))},x.\u0275cmp=l.Xpm({type:x,selectors:[["vpms-export-actor-dialog"]],decls:16,vars:14,consts:[["mat-dialog-title",""],[3,"formGroup","submit"],["appearance","fill","tabindex","-1"],["matInput","","formControlName","copy_link"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["mat-raised-button","","color","primary","type","button",2,"margin-top","1rem",3,"click"]],template:function(b,I){1&b&&(l.TgZ(0,"h1",0),l._uU(1),l.ALo(2,"translate"),l.qZA(),l.TgZ(3,"mat-dialog-content",1),l.NdJ("submit",function(){return I.onSubmit()}),l.TgZ(4,"form")(5,"mat-form-field",2)(6,"mat-label"),l._uU(7),l.ALo(8,"translate"),l.qZA(),l._UZ(9,"input",3),l.qZA(),l.TgZ(10,"button",4),l._uU(11),l.ALo(12,"translate"),l.qZA(),l.TgZ(13,"button",5),l.NdJ("click",function(){return I.dialogRef.close()}),l._uU(14),l.ALo(15,"translate"),l.qZA()()()),2&b&&(l.xp6(1),l.Oqu(l.lcZ(2,6,"export_dialog.title")),l.xp6(2),l.Q6J("formGroup",I.formGroup),l.xp6(4),l.Oqu(l.lcZ(8,8,"export_dialog.placeholder.copy_link")),l.xp6(3),l.Q6J("disabled",I.formGroup.invalid),l.xp6(1),l.hij(" ",l.lcZ(12,10,"export_dialog.submit")," "),l.xp6(3),l.hij(" ",l.lcZ(15,12,"field.close")," "))},directives:[te.uh,te.xY,U.JL,U.sg,U._Y,k.KE,k.hX,P.Nt,U.Fj,U.JJ,U.u,$.lW],pipes:[N.X$],styles:["form[_ngcontent-%COMP%]{display:flex;flex-direction:column}"]}),x})(),On=(()=>{class x{constructor(b,I){this.fb=b,this.dialogRef=I}onSubmit(){const b=this.formGroup.value.link.split("?store=");b.length<2||this.dialogRef.close(b[b.length-1])}ngOnInit(){this.formGroup=this.fb.group({link:[null,U.kI.required]})}}return x.\u0275fac=function(b){return new(b||x)(l.Y36(U.qu),l.Y36(te.so))},x.\u0275cmp=l.Xpm({type:x,selectors:[["vpms-import-actor-dialog"]],decls:16,vars:14,consts:[["mat-dialog-title",""],[3,"formGroup","submit"],["appearance","fill","tabindex","-1"],["matInput","","formControlName","link"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["mat-raised-button","","color","primary","type","button",2,"margin-top","1rem",3,"click"]],template:function(b,I){1&b&&(l.TgZ(0,"h1",0),l._uU(1),l.ALo(2,"translate"),l.qZA(),l.TgZ(3,"mat-dialog-content",1),l.NdJ("submit",function(){return I.onSubmit()}),l.TgZ(4,"form")(5,"mat-form-field",2)(6,"mat-label"),l._uU(7),l.ALo(8,"translate"),l.qZA(),l._UZ(9,"input",3),l.qZA(),l.TgZ(10,"button",4),l._uU(11),l.ALo(12,"translate"),l.qZA(),l.TgZ(13,"button",5),l.NdJ("click",function(){return I.dialogRef.close()}),l._uU(14),l.ALo(15,"translate"),l.qZA()()()),2&b&&(l.xp6(1),l.Oqu(l.lcZ(2,6,"import_dialog.title")),l.xp6(2),l.Q6J("formGroup",I.formGroup),l.xp6(4),l.Oqu(l.lcZ(8,8,"import_dialog.placeholder.link")),l.xp6(3),l.Q6J("disabled",I.formGroup.invalid),l.xp6(1),l.hij(" ",l.lcZ(12,10,"import_dialog.submit")," "),l.xp6(3),l.hij(" ",l.lcZ(15,12,"field.close")," "))},directives:[te.uh,te.xY,U.JL,U.sg,U._Y,k.KE,k.hX,P.Nt,U.Fj,U.JJ,U.u,$.lW],pipes:[N.X$],styles:["form[_ngcontent-%COMP%]{display:flex;flex-direction:column}"]}),x})();var dt=R(5216);class j{static isMobileDevice(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile/i.test(navigator.userAgent)||window.matchMedia("(max-width: 600px)").matches}static isIosDevice(){return/iPhone|iPad|iPod/i.test(navigator.userAgent)&&"ontouchstart"in window}}let J=(()=>{class x{constructor(b){this.dialogRef=b}}return x.\u0275fac=function(b){return new(b||x)(l.Y36(te.so))},x.\u0275cmp=l.Xpm({type:x,selectors:[["vpms-reset-all-dialog"]],decls:10,vars:9,consts:[["mat-dialog-title",""],["mat-raised-button","","color","primary","type","button",3,"click"],["mat-raised-button","","color","primary","type","button",2,"margin-top","1rem",3,"click"]],template:function(b,I){1&b&&(l.TgZ(0,"h1",0),l._uU(1),l.ALo(2,"translate"),l.qZA(),l.TgZ(3,"mat-dialog-content")(4,"button",1),l.NdJ("click",function(){return I.dialogRef.close(!1)}),l._uU(5),l.ALo(6,"translate"),l.qZA(),l.TgZ(7,"button",2),l.NdJ("click",function(){return I.dialogRef.close(!0)}),l._uU(8),l.ALo(9,"translate"),l.qZA()()),2&b&&(l.xp6(1),l.Oqu(l.lcZ(2,3,"reset_all.title")),l.xp6(4),l.hij(" ",l.lcZ(6,5,"field.abort")," "),l.xp6(3),l.hij(" ",l.lcZ(9,7,"reset_all.submit")," "))},directives:[te.uh,te.xY,$.lW],pipes:[N.X$],styles:["mat-dialog-content[_ngcontent-%COMP%]{display:flex;flex-direction:column}"]}),x})();function D(x,F){if(1&x&&(l.TgZ(0,"mat-option",10),l._uU(1),l.qZA()),2&x){const b=F.$implicit;l.Q6J("value",b.UUID),l.xp6(1),l.Oqu(b.toString())}}let S=(()=>{class x{constructor(b,I,Z){this.fb=b,this.dialogRef=I,this.data=Z}onSubmit(){this.dialogRef.close(this.formGroup.value)}ngOnInit(){this.formGroup=this.fb.group({actor:[null,U.kI.required],player_name:[{value:null,disabled:!0}],position:[{value:null,disabled:!0},U.kI.required],player_role:[{value:null,disabled:!0},U.kI.required]}),this.formGroup.controls.actor.valueChanges.subscribe(b=>{const I=this.data.actors.find(Z=>Z.UUID===b);this.formGroup.patchValue({player_name:I.player_name,position:I.position.value,player_role:I.player_role}),this.formGroup.controls.player_name.enable(),this.formGroup.controls.position.enable(),this.formGroup.controls.player_role.enable(),this.formGroup.updateValueAndValidity()})}}return x.\u0275fac=function(b){return new(b||x)(l.Y36(U.qu),l.Y36(te.so),l.Y36(te.WI))},x.\u0275cmp=l.Xpm({type:x,selectors:[["vpms-edit-actor-dialog"]],decls:24,vars:20,consts:[["mat-dialog-title",""],[3,"formGroup","submit"],["appearance","fill"],["formControlName","actor"],[3,"value",4,"ngFor","ngForOf"],["appearance","fill","tabindex","-1"],["matInput","","formControlName","player_name"],[3,"formGroup"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["mat-raised-button","","color","primary","type","button",2,"margin-top","1rem",3,"click"],[3,"value"]],template:function(b,I){1&b&&(l.TgZ(0,"h1",0),l._uU(1),l.ALo(2,"translate"),l.qZA(),l.TgZ(3,"mat-dialog-content",1),l.NdJ("submit",function(){return I.onSubmit()}),l.TgZ(4,"form")(5,"mat-form-field",2)(6,"mat-label"),l._uU(7),l.ALo(8,"translate"),l.qZA(),l.TgZ(9,"mat-select",3),l.YNc(10,D,2,2,"mat-option",4),l.qZA()(),l.TgZ(11,"mat-form-field",5)(12,"mat-label"),l._uU(13),l.ALo(14,"translate"),l.qZA(),l._UZ(15,"input",6),l.qZA(),l._UZ(16,"vpms-position-form-field",7)(17,"vpms-player-role-form-field",7),l.TgZ(18,"button",8),l._uU(19),l.ALo(20,"translate"),l.qZA(),l.TgZ(21,"button",9),l.NdJ("click",function(){return I.dialogRef.close()}),l._uU(22),l.ALo(23,"translate"),l.qZA()()()),2&b&&(l.xp6(1),l.Oqu(l.lcZ(2,10,"edit_actor_dialog.title")),l.xp6(2),l.Q6J("formGroup",I.formGroup),l.xp6(4),l.Oqu(l.lcZ(8,12,"edit_actor_dialog.placeholder.actor")),l.xp6(3),l.Q6J("ngForOf",I.data.actors),l.xp6(3),l.Oqu(l.lcZ(14,14,"add_actor_dialog.placeholder.player_name")),l.xp6(3),l.Q6J("formGroup",I.formGroup),l.xp6(1),l.Q6J("formGroup",I.formGroup),l.xp6(1),l.Q6J("disabled",I.formGroup.invalid),l.xp6(1),l.hij(" ",l.lcZ(20,16,"edit_actor_dialog.submit")," "),l.xp6(3),l.hij(" ",l.lcZ(23,18,"field.close")," "))},directives:[te.uh,te.xY,U.JL,U.sg,U._Y,k.KE,k.hX,W.gD,U.JJ,U.u,ge.sg,ae.ey,P.Nt,U.Fj,Q,qe,$.lW],pipes:[N.X$],styles:["form[_ngcontent-%COMP%]{display:flex;flex-direction:column}"]}),x})();function z(x,F){if(1&x&&(l.TgZ(0,"mat-option",12),l._uU(1),l.qZA()),2&x){const b=F.$implicit;l.Q6J("value",b.UUID),l.xp6(1),l.Oqu(b.toString())}}function E(x,F){if(1&x&&(l.TgZ(0,"mat-option",12),l._uU(1),l.qZA()),2&x){const b=l.oxw().$implicit;l.Q6J("value",b.UUID),l.xp6(1),l.Oqu(b.toString())}}function V(x,F){if(1&x&&(l.ynx(0),l.YNc(1,E,2,2,"mat-option",13),l.BQk()),2&x){const b=F.$implicit,I=l.oxw();l.xp6(1),l.Q6J("ngIf",b.UUID!==I.currentRotation)}}let ue=(()=>{class x{constructor(b,I,Z){this.fb=b,this.dialogRef=I,this.data=Z}onSubmit(){this.dialogRef.close(this.formGroup.value)}ngOnInit(){this.formGroup=this.fb.group({rotation:[null,U.kI.required],rotation_name:[{value:null,disabled:!0}],current_rotation:[{value:null,disabled:!0}],set_before:[{value:null,disabled:!0}]}),this.formGroup.controls.rotation.valueChanges.subscribe(b=>{var I;const Z=this.data.rotations.find(X=>X.UUID===b);this.currentRotation=b,this.formGroup.patchValue({rotation_name:Z.name,current_rotation:null===(I=Z.rotation)||void 0===I?void 0:I.value}),this.formGroup.controls.rotation_name.enable(),this.formGroup.controls.current_rotation.enable(),this.formGroup.controls.set_before.enable(),this.formGroup.updateValueAndValidity()})}}return x.\u0275fac=function(b){return new(b||x)(l.Y36(U.qu),l.Y36(te.so),l.Y36(te.WI))},x.\u0275cmp=l.Xpm({type:x,selectors:[["vpms-edit-rotation-dialog"]],decls:29,vars:23,consts:[["mat-dialog-title",""],[3,"formGroup","submit"],["appearance","fill"],["formControlName","rotation"],[3,"value",4,"ngFor","ngForOf"],["appearance","fill","tabindex","-1"],["matInput","","formControlName","rotation_name"],[3,"formGroup"],["formControlName","set_before"],[4,"ngFor","ngForOf"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["mat-raised-button","","color","primary","type","button",2,"margin-top","1rem",3,"click"],[3,"value"],[3,"value",4,"ngIf"]],template:function(b,I){1&b&&(l.TgZ(0,"h1",0),l._uU(1),l.ALo(2,"translate"),l.qZA(),l.TgZ(3,"mat-dialog-content",1),l.NdJ("submit",function(){return I.onSubmit()}),l.TgZ(4,"form")(5,"mat-form-field",2)(6,"mat-label"),l._uU(7),l.ALo(8,"translate"),l.qZA(),l.TgZ(9,"mat-select",3),l.YNc(10,z,2,2,"mat-option",4),l.qZA()(),l.TgZ(11,"mat-form-field",5)(12,"mat-label"),l._uU(13),l.ALo(14,"translate"),l.qZA(),l._UZ(15,"input",6),l.qZA(),l._UZ(16,"vpms-current-position-form-field",7),l.TgZ(17,"mat-form-field",2)(18,"mat-label"),l._uU(19),l.ALo(20,"translate"),l.qZA(),l.TgZ(21,"mat-select",8),l.YNc(22,V,2,1,"ng-container",9),l.qZA()(),l.TgZ(23,"button",10),l._uU(24),l.ALo(25,"translate"),l.qZA(),l.TgZ(26,"button",11),l.NdJ("click",function(){return I.dialogRef.close()}),l._uU(27),l.ALo(28,"translate"),l.qZA()()()),2&b&&(l.xp6(1),l.Oqu(l.lcZ(2,11,"edit_rotation_dialog.title")),l.xp6(2),l.Q6J("formGroup",I.formGroup),l.xp6(4),l.Oqu(l.lcZ(8,13,"edit_rotation_dialog.placeholder.rotation")),l.xp6(3),l.Q6J("ngForOf",I.data.rotations),l.xp6(3),l.Oqu(l.lcZ(14,15,"add_rotation_dialog.placeholder.rotation_name")),l.xp6(3),l.Q6J("formGroup",I.formGroup),l.xp6(3),l.Oqu(l.lcZ(20,17,"edit_rotation_dialog.placeholder.set_before")),l.xp6(3),l.Q6J("ngForOf",I.data.rotations),l.xp6(1),l.Q6J("disabled",I.formGroup.invalid),l.xp6(1),l.hij(" ",l.lcZ(25,19,"edit_rotation_dialog.submit")," "),l.xp6(3),l.hij(" ",l.lcZ(28,21,"field.close")," "))},directives:[te.uh,te.xY,U.JL,U.sg,U._Y,k.KE,k.hX,W.gD,U.JJ,U.u,ge.sg,ae.ey,P.Nt,U.Fj,Pt,ge.O5,$.lW],pipes:[N.X$],styles:["form[_ngcontent-%COMP%]{display:flex;flex-direction:column}"]}),x})();var be=R(2638),$e=R(5245),Bt=R(9832),sn=R(5619);const on=["court"];function Le(x,F){if(1&x&&(l.TgZ(0,"mat-option",19),l._uU(1),l.qZA()),2&x){const b=F.$implicit;l.Q6J("value",b.UUID),l.xp6(1),l.Oqu(b.toString())}}const En=[{path:"",component:(()=>{class x{constructor(b,I,Z,X){this.formBuilder=b,this.matDialog=I,this.store=Z,this.router=X,this.rotations=[],this.currentRotationIndex=0,this.DrawColor=me.D,this.currentDrawColor=me.D.Black,this.CourtMode=dt.T,this.courtMode=dt.T.MOVE_ACTOR,this.ready=!1,this.__actorShapes=[],this.__lineShapes=[],this.formGroup=this.formBuilder.group({current_rotation:[null,U.kI.required]})}get rotation(){return this.rotations[this.currentRotationIndex]}get actorShapes(){var b,I;return null!==(I=null===(b=this.rotation)||void 0===b?void 0:b.actors.map(Z=>Z.shape))&&void 0!==I?I:[]}get lineShapes(){var b,I;return null!==(I=null===(b=this.rotation)||void 0===b?void 0:b.lines)&&void 0!==I?I:[]}onCourtReady(b){this.context=b;const I=new URLSearchParams(window.location.search);if(I&&I.get("store")&&30===I.get("store").length)this.importLink(I.get("store")),this.router.navigate(["/field"]);else{const Z=We.retrieve(x.LOCAL_STORAGE_KEY_ROTATIONS),X=We.retrieve(x.LOCAL_STORAGE_KEY_CURRENT_ROTATION);Z&&X?(this.rotations=Z.map(ye=>Ve.fromDto(ye,this.context)),this.currentRotationIndex=this.rotations.findIndex(ye=>ye.UUID===X)):this.rotations=[new Ve(new Ie(1),"Default rotation")],this.setShapes(),this.formGroup.patchValue({current_rotation:this.rotation.UUID})}this.formGroup.valueChanges.subscribe(Z=>this.onRotationChanged(Z.current_rotation)),this.ready=!0}onRotationChanged(b){this.currentRotationIndex=this.rotations.findIndex(I=>I.UUID===b),this.setShapes(),this.court.render()}onAddActorClicked(){this.matDialog.open(T,{autoFocus:!1,panelClass:j.isMobileDevice()?"full-screen-dialog":void 0}).afterClosed().subscribe(I=>{!I||(this.setActorShape(I,I.player_role),this.rotation.addActor(I),this.court.render())})}setActorShape(b,I){switch(I){case ve.Setter:this.setShape(b,new Se(b,this.context));break;case ve.MiddleBlocker:this.setShape(b,new Ee(b,this.context,!1));break;case ve.Libero:this.setShape(b,new Ee(b,this.context,!0));break;case ve.DefensiveSpecialist:this.setShape(b,new oe(b,this.context));break;case ve.OutsideHitter:this.setShape(b,new he(b,this.context,!1));break;case ve.OppositeHitter:this.setShape(b,new he(b,this.context,!0))}this.setShapes()}onEditActorClicked(){this.matDialog.open(S,{data:{actors:this.rotation.actors},autoFocus:!1,panelClass:j.isMobileDevice()?"full-screen-dialog":void 0}).afterClosed().subscribe(I=>{if(!I)return;const Z=this.rotation.actors.find(ye=>ye.UUID===I.actor);Z.player_name=I.player_name,Z.player_role=I.player_role,Z.position=new Ie(I.position);const X=Z.shape.getFieldPosition();this.setActorShape(Z,Z.player_role),Z.shape.setFieldPosition(X),this.court.render()})}setShape(b,I){I.setRotationProperties(this.rotation.rotation),b.setShape(I)}onDeleteActorClicked(){this.matDialog.open(Mt,{data:{actors:this.rotation.actors},autoFocus:!1,panelClass:j.isMobileDevice()?"full-screen-dialog":void 0}).afterClosed().subscribe(I=>{!I||(this.rotation.removeActor(I),this.setShapes(),this.court.render())})}onResetAllClicked(){this.matDialog.open(J,{autoFocus:!1,panelClass:j.isMobileDevice()?"full-screen-dialog":void 0}).afterClosed().subscribe(I=>{!I||(this.rotations=[new Ve(new Ie(1),"Default rotation")],this.currentRotationIndex=0,this.formGroup.patchValue({current_rotation:this.rotation.UUID}),this.setShapes())})}onDeleteRotationClicked(){this.matDialog.open(Jn,{data:{rotations:this.rotations},autoFocus:!1,panelClass:j.isMobileDevice()?"full-screen-dialog":void 0}).afterClosed().subscribe(I=>{if(!I)return;const Z=this.rotation.UUID,X=this.rotations.findIndex(ye=>ye.UUID===I);this.rotations.splice(X,1),Z===I?(0===this.rotations.length&&this.rotations.push(new Ve(new Ie(1),"Default rotation")),this.currentRotationIndex=0):this.currentRotationIndex=this.rotations.findIndex(ye=>ye.UUID===Z),this.formGroup.patchValue({current_rotation:this.rotation.UUID}),this.setShapes(),this.court.render()})}onAddRotationClicked(){this.matDialog.open(ei,{autoFocus:!1,data:{rotations:this.rotations},panelClass:j.isMobileDevice()?"full-screen-dialog":void 0}).afterClosed().subscribe(I=>{if(!I)return;const Z=this.rotation.actors;if(I.add_before){const X=this.rotations.findIndex(ye=>ye.UUID===I.add_before);this.rotations.splice(X,0,I.rotation),this.currentRotationIndex=X}else this.rotations.push(I.rotation),this.currentRotationIndex=this.rotations.length-1;I.copy_actors&&Z.forEach(X=>{const ye=X.copy();ye.shape.setRotationProperties(this.rotation.rotation),this.rotation.addActor(ye)}),this.formGroup.patchValue({current_rotation:I.rotation.UUID}),this.setShapes(),this.court.render()})}onEditRotationClicked(){this.matDialog.open(ue,{data:{rotations:this.rotations},autoFocus:!1,panelClass:j.isMobileDevice()?"full-screen-dialog":void 0}).afterClosed().subscribe(I=>{if(!I)return;const Z=this.rotations.find(X=>X.UUID===I.rotation);if(Z.name=I.rotation_name,Z.rotation=I.current_rotation?new Ie(I.current_rotation):void 0,Z.actors.forEach(X=>X.shape.setRotationProperties(Z.rotation)),I.set_before){const X=this.rotations.findIndex(zt=>zt.UUID===I.rotation),ye=this.rotations.findIndex(zt=>zt.UUID===I.set_before);this.rotations.splice(X,1),this.rotations.splice(X<ye?ye-1:ye,0,Z),X===this.currentRotationIndex&&(this.currentRotationIndex=this.rotations.findIndex(zt=>zt.UUID===I.rotation))}this.setShapes(),this.court.render()})}onExportClicked(){this.matDialog.open(xt,{autoFocus:!1,data:{version:x.VERSION,rotations:this.rotations,current_rotation:this.rotation.UUID},panelClass:j.isMobileDevice()?"full-screen-dialog":void 0})}onImportClicked(){this.matDialog.open(On,{autoFocus:!1,panelClass:j.isMobileDevice()?"full-screen-dialog":void 0}).afterClosed().subscribe(I=>this.importLink(I))}importLink(b){b&&30===b.length&&this.store.collection("rotations").doc(b).get().subscribe(Z=>{const X=Z.data();this.rotations=X.rotations.map(zt=>Ve.fromDto(zt,this.context));const ye=X.current_rotation;this.currentRotationIndex=this.rotations.findIndex(zt=>zt.UUID===ye),this.formGroup.patchValue({current_rotation:this.rotation.UUID}),this.setShapes(),this.court.render()})}setMoveActorMode(){this.courtMode=dt.T.MOVE_ACTOR}onToggleDrawMode(){this.courtMode=this.courtMode===dt.T.DRAW_LINE?dt.T.MOVE_ACTOR:dt.T.DRAW_LINE}onToggleEraseMode(){this.courtMode=this.courtMode===dt.T.ERASE_LINE?dt.T.MOVE_ACTOR:dt.T.ERASE_LINE}onCourtRender(){!this.ready||(We.store(x.LOCAL_STORAGE_KEY_ROTATIONS,this.rotations.map(b=>b.toDto())),We.store(x.LOCAL_STORAGE_KEY_CURRENT_ROTATION,this.rotation.UUID),We.store(x.LOCAL_STORAGE_KEY_VERSION,x.VERSION))}onLineAdded(b){this.rotation.addLine(b),this.setShapes()}onLineErased(b){this.rotation.removeLine(b),this.setShapes()}onDrawColorChanged(b){void 0!==b&&(this.currentDrawColor=b)}setShapes(){this.__actorShapes=this.actorShapes,this.__lineShapes=this.lineShapes}}return x.VERSION=2,x.LOCAL_STORAGE_KEY_ROTATIONS="rotations_storage_v2",x.LOCAL_STORAGE_KEY_CURRENT_ROTATION="current_rotation_uuid_v2",x.LOCAL_STORAGE_KEY_VERSION="version",x.\u0275fac=function(b){return new(b||x)(l.Y36(U.qu),l.Y36(te.uw),l.Y36(Ze.ST),l.Y36(g.F0))},x.\u0275cmp=l.Xpm({type:x,selectors:[["vpms-field"]],viewQuery:function(b,I){if(1&b&&l.Gf(on,5),2&b){let Z;l.iGM(Z=l.CRH())&&(I.court=Z.first)}},decls:102,vars:73,consts:[["mode","over"],["sidenav",""],[3,"formGroup"],["formControlName","current_rotation"],[3,"value",4,"ngFor","ngForOf"],["mat-stroked-button","",3,"click"],[2,"margin-bottom","0.5rem",3,"valueChange"],[2,"background","black","width","100%","height","100%",3,"value"],[2,"background","red","width","100%","height","100%",3,"value"],[2,"background","green","width","100%","height","100%",3,"value"],[2,"background","blue","width","100%","height","100%",3,"value"],[2,"background","white","width","100%","height","100%",3,"value"],[2,"margin-top","auto"],["mat-stroked-button","","routerLink","/statistics"],["href","https://github.com/Geigerkind/vb_positions","target","_blank"],["mat-stroked-button",""],["mat-flat-button","",1,"toggle_sidenav",3,"click"],[3,"actors","lines","courtMode","drawColor","onReady","onRender","onLineAdded","onLineErased"],["court",""],[3,"value"]],template:function(b,I){if(1&b){const Z=l.EpF();l.TgZ(0,"mat-sidenav-container")(1,"mat-sidenav",0,1)(3,"h1"),l._uU(4),l.ALo(5,"translate"),l.qZA(),l.TgZ(6,"mat-form-field",2)(7,"mat-select",3),l.YNc(8,Le,2,2,"mat-option",4),l.qZA()(),l.TgZ(9,"button",5),l.NdJ("click",function(){return I.onAddRotationClicked()}),l.TgZ(10,"mat-icon"),l._uU(11,"add"),l.qZA(),l._uU(12),l.ALo(13,"translate"),l.qZA(),l.TgZ(14,"button",5),l.NdJ("click",function(){return I.onEditRotationClicked()}),l.TgZ(15,"mat-icon"),l._uU(16,"edit"),l.qZA(),l._uU(17),l.ALo(18,"translate"),l.qZA(),l.TgZ(19,"button",5),l.NdJ("click",function(){return I.onDeleteRotationClicked()}),l.TgZ(20,"mat-icon"),l._uU(21,"delete"),l.qZA(),l._uU(22),l.ALo(23,"translate"),l.qZA(),l.TgZ(24,"button",5),l.NdJ("click",function(){return I.onResetAllClicked()}),l.TgZ(25,"mat-icon"),l._uU(26,"delete"),l.qZA(),l._uU(27),l.ALo(28,"translate"),l.qZA(),l.TgZ(29,"h1"),l._uU(30),l.ALo(31,"translate"),l.qZA(),l.TgZ(32,"button",5),l.NdJ("click",function(){return I.onAddActorClicked()}),l.TgZ(33,"mat-icon"),l._uU(34,"add"),l.qZA(),l._uU(35),l.ALo(36,"translate"),l.qZA(),l.TgZ(37,"button",5),l.NdJ("click",function(){return I.onEditActorClicked()}),l.TgZ(38,"mat-icon"),l._uU(39,"edit"),l.qZA(),l._uU(40),l.ALo(41,"translate"),l.qZA(),l.TgZ(42,"button",5),l.NdJ("click",function(){return I.onDeleteActorClicked()}),l.TgZ(43,"mat-icon"),l._uU(44,"delete"),l.qZA(),l._uU(45),l.ALo(46,"translate"),l.qZA(),l.TgZ(47,"h1"),l._uU(48),l.ALo(49,"translate"),l.qZA(),l.TgZ(50,"button",5),l.NdJ("click",function(){return I.setMoveActorMode()}),l.TgZ(51,"mat-icon"),l._uU(52,"person"),l.qZA(),l._uU(53),l.ALo(54,"translate"),l.qZA(),l.TgZ(55,"button",5),l.NdJ("click",function(){return I.onToggleDrawMode()}),l.TgZ(56,"mat-icon"),l._uU(57,"mode_edit_outline"),l.qZA(),l._uU(58),l.ALo(59,"translate"),l.qZA(),l.TgZ(60,"mat-button-toggle-group",6),l.NdJ("valueChange",function(ye){return I.onDrawColorChanged(ye)}),l._UZ(61,"mat-button-toggle",7)(62,"mat-button-toggle",8)(63,"mat-button-toggle",9)(64,"mat-button-toggle",10)(65,"mat-button-toggle",11),l.qZA(),l.TgZ(66,"button",5),l.NdJ("click",function(){return I.onToggleEraseMode()}),l.TgZ(67,"mat-icon"),l._uU(68,"auto_fix_normal"),l.qZA(),l._uU(69),l.ALo(70,"translate"),l.qZA(),l.TgZ(71,"h1"),l._uU(72),l.ALo(73,"translate"),l.qZA(),l.TgZ(74,"button",5),l.NdJ("click",function(){return I.onExportClicked()}),l.TgZ(75,"mat-icon"),l._uU(76,"share"),l.qZA(),l._uU(77),l.ALo(78,"translate"),l.qZA(),l.TgZ(79,"button",5),l.NdJ("click",function(){return I.onImportClicked()}),l.TgZ(80,"mat-icon"),l._uU(81,"import_export"),l.qZA(),l._uU(82),l.ALo(83,"translate"),l.qZA(),l.TgZ(84,"div",12)(85,"button",13)(86,"mat-icon"),l._uU(87,"bar_chart"),l.qZA(),l._uU(88),l.ALo(89,"translate"),l.qZA(),l.TgZ(90,"a",14)(91,"button",15)(92,"mat-icon"),l._uU(93,"code"),l.qZA(),l._uU(94),l.ALo(95,"translate"),l.qZA()()()(),l.TgZ(96,"mat-sidenav-content")(97,"button",16),l.NdJ("click",function(){return l.CHM(Z),l.MAs(2).toggle()}),l.TgZ(98,"mat-icon"),l._uU(99,"arrow_right"),l.qZA()(),l.TgZ(100,"vpms-court",17,18),l.NdJ("onReady",function(ye){return I.onCourtReady(ye)})("onRender",function(){return I.onCourtRender()})("onLineAdded",function(ye){return I.onLineAdded(ye)})("onLineErased",function(ye){return I.onLineErased(ye)}),l.qZA()()()}if(2&b){const Z=l.MAs(2);l.xp6(4),l.Oqu(l.lcZ(5,37,"field.subtitle.rotation")),l.xp6(2),l.Q6J("formGroup",I.formGroup),l.xp6(2),l.Q6J("ngForOf",I.rotations),l.xp6(4),l.hij(" ",l.lcZ(13,39,"field.add_rotation")," "),l.xp6(5),l.hij(" ",l.lcZ(18,41,"field.edit_rotation")," "),l.xp6(5),l.hij(" ",l.lcZ(23,43,"field.delete_rotation")," "),l.xp6(5),l.hij(" ",l.lcZ(28,45,"field.reset_all")," "),l.xp6(3),l.Oqu(l.lcZ(31,47,"field.subtitle.actor")),l.xp6(5),l.hij(" ",l.lcZ(36,49,"field.add_actor")," "),l.xp6(5),l.hij(" ",l.lcZ(41,51,"field.edit_actor")," "),l.xp6(5),l.hij(" ",l.lcZ(46,53,"field.delete_actor")," "),l.xp6(3),l.Oqu(l.lcZ(49,55,"field.subtitle.mode")),l.xp6(2),l.ekj("toggled",I.courtMode===I.CourtMode.MOVE_ACTOR),l.xp6(3),l.hij(" ",l.lcZ(54,57,"field.actor_mode")," "),l.xp6(2),l.ekj("toggled",I.courtMode===I.CourtMode.DRAW_LINE),l.xp6(3),l.hij(" ",l.lcZ(59,59,"field.draw_mode")," "),l.xp6(3),l.Q6J("value",I.DrawColor.Black),l.xp6(1),l.Q6J("value",I.DrawColor.Red),l.xp6(1),l.Q6J("value",I.DrawColor.Green),l.xp6(1),l.Q6J("value",I.DrawColor.Blue),l.xp6(1),l.Q6J("value",I.DrawColor.White),l.xp6(1),l.ekj("toggled",I.courtMode===I.CourtMode.ERASE_LINE),l.xp6(3),l.hij(" ",l.lcZ(70,61,"field.erase_mode")," "),l.xp6(3),l.Oqu(l.lcZ(73,63,"field.subtitle.share")),l.xp6(5),l.hij(" ",l.lcZ(78,65,"field.export")," "),l.xp6(5),l.hij(" ",l.lcZ(83,67,"field.import")," "),l.xp6(6),l.hij(" ",l.lcZ(89,69,"home.statistics")," "),l.xp6(6),l.hij(" ",l.lcZ(95,71,"field.source_code")," "),l.xp6(3),l.ekj("is_opened",Z.opened),l.xp6(3),l.Q6J("actors",I.__actorShapes)("lines",I.__lineShapes)("courtMode",I.courtMode)("drawColor",I.currentDrawColor)}},directives:[be.TM,be.JX,k.KE,U.JL,U.sg,W.gD,U.JJ,U.u,ge.sg,ae.ey,$.lW,$e.Hw,Bt.A9,Bt.Yi,g.rH,be.Rh,sn.v],pipes:[N.X$],styles:["[_ngcontent-%COMP%]:root{--vpms-primary-palette-50: #DAE8F3;--vpms-primary-palette-100: #9DC1DF;--vpms-primary-palette-200: #80AED5;--vpms-primary-palette-300: #609ACA;--vpms-primary-palette-400: #2F7BBA;--vpms-primary-palette-500: #0A64AE;--vpms-primary-palette-600: #095A9D;--vpms-primary-palette-700: #063C68;--vpms-primary-palette-800: #042846;--vpms-primary-palette-900: #021423;--vpms-accent-palette-50: #FEF2F8;--vpms-accent-palette-100: #F8BFDF;--vpms-accent-palette-200: #F599CB;--vpms-accent-palette-300: #EF66B1;--vpms-accent-palette-400: #EA3397;--vpms-accent-palette-500: #E5007D;--vpms-accent-palette-600: #CE0071;--vpms-accent-palette-700: #AC005E;--vpms-accent-palette-800: #7E0045;--vpms-accent-palette-900: #50002C;--vpms-grayscale-0: #FFFFFF;--vpms-grayscale-50: #FAFAFA;--vpms-grayscale-100: #F2F2F2;--vpms-grayscale-200: #E6E6E6;--vpms-grayscale-250: #DADAD9;--vpms-grayscale-300: #CCCCCC;--vpms-grayscale-400: #B3B3B3;--vpms-grayscale-500: #999999;--vpms-grayscale-600: #808080;--vpms-grayscale-700: #666666;--vpms-grayscale-800: #4D4D4D;--vpms-grayscale-900: #333333;--vpms-grayscale-1000: #000000}[_nghost-%COMP%]{display:block;height:100%}.toggled[_ngcontent-%COMP%]{color:#0a64ae}mat-sidenav-container[_ngcontent-%COMP%]{height:100%}mat-sidenav[_ngcontent-%COMP%]{width:15rem;padding:1rem}mat-sidenav[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;height:3rem;text-align:left;margin-bottom:.5rem}mat-sidenav[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:#0a64ae}mat-sidenav[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}.toggle_sidenav[_ngcontent-%COMP%]{position:absolute;top:3rem;left:-1rem;z-index:20;transform:rotate(90deg)}.toggle_sidenav.is_opened[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{transform:rotate(90deg)}.toggle_sidenav[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{transform:rotate(-90deg)}"]}),x})()}];let ti=(()=>{class x{}return x.\u0275fac=function(b){return new(b||x)},x.\u0275mod=l.oAB({type:x}),x.\u0275inj=l.cJS({imports:[[g.Bz.forChild(En)],g.Bz]}),x})(),zo=(()=>{class x{}return x.\u0275fac=function(b){return new(b||x)},x.\u0275mod=l.oAB({type:x}),x.\u0275inj=l.cJS({imports:[[ti,v.m,N.aw,te.Is,U.UX,ge.ez,Vt.p9,be.SJ,Bt.vV]]}),x})()},432:(Yt,Ke,R)=>{R.d(Ke,{C:()=>N});var v=R(7517);let N=(()=>{class g extends v.b{constructor(he,U,Ie,ze){super(U),this.actor=he,Ie?this.fieldPosition=Ie:this.setPosition(this.fromDiscreteX(4612.5),this.fromDiscreteY(5500)),this.rotationOffset=ze}toDto(){return{f:{x:Number(this.fieldPosition.x.toFixed(0)).valueOf(),y:Number(this.fieldPosition.y.toFixed(0)).valueOf()},ro:this.rotationOffset?this.rotationOffset.value:"NULL"}}draw(){super.draw(),this.drawPosition(),this.drawActorName()}currentPosition(){if(this.rotationOffset)return this.actor.position.rotate(this.rotationOffset)}setPosition(he,U){this.fieldPosition={x:this.toDiscreteX(he),y:this.toDiscreteY(U)}}setFieldPosition(he){this.fieldPosition=he}get x(){return this.fromDiscreteX(this.getFieldPosition().x)}get y(){return this.fromDiscreteY(this.getFieldPosition().y)}getFieldPosition(){return this.fieldPosition}setRotationProperties(he){this.rotationOffset=he}sizeCoefficientX(){return this.context.canvas.width/9/g.BASE_SIZE_RESOLUTION_X_1M_IN_PIXEL}sizeCoefficientY(){return this.context.canvas.height/10/g.BASE_SIZE_RESOLUTION_Y_1M_IN_PIXEL}}return g.BASE_SIZE_RESOLUTION_X_1M_IN_PIXEL=40,g.BASE_SIZE_RESOLUTION_Y_1M_IN_PIXEL=76,g.ACTOR_COLOR="#34abcd",g})()},641:(Yt,Ke,R)=>{R.d(Ke,{x:()=>g});var v=R(7517),N=R(3371);class g extends v.b{constructor(he,U,Ie){super(he),this.drawColor=U,this.positions=null!=Ie?Ie:[]}addPosition(he,U){this.positions.push({x:this.toDiscreteX(he),y:this.toDiscreteY(U)})}drawShape(){if(!(this.positions.length<=1)){this.context.beginPath(),this.context.setLineDash([]),this.context.moveTo(this.fromDiscreteX(this.positions[0].x),this.fromDiscreteY(this.positions[0].y));for(let he=1;he<this.positions.length;++he)this.context.lineTo(this.fromDiscreteX(this.positions[he].x),this.fromDiscreteY(this.positions[he].y));switch(this.context.lineWidth=3,this.drawColor){case N.D.Black:this.context.strokeStyle="#003300";break;case N.D.Blue:this.context.strokeStyle="blue";break;case N.D.Green:this.context.strokeStyle="green";break;case N.D.Red:this.context.strokeStyle="red";break;case N.D.White:this.context.strokeStyle="white"}this.context.stroke()}}isHit(he,U){const Ie=this.toDiscreteX(he),ze=this.toDiscreteY(U);let ve=this.positions[0];for(let Ee=1;Ee<this.positions.length;++Ee){const Te=this.positions[Ee];if(ve.x<Te.x){const oe=ve.x-2<=Ie&&Te.x+2>=Ie;if(ve.y<Te.y){if(oe&&ve.y-2<=ze&&Te.y+2>=ze)return!0}else if(oe&&ve.y+2>=ze&&Te.y-2<=ze)return!0}else{const oe=ve.x+2>=Ie&&Te.x-2<=Ie;if(ve.y<Te.y){if(oe&&ve.y-2<=ze&&Te.y+2>=ze)return!0}else if(oe&&ve.y+2>=ze&&Te.y-2<=ze)return!0}ve=Te}return!1}toDto(){return{f:Object.fromEntries(this.positions.reduce((he,U)=>(he.set(he.size,U),he),new Map)),c:this.drawColor}}}},7517:(Yt,Ke,R)=>{R.d(Ke,{b:()=>v});let v=(()=>{class N{constructor(de){this.context=de}draw(){this.drawShape()}fromDiscreteX(de){return de*(this.context.canvas.width/N.FIELD_RESOLUTION_X)}fromDiscreteY(de){return de*(this.context.canvas.height/N.FIELD_RESOLUTION_Y)}toDiscreteX(de){return Math.max(0,Math.min(Math.ceil(de*(N.FIELD_RESOLUTION_X/this.context.canvas.width)),N.FIELD_RESOLUTION_X))}toDiscreteY(de){return Math.max(0,Math.min(Math.ceil(de*(N.FIELD_RESOLUTION_Y/this.context.canvas.height)),N.FIELD_RESOLUTION_Y))}}return N.FIELD_RESOLUTION_Y=10225,N.FIELD_RESOLUTION_X=9450,N})()},5216:(Yt,Ke,R)=>{R.d(Ke,{T:()=>v});var v=(()=>{return(N=v||(v={}))[N.MOVE_ACTOR=0]="MOVE_ACTOR",N[N.DRAW_LINE=1]="DRAW_LINE",N[N.ERASE_LINE=2]="ERASE_LINE",v;var N})()},3371:(Yt,Ke,R)=>{R.d(Ke,{D:()=>v});var v=(()=>{return(N=v||(v={}))[N.Black=0]="Black",N[N.Green=1]="Green",N[N.Red=2]="Red",N[N.Blue=3]="Blue",N[N.White=4]="White",v;var N})()},7691:(Yt,Ke,R)=>{function v(N=5){let g="";for(;g.length<N;)g+=Math.random().toString(36).substring(2,7);return g.substring(0,N)}R.d(Ke,{k:()=>v})},9832:(Yt,Ke,R)=>{R.d(Ke,{A9:()=>me,Yi:()=>Be,vV:()=>l});var v=R(3191),N=R(449),g=R(5e3),de=R(3075),he=R(508),U=R(8255);const Ie=["button"],ze=["*"],Se=new g.OlP("MAT_BUTTON_TOGGLE_DEFAULT_OPTIONS"),ve=new g.OlP("MatButtonToggleGroup"),Ee={provide:de.JU,useExisting:(0,g.Gpc)(()=>me),multi:!0};let Te=0;class oe{constructor(k,P){this.source=k,this.value=P}}let me=(()=>{class te{constructor(P,W){this._changeDetector=P,this._vertical=!1,this._multiple=!1,this._disabled=!1,this._controlValueAccessorChangeFn=()=>{},this._onTouched=()=>{},this._name="mat-button-toggle-group-"+Te++,this.valueChange=new g.vpe,this.change=new g.vpe,this.appearance=W&&W.appearance?W.appearance:"standard"}get name(){return this._name}set name(P){this._name=P,this._buttonToggles&&this._buttonToggles.forEach(W=>{W.name=this._name,W._markForCheck()})}get vertical(){return this._vertical}set vertical(P){this._vertical=(0,v.Ig)(P)}get value(){const P=this._selectionModel?this._selectionModel.selected:[];return this.multiple?P.map(W=>W.value):P[0]?P[0].value:void 0}set value(P){this._setSelectionByValue(P),this.valueChange.emit(this.value)}get selected(){const P=this._selectionModel?this._selectionModel.selected:[];return this.multiple?P:P[0]||null}get multiple(){return this._multiple}set multiple(P){this._multiple=(0,v.Ig)(P)}get disabled(){return this._disabled}set disabled(P){this._disabled=(0,v.Ig)(P),this._buttonToggles&&this._buttonToggles.forEach(W=>W._markForCheck())}ngOnInit(){this._selectionModel=new N.Ov(this.multiple,void 0,!1)}ngAfterContentInit(){this._selectionModel.select(...this._buttonToggles.filter(P=>P.checked))}writeValue(P){this.value=P,this._changeDetector.markForCheck()}registerOnChange(P){this._controlValueAccessorChangeFn=P}registerOnTouched(P){this._onTouched=P}setDisabledState(P){this.disabled=P}_emitChangeEvent(){const P=this.selected,W=Array.isArray(P)?P[P.length-1]:P,ae=new oe(W,this.value);this._controlValueAccessorChangeFn(ae.value),this.change.emit(ae)}_syncButtonToggle(P,W,ae=!1,Q=!1){!this.multiple&&this.selected&&!P.checked&&(this.selected.checked=!1),this._selectionModel?W?this._selectionModel.select(P):this._selectionModel.deselect(P):Q=!0,Q?Promise.resolve().then(()=>this._updateModelValue(ae)):this._updateModelValue(ae)}_isSelected(P){return this._selectionModel&&this._selectionModel.isSelected(P)}_isPrechecked(P){return void 0!==this._rawValue&&(this.multiple&&Array.isArray(this._rawValue)?this._rawValue.some(W=>null!=P.value&&W===P.value):P.value===this._rawValue)}_setSelectionByValue(P){this._rawValue=P,this._buttonToggles&&(this.multiple&&P?(Array.isArray(P),this._clearSelection(),P.forEach(W=>this._selectValue(W))):(this._clearSelection(),this._selectValue(P)))}_clearSelection(){this._selectionModel.clear(),this._buttonToggles.forEach(P=>P.checked=!1)}_selectValue(P){const W=this._buttonToggles.find(ae=>null!=ae.value&&ae.value===P);W&&(W.checked=!0,this._selectionModel.select(W))}_updateModelValue(P){P&&this._emitChangeEvent(),this.valueChange.emit(this.value)}}return te.\u0275fac=function(P){return new(P||te)(g.Y36(g.sBO),g.Y36(Se,8))},te.\u0275dir=g.lG2({type:te,selectors:[["mat-button-toggle-group"]],contentQueries:function(P,W,ae){if(1&P&&g.Suo(ae,Be,5),2&P){let Q;g.iGM(Q=g.CRH())&&(W._buttonToggles=Q)}},hostAttrs:["role","group",1,"mat-button-toggle-group"],hostVars:5,hostBindings:function(P,W){2&P&&(g.uIk("aria-disabled",W.disabled),g.ekj("mat-button-toggle-vertical",W.vertical)("mat-button-toggle-group-appearance-standard","standard"===W.appearance))},inputs:{appearance:"appearance",name:"name",vertical:"vertical",value:"value",multiple:"multiple",disabled:"disabled"},outputs:{valueChange:"valueChange",change:"change"},exportAs:["matButtonToggleGroup"],features:[g._Bn([Ee,{provide:ve,useExisting:te}])]}),te})();const xe=(0,he.Kr)(class{});let Be=(()=>{class te extends xe{constructor(P,W,ae,Q,qe,$){super(),this._changeDetectorRef=W,this._elementRef=ae,this._focusMonitor=Q,this._isSingleSelector=!1,this._checked=!1,this.ariaLabelledby=null,this._disabled=!1,this.change=new g.vpe;const T=Number(qe);this.tabIndex=T||0===T?T:null,this.buttonToggleGroup=P,this.appearance=$&&$.appearance?$.appearance:"standard"}get buttonId(){return`${this.id}-button`}get appearance(){return this.buttonToggleGroup?this.buttonToggleGroup.appearance:this._appearance}set appearance(P){this._appearance=P}get checked(){return this.buttonToggleGroup?this.buttonToggleGroup._isSelected(this):this._checked}set checked(P){const W=(0,v.Ig)(P);W!==this._checked&&(this._checked=W,this.buttonToggleGroup&&this.buttonToggleGroup._syncButtonToggle(this,this._checked),this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled||this.buttonToggleGroup&&this.buttonToggleGroup.disabled}set disabled(P){this._disabled=(0,v.Ig)(P)}ngOnInit(){const P=this.buttonToggleGroup;this._isSingleSelector=P&&!P.multiple,this.id=this.id||"mat-button-toggle-"+Te++,this._isSingleSelector&&(this.name=P.name),P&&(P._isPrechecked(this)?this.checked=!0:P._isSelected(this)!==this._checked&&P._syncButtonToggle(this,this._checked))}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){const P=this.buttonToggleGroup;this._focusMonitor.stopMonitoring(this._elementRef),P&&P._isSelected(this)&&P._syncButtonToggle(this,!1,!1,!0)}focus(P){this._buttonElement.nativeElement.focus(P)}_onButtonClick(){const P=!!this._isSingleSelector||!this._checked;P!==this._checked&&(this._checked=P,this.buttonToggleGroup&&(this.buttonToggleGroup._syncButtonToggle(this,this._checked,!0),this.buttonToggleGroup._onTouched())),this.change.emit(new oe(this,this.value))}_markForCheck(){this._changeDetectorRef.markForCheck()}}return te.\u0275fac=function(P){return new(P||te)(g.Y36(ve,8),g.Y36(g.sBO),g.Y36(g.SBq),g.Y36(U.tE),g.$8M("tabindex"),g.Y36(Se,8))},te.\u0275cmp=g.Xpm({type:te,selectors:[["mat-button-toggle"]],viewQuery:function(P,W){if(1&P&&g.Gf(Ie,5),2&P){let ae;g.iGM(ae=g.CRH())&&(W._buttonElement=ae.first)}},hostAttrs:["role","presentation",1,"mat-button-toggle"],hostVars:12,hostBindings:function(P,W){1&P&&g.NdJ("focus",function(){return W.focus()}),2&P&&(g.uIk("aria-label",null)("aria-labelledby",null)("id",W.id)("name",null),g.ekj("mat-button-toggle-standalone",!W.buttonToggleGroup)("mat-button-toggle-checked",W.checked)("mat-button-toggle-disabled",W.disabled)("mat-button-toggle-appearance-standard","standard"===W.appearance))},inputs:{disableRipple:"disableRipple",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],id:"id",name:"name",value:"value",tabIndex:"tabIndex",appearance:"appearance",checked:"checked",disabled:"disabled"},outputs:{change:"change"},exportAs:["matButtonToggle"],features:[g.qOj],ngContentSelectors:ze,decls:6,vars:9,consts:[["type","button",1,"mat-button-toggle-button","mat-focus-indicator",3,"id","disabled","click"],["button",""],[1,"mat-button-toggle-label-content"],[1,"mat-button-toggle-focus-overlay"],["matRipple","",1,"mat-button-toggle-ripple",3,"matRippleTrigger","matRippleDisabled"]],template:function(P,W){if(1&P&&(g.F$t(),g.TgZ(0,"button",0,1),g.NdJ("click",function(){return W._onButtonClick()}),g.TgZ(2,"span",2),g.Hsn(3),g.qZA()(),g._UZ(4,"span",3)(5,"span",4)),2&P){const ae=g.MAs(1);g.Q6J("id",W.buttonId)("disabled",W.disabled||null),g.uIk("tabindex",W.disabled?-1:W.tabIndex)("aria-pressed",W.checked)("name",W.name||null)("aria-label",W.ariaLabel)("aria-labelledby",W.ariaLabelledby),g.xp6(5),g.Q6J("matRippleTrigger",ae)("matRippleDisabled",W.disableRipple||W.disabled)}},directives:[he.wG],styles:[".mat-button-toggle-standalone,.mat-button-toggle-group{position:relative;display:inline-flex;flex-direction:row;white-space:nowrap;overflow:hidden;border-radius:2px;-webkit-tap-highlight-color:transparent;transform:translateZ(0)}.cdk-high-contrast-active .mat-button-toggle-standalone,.cdk-high-contrast-active .mat-button-toggle-group{outline:solid 1px}.mat-button-toggle-standalone.mat-button-toggle-appearance-standard,.mat-button-toggle-group-appearance-standard{border-radius:4px}.cdk-high-contrast-active .mat-button-toggle-standalone.mat-button-toggle-appearance-standard,.cdk-high-contrast-active .mat-button-toggle-group-appearance-standard{outline:0}.mat-button-toggle-vertical{flex-direction:column}.mat-button-toggle-vertical .mat-button-toggle-label-content{display:block}.mat-button-toggle{white-space:nowrap;position:relative}.mat-button-toggle .mat-icon svg{vertical-align:top}.mat-button-toggle.cdk-keyboard-focused .mat-button-toggle-focus-overlay{opacity:1}.cdk-high-contrast-active .mat-button-toggle.cdk-keyboard-focused .mat-button-toggle-focus-overlay{opacity:.5}.mat-button-toggle-appearance-standard:not(.mat-button-toggle-disabled):hover .mat-button-toggle-focus-overlay{opacity:.04}.mat-button-toggle-appearance-standard.cdk-keyboard-focused:not(.mat-button-toggle-disabled) .mat-button-toggle-focus-overlay{opacity:.12}.cdk-high-contrast-active .mat-button-toggle-appearance-standard.cdk-keyboard-focused:not(.mat-button-toggle-disabled) .mat-button-toggle-focus-overlay{opacity:.5}@media(hover: none){.mat-button-toggle-appearance-standard:not(.mat-button-toggle-disabled):hover .mat-button-toggle-focus-overlay{display:none}}.mat-button-toggle-label-content{-webkit-user-select:none;user-select:none;display:inline-block;line-height:36px;padding:0 16px;position:relative}.mat-button-toggle-appearance-standard .mat-button-toggle-label-content{padding:0 12px}.mat-button-toggle-label-content>*{vertical-align:middle}.mat-button-toggle-focus-overlay{border-radius:inherit;pointer-events:none;opacity:0;top:0;left:0;right:0;bottom:0;position:absolute}.mat-button-toggle-checked .cdk-high-contrast-active .mat-button-toggle-focus-overlay{border-bottom:solid 36px;opacity:.5;height:0}.cdk-high-contrast-active .mat-button-toggle-checked.mat-button-toggle-appearance-standard .mat-button-toggle-focus-overlay{border-bottom:solid 500px}.mat-button-toggle .mat-button-toggle-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-button-toggle-button{border:0;background:none;color:inherit;padding:0;margin:0;font:inherit;outline:none;width:100%;cursor:pointer}.mat-button-toggle-disabled .mat-button-toggle-button{cursor:default}.mat-button-toggle-button::-moz-focus-inner{border:0}\n"],encapsulation:2,changeDetection:0}),te})(),l=(()=>{class te{}return te.\u0275fac=function(P){return new(P||te)},te.\u0275mod=g.oAB({type:te}),te.\u0275inj=g.cJS({imports:[[he.BQ,he.si],he.BQ]}),te})()},7446:(Yt,Ke,R)=>{R.d(Ke,{oG:()=>te,p9:()=>ae});var v=R(3191),N=R(5e3),g=R(3075),de=R(508),he=R(6360),U=R(8255),Ie=R(7144);const ze=["input"],Se=function(Q){return{enterDuration:Q}},ve=["*"],Ee=new N.OlP("mat-checkbox-default-options",{providedIn:"root",factory:Te});function Te(){return{color:"accent",clickAction:"check-indeterminate"}}let oe=0;const me=Te(),xe={provide:g.JU,useExisting:(0,N.Gpc)(()=>te),multi:!0};class Be{}const l=(0,de.sb)((0,de.pj)((0,de.Kr)((0,de.Id)(class{constructor(Q){this._elementRef=Q}}))));let te=(()=>{class Q extends l{constructor($,T,ge,re,Mt,Ve,Ut){super($),this._changeDetectorRef=T,this._focusMonitor=ge,this._ngZone=re,this._animationMode=Ve,this._options=Ut,this.ariaLabel="",this.ariaLabelledby=null,this._uniqueId="mat-checkbox-"+ ++oe,this.id=this._uniqueId,this.labelPosition="after",this.name=null,this.change=new N.vpe,this.indeterminateChange=new N.vpe,this._onTouched=()=>{},this._currentAnimationClass="",this._currentCheckState=0,this._controlValueAccessorChangeFn=()=>{},this._checked=!1,this._disabled=!1,this._indeterminate=!1,this._options=this._options||me,this.color=this.defaultColor=this._options.color||me.color,this.tabIndex=parseInt(Mt)||0}get inputId(){return`${this.id||this._uniqueId}-input`}get required(){return this._required}set required($){this._required=(0,v.Ig)($)}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe($=>{$||Promise.resolve().then(()=>{this._onTouched(),this._changeDetectorRef.markForCheck()})}),this._syncIndeterminate(this._indeterminate)}ngAfterViewChecked(){}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}get checked(){return this._checked}set checked($){const T=(0,v.Ig)($);T!=this.checked&&(this._checked=T,this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled}set disabled($){const T=(0,v.Ig)($);T!==this.disabled&&(this._disabled=T,this._changeDetectorRef.markForCheck())}get indeterminate(){return this._indeterminate}set indeterminate($){const T=$!=this._indeterminate;this._indeterminate=(0,v.Ig)($),T&&(this._transitionCheckState(this._indeterminate?3:this.checked?1:2),this.indeterminateChange.emit(this._indeterminate)),this._syncIndeterminate(this._indeterminate)}_isRippleDisabled(){return this.disableRipple||this.disabled}_onLabelTextChange(){this._changeDetectorRef.detectChanges()}writeValue($){this.checked=!!$}registerOnChange($){this._controlValueAccessorChangeFn=$}registerOnTouched($){this._onTouched=$}setDisabledState($){this.disabled=$}_getAriaChecked(){return this.checked?"true":this.indeterminate?"mixed":"false"}_transitionCheckState($){let T=this._currentCheckState,ge=this._elementRef.nativeElement;if(T!==$&&(this._currentAnimationClass.length>0&&ge.classList.remove(this._currentAnimationClass),this._currentAnimationClass=this._getAnimationClassForCheckStateTransition(T,$),this._currentCheckState=$,this._currentAnimationClass.length>0)){ge.classList.add(this._currentAnimationClass);const re=this._currentAnimationClass;this._ngZone.runOutsideAngular(()=>{setTimeout(()=>{ge.classList.remove(re)},1e3)})}}_emitChangeEvent(){const $=new Be;$.source=this,$.checked=this.checked,this._controlValueAccessorChangeFn(this.checked),this.change.emit($),this._inputElement&&(this._inputElement.nativeElement.checked=this.checked)}toggle(){this.checked=!this.checked,this._controlValueAccessorChangeFn(this.checked)}_onInputClick($){var T;const ge=null===(T=this._options)||void 0===T?void 0:T.clickAction;$.stopPropagation(),this.disabled||"noop"===ge?!this.disabled&&"noop"===ge&&(this._inputElement.nativeElement.checked=this.checked,this._inputElement.nativeElement.indeterminate=this.indeterminate):(this.indeterminate&&"check"!==ge&&Promise.resolve().then(()=>{this._indeterminate=!1,this.indeterminateChange.emit(this._indeterminate)}),this._checked=!this._checked,this._transitionCheckState(this._checked?1:2),this._emitChangeEvent())}focus($,T){$?this._focusMonitor.focusVia(this._inputElement,$,T):this._inputElement.nativeElement.focus(T)}_onInteractionEvent($){$.stopPropagation()}_getAnimationClassForCheckStateTransition($,T){if("NoopAnimations"===this._animationMode)return"";let ge="";switch($){case 0:if(1===T)ge="unchecked-checked";else{if(3!=T)return"";ge="unchecked-indeterminate"}break;case 2:ge=1===T?"unchecked-checked":"unchecked-indeterminate";break;case 1:ge=2===T?"checked-unchecked":"checked-indeterminate";break;case 3:ge=1===T?"indeterminate-checked":"indeterminate-unchecked"}return`mat-checkbox-anim-${ge}`}_syncIndeterminate($){const T=this._inputElement;T&&(T.nativeElement.indeterminate=$)}}return Q.\u0275fac=function($){return new($||Q)(N.Y36(N.SBq),N.Y36(N.sBO),N.Y36(U.tE),N.Y36(N.R0b),N.$8M("tabindex"),N.Y36(he.Qb,8),N.Y36(Ee,8))},Q.\u0275cmp=N.Xpm({type:Q,selectors:[["mat-checkbox"]],viewQuery:function($,T){if(1&$&&(N.Gf(ze,5),N.Gf(de.wG,5)),2&$){let ge;N.iGM(ge=N.CRH())&&(T._inputElement=ge.first),N.iGM(ge=N.CRH())&&(T.ripple=ge.first)}},hostAttrs:[1,"mat-checkbox"],hostVars:14,hostBindings:function($,T){2&$&&(N.Ikx("id",T.id),N.uIk("tabindex",null)("aria-label",null)("aria-labelledby",null),N.ekj("mat-checkbox-indeterminate",T.indeterminate)("mat-checkbox-checked",T.checked)("mat-checkbox-disabled",T.disabled)("mat-checkbox-label-before","before"==T.labelPosition)("_mat-animation-noopable","NoopAnimations"===T._animationMode))},inputs:{disableRipple:"disableRipple",color:"color",tabIndex:"tabIndex",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],ariaDescribedby:["aria-describedby","ariaDescribedby"],id:"id",required:"required",labelPosition:"labelPosition",name:"name",value:"value",checked:"checked",disabled:"disabled",indeterminate:"indeterminate"},outputs:{change:"change",indeterminateChange:"indeterminateChange"},exportAs:["matCheckbox"],features:[N._Bn([xe]),N.qOj],ngContentSelectors:ve,decls:17,vars:21,consts:[[1,"mat-checkbox-layout"],["label",""],[1,"mat-checkbox-inner-container"],["type","checkbox",1,"mat-checkbox-input","cdk-visually-hidden",3,"id","required","checked","disabled","tabIndex","change","click"],["input",""],["matRipple","",1,"mat-checkbox-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleRadius","matRippleCentered","matRippleAnimation"],[1,"mat-ripple-element","mat-checkbox-persistent-ripple"],[1,"mat-checkbox-frame"],[1,"mat-checkbox-background"],["version","1.1","focusable","false","viewBox","0 0 24 24","aria-hidden","true",1,"mat-checkbox-checkmark"],["fill","none","stroke","white","d","M4.1,12.7 9,17.6 20.3,6.3",1,"mat-checkbox-checkmark-path"],[1,"mat-checkbox-mixedmark"],[1,"mat-checkbox-label",3,"cdkObserveContent"],["checkboxLabel",""],[2,"display","none"]],template:function($,T){if(1&$&&(N.F$t(),N.TgZ(0,"label",0,1)(2,"span",2)(3,"input",3,4),N.NdJ("change",function(re){return T._onInteractionEvent(re)})("click",function(re){return T._onInputClick(re)}),N.qZA(),N.TgZ(5,"span",5),N._UZ(6,"span",6),N.qZA(),N._UZ(7,"span",7),N.TgZ(8,"span",8),N.O4$(),N.TgZ(9,"svg",9),N._UZ(10,"path",10),N.qZA(),N.kcU(),N._UZ(11,"span",11),N.qZA()(),N.TgZ(12,"span",12,13),N.NdJ("cdkObserveContent",function(){return T._onLabelTextChange()}),N.TgZ(14,"span",14),N._uU(15,"\xa0"),N.qZA(),N.Hsn(16),N.qZA()()),2&$){const ge=N.MAs(1),re=N.MAs(13);N.uIk("for",T.inputId),N.xp6(2),N.ekj("mat-checkbox-inner-container-no-side-margin",!re.textContent||!re.textContent.trim()),N.xp6(1),N.Q6J("id",T.inputId)("required",T.required)("checked",T.checked)("disabled",T.disabled)("tabIndex",T.tabIndex),N.uIk("value",T.value)("name",T.name)("aria-label",T.ariaLabel||null)("aria-labelledby",T.ariaLabelledby)("aria-checked",T._getAriaChecked())("aria-describedby",T.ariaDescribedby),N.xp6(2),N.Q6J("matRippleTrigger",ge)("matRippleDisabled",T._isRippleDisabled())("matRippleRadius",20)("matRippleCentered",!0)("matRippleAnimation",N.VKq(19,Se,"NoopAnimations"===T._animationMode?0:150))}},directives:[de.wG,Ie.wD],styles:["@keyframes mat-checkbox-fade-in-background{0%{opacity:0}50%{opacity:1}}@keyframes mat-checkbox-fade-out-background{0%,50%{opacity:1}100%{opacity:0}}@keyframes mat-checkbox-unchecked-checked-checkmark-path{0%,50%{stroke-dashoffset:22.910259}50%{animation-timing-function:cubic-bezier(0, 0, 0.2, 0.1)}100%{stroke-dashoffset:0}}@keyframes mat-checkbox-unchecked-indeterminate-mixedmark{0%,68.2%{transform:scaleX(0)}68.2%{animation-timing-function:cubic-bezier(0, 0, 0, 1)}100%{transform:scaleX(1)}}@keyframes mat-checkbox-checked-unchecked-checkmark-path{from{animation-timing-function:cubic-bezier(0.4, 0, 1, 1);stroke-dashoffset:0}to{stroke-dashoffset:-22.910259}}@keyframes mat-checkbox-checked-indeterminate-checkmark{from{animation-timing-function:cubic-bezier(0, 0, 0.2, 0.1);opacity:1;transform:rotate(0deg)}to{opacity:0;transform:rotate(45deg)}}@keyframes mat-checkbox-indeterminate-checked-checkmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);opacity:0;transform:rotate(45deg)}to{opacity:1;transform:rotate(360deg)}}@keyframes mat-checkbox-checked-indeterminate-mixedmark{from{animation-timing-function:cubic-bezier(0, 0, 0.2, 0.1);opacity:0;transform:rotate(-45deg)}to{opacity:1;transform:rotate(0deg)}}@keyframes mat-checkbox-indeterminate-checked-mixedmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);opacity:1;transform:rotate(0deg)}to{opacity:0;transform:rotate(315deg)}}@keyframes mat-checkbox-indeterminate-unchecked-mixedmark{0%{animation-timing-function:linear;opacity:1;transform:scaleX(1)}32.8%,100%{opacity:0;transform:scaleX(0)}}.mat-checkbox-background,.mat-checkbox-frame{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:2px;box-sizing:border-box;pointer-events:none}.mat-checkbox{display:inline-block;transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);cursor:pointer;-webkit-tap-highlight-color:transparent}._mat-animation-noopable.mat-checkbox{transition:none;animation:none}.mat-checkbox .mat-ripple-element:not(.mat-checkbox-persistent-ripple){opacity:.16}.mat-checkbox .mat-checkbox-ripple{position:absolute;left:calc(50% - 20px);top:calc(50% - 20px);height:40px;width:40px;z-index:1;pointer-events:none}.cdk-high-contrast-active .mat-checkbox.cdk-keyboard-focused .mat-checkbox-ripple{outline:solid 3px}.mat-checkbox-layout{-webkit-user-select:none;user-select:none;cursor:inherit;align-items:baseline;vertical-align:middle;display:inline-flex;white-space:nowrap}.mat-checkbox-label{-webkit-user-select:auto;user-select:auto}.mat-checkbox-inner-container{display:inline-block;height:16px;line-height:0;margin:auto;margin-right:8px;order:0;position:relative;vertical-align:middle;white-space:nowrap;width:16px;flex-shrink:0}[dir=rtl] .mat-checkbox-inner-container{margin-left:8px;margin-right:auto}.mat-checkbox-inner-container-no-side-margin{margin-left:0;margin-right:0}.mat-checkbox-frame{background-color:transparent;transition:border-color 90ms cubic-bezier(0, 0, 0.2, 0.1);border-width:2px;border-style:solid}._mat-animation-noopable .mat-checkbox-frame{transition:none}.mat-checkbox-background{align-items:center;display:inline-flex;justify-content:center;transition:background-color 90ms cubic-bezier(0, 0, 0.2, 0.1),opacity 90ms cubic-bezier(0, 0, 0.2, 0.1);-webkit-print-color-adjust:exact;color-adjust:exact}._mat-animation-noopable .mat-checkbox-background{transition:none}.cdk-high-contrast-active .mat-checkbox .mat-checkbox-background{background:none}.mat-checkbox-persistent-ripple{display:block;width:100%;height:100%;transform:none}.mat-checkbox-inner-container:hover .mat-checkbox-persistent-ripple{opacity:.04}.mat-checkbox.cdk-keyboard-focused .mat-checkbox-persistent-ripple{opacity:.12}.mat-checkbox-persistent-ripple,.mat-checkbox.mat-checkbox-disabled .mat-checkbox-inner-container:hover .mat-checkbox-persistent-ripple{opacity:0}@media(hover: none){.mat-checkbox-inner-container:hover .mat-checkbox-persistent-ripple{display:none}}.mat-checkbox-checkmark{top:0;left:0;right:0;bottom:0;position:absolute;width:100%}.mat-checkbox-checkmark-path{stroke-dashoffset:22.910259;stroke-dasharray:22.910259;stroke-width:2.1333333333px}.cdk-high-contrast-black-on-white .mat-checkbox-checkmark-path{stroke:#000 !important}.mat-checkbox-mixedmark{width:calc(100% - 6px);height:2px;opacity:0;transform:scaleX(0) rotate(0deg);border-radius:2px}.cdk-high-contrast-active .mat-checkbox-mixedmark{height:0;border-top:solid 2px;margin-top:2px}.mat-checkbox-label-before .mat-checkbox-inner-container{order:1;margin-left:8px;margin-right:auto}[dir=rtl] .mat-checkbox-label-before .mat-checkbox-inner-container{margin-left:auto;margin-right:8px}.mat-checkbox-checked .mat-checkbox-checkmark{opacity:1}.mat-checkbox-checked .mat-checkbox-checkmark-path{stroke-dashoffset:0}.mat-checkbox-checked .mat-checkbox-mixedmark{transform:scaleX(1) rotate(-45deg)}.mat-checkbox-indeterminate .mat-checkbox-checkmark{opacity:0;transform:rotate(45deg)}.mat-checkbox-indeterminate .mat-checkbox-checkmark-path{stroke-dashoffset:0}.mat-checkbox-indeterminate .mat-checkbox-mixedmark{opacity:1;transform:scaleX(1) rotate(0deg)}.mat-checkbox-unchecked .mat-checkbox-background{background-color:transparent}.mat-checkbox-disabled{cursor:default}.cdk-high-contrast-active .mat-checkbox-disabled{opacity:.5}.mat-checkbox-anim-unchecked-checked .mat-checkbox-background{animation:180ms linear 0ms mat-checkbox-fade-in-background}.mat-checkbox-anim-unchecked-checked .mat-checkbox-checkmark-path{animation:180ms linear 0ms mat-checkbox-unchecked-checked-checkmark-path}.mat-checkbox-anim-unchecked-indeterminate .mat-checkbox-background{animation:180ms linear 0ms mat-checkbox-fade-in-background}.mat-checkbox-anim-unchecked-indeterminate .mat-checkbox-mixedmark{animation:90ms linear 0ms mat-checkbox-unchecked-indeterminate-mixedmark}.mat-checkbox-anim-checked-unchecked .mat-checkbox-background{animation:180ms linear 0ms mat-checkbox-fade-out-background}.mat-checkbox-anim-checked-unchecked .mat-checkbox-checkmark-path{animation:90ms linear 0ms mat-checkbox-checked-unchecked-checkmark-path}.mat-checkbox-anim-checked-indeterminate .mat-checkbox-checkmark{animation:90ms linear 0ms mat-checkbox-checked-indeterminate-checkmark}.mat-checkbox-anim-checked-indeterminate .mat-checkbox-mixedmark{animation:90ms linear 0ms mat-checkbox-checked-indeterminate-mixedmark}.mat-checkbox-anim-indeterminate-checked .mat-checkbox-checkmark{animation:500ms linear 0ms mat-checkbox-indeterminate-checked-checkmark}.mat-checkbox-anim-indeterminate-checked .mat-checkbox-mixedmark{animation:500ms linear 0ms mat-checkbox-indeterminate-checked-mixedmark}.mat-checkbox-anim-indeterminate-unchecked .mat-checkbox-background{animation:180ms linear 0ms mat-checkbox-fade-out-background}.mat-checkbox-anim-indeterminate-unchecked .mat-checkbox-mixedmark{animation:300ms linear 0ms mat-checkbox-indeterminate-unchecked-mixedmark}.mat-checkbox-input{bottom:0;left:50%}\n"],encapsulation:2,changeDetection:0}),Q})(),W=(()=>{class Q{}return Q.\u0275fac=function($){return new($||Q)},Q.\u0275mod=N.oAB({type:Q}),Q.\u0275inj=N.cJS({}),Q})(),ae=(()=>{class Q{}return Q.\u0275fac=function($){return new($||Q)},Q.\u0275mod=N.oAB({type:Q}),Q.\u0275inj=N.cJS({imports:[[de.si,de.BQ,Ie.Q8,W],de.BQ,W]}),Q})()},8966:(Yt,Ke,R)=>{R.d(Ke,{Is:()=>dt,WI:()=>ge,so:()=>$,uh:()=>Lt,uw:()=>Vt,xY:()=>Ze});var v=R(9776),N=R(7429),g=R(5e3),de=R(508),he=R(226),U=R(7579),Ie=R(9770),ze=R(9646),Se=R(9300),ve=R(5698),Ee=R(8675),Te=R(925),oe=R(9808),me=R(1777),xe=R(8255),Be=R(1159),l=R(6360);function te(j,J){}class k{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.maxWidth="80vw",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.delayFocusTrap=!0,this.closeOnNavigation=!0}}const P={dialogContainer:(0,me.X$)("dialogContainer",[(0,me.SB)("void, exit",(0,me.oB)({opacity:0,transform:"scale(0.7)"})),(0,me.SB)("enter",(0,me.oB)({transform:"none"})),(0,me.eR)("* => enter",(0,me.ru)([(0,me.jt)("150ms cubic-bezier(0, 0, 0.2, 1)",(0,me.oB)({transform:"none",opacity:1})),(0,me.IO)("@*",(0,me.pV)(),{optional:!0})])),(0,me.eR)("* => void, * => exit",(0,me.ru)([(0,me.jt)("75ms cubic-bezier(0.4, 0.0, 0.2, 1)",(0,me.oB)({opacity:0})),(0,me.IO)("@*",(0,me.pV)(),{optional:!0})]))])};let ae=(()=>{class j extends N.en{constructor(D,S,z,E,V,ue,be,$e){super(),this._elementRef=D,this._focusTrapFactory=S,this._changeDetectorRef=z,this._config=V,this._interactivityChecker=ue,this._ngZone=be,this._focusMonitor=$e,this._animationStateChanged=new g.vpe,this._elementFocusedBeforeDialogWasOpened=null,this._closeInteractionType=null,this.attachDomPortal=Bt=>(this._portalOutlet.hasAttached(),this._portalOutlet.attachDomPortal(Bt)),this._ariaLabelledBy=V.ariaLabelledBy||null,this._document=E}_initializeWithAttachedContent(){this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._document&&(this._elementFocusedBeforeDialogWasOpened=(0,Te.ht)())}attachComponentPortal(D){return this._portalOutlet.hasAttached(),this._portalOutlet.attachComponentPortal(D)}attachTemplatePortal(D){return this._portalOutlet.hasAttached(),this._portalOutlet.attachTemplatePortal(D)}_recaptureFocus(){this._containsFocus()||this._trapFocus()}_forceFocus(D,S){this._interactivityChecker.isFocusable(D)||(D.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const z=()=>{D.removeEventListener("blur",z),D.removeEventListener("mousedown",z),D.removeAttribute("tabindex")};D.addEventListener("blur",z),D.addEventListener("mousedown",z)})),D.focus(S)}_focusByCssSelector(D,S){let z=this._elementRef.nativeElement.querySelector(D);z&&this._forceFocus(z,S)}_trapFocus(){const D=this._elementRef.nativeElement;switch(this._config.autoFocus){case!1:case"dialog":this._containsFocus()||D.focus();break;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(S=>{S||this._focusDialogContainer()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this._config.autoFocus)}}_restoreFocus(){const D=this._elementFocusedBeforeDialogWasOpened;if(this._config.restoreFocus&&D&&"function"==typeof D.focus){const S=(0,Te.ht)(),z=this._elementRef.nativeElement;(!S||S===this._document.body||S===z||z.contains(S))&&(this._focusMonitor?(this._focusMonitor.focusVia(D,this._closeInteractionType),this._closeInteractionType=null):D.focus())}this._focusTrap&&this._focusTrap.destroy()}_focusDialogContainer(){this._elementRef.nativeElement.focus&&this._elementRef.nativeElement.focus()}_containsFocus(){const D=this._elementRef.nativeElement,S=(0,Te.ht)();return D===S||D.contains(S)}}return j.\u0275fac=function(D){return new(D||j)(g.Y36(g.SBq),g.Y36(xe.qV),g.Y36(g.sBO),g.Y36(oe.K0,8),g.Y36(k),g.Y36(xe.ic),g.Y36(g.R0b),g.Y36(xe.tE))},j.\u0275dir=g.lG2({type:j,viewQuery:function(D,S){if(1&D&&g.Gf(N.Pl,7),2&D){let z;g.iGM(z=g.CRH())&&(S._portalOutlet=z.first)}},features:[g.qOj]}),j})(),Q=(()=>{class j extends ae{constructor(){super(...arguments),this._state="enter"}_onAnimationDone({toState:D,totalTime:S}){"enter"===D?(this._config.delayFocusTrap&&this._trapFocus(),this._animationStateChanged.next({state:"opened",totalTime:S})):"exit"===D&&(this._restoreFocus(),this._animationStateChanged.next({state:"closed",totalTime:S}))}_onAnimationStart({toState:D,totalTime:S}){"enter"===D?this._animationStateChanged.next({state:"opening",totalTime:S}):("exit"===D||"void"===D)&&this._animationStateChanged.next({state:"closing",totalTime:S})}_startExitAnimation(){this._state="exit",this._changeDetectorRef.markForCheck()}_initializeWithAttachedContent(){super._initializeWithAttachedContent(),this._config.delayFocusTrap||this._trapFocus()}}return j.\u0275fac=function(){let J;return function(S){return(J||(J=g.n5z(j)))(S||j)}}(),j.\u0275cmp=g.Xpm({type:j,selectors:[["mat-dialog-container"]],hostAttrs:["tabindex","-1","aria-modal","true",1,"mat-dialog-container"],hostVars:6,hostBindings:function(D,S){1&D&&g.WFA("@dialogContainer.start",function(E){return S._onAnimationStart(E)})("@dialogContainer.done",function(E){return S._onAnimationDone(E)}),2&D&&(g.Ikx("id",S._id),g.uIk("role",S._config.role)("aria-labelledby",S._config.ariaLabel?null:S._ariaLabelledBy)("aria-label",S._config.ariaLabel)("aria-describedby",S._config.ariaDescribedBy||null),g.d8E("@dialogContainer",S._state))},features:[g.qOj],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(D,S){1&D&&g.YNc(0,te,0,0,"ng-template",0)},directives:[N.Pl],styles:[".mat-dialog-container{display:block;padding:24px;border-radius:4px;box-sizing:border-box;overflow:auto;outline:0;width:100%;height:100%;min-height:inherit;max-height:inherit}.cdk-high-contrast-active .mat-dialog-container{outline:solid 1px}.mat-dialog-content{display:block;margin:0 -24px;padding:0 24px;max-height:65vh;overflow:auto;-webkit-overflow-scrolling:touch}.mat-dialog-title{margin:0 0 20px;display:block}.mat-dialog-actions{padding:8px 0;display:flex;flex-wrap:wrap;min-height:52px;align-items:center;box-sizing:content-box;margin-bottom:-24px}.mat-dialog-actions[align=end]{justify-content:flex-end}.mat-dialog-actions[align=center]{justify-content:center}.mat-dialog-actions .mat-button-base+.mat-button-base,.mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}\n"],encapsulation:2,data:{animation:[P.dialogContainer]}}),j})(),qe=0;class ${constructor(J,D,S="mat-dialog-"+qe++){this._overlayRef=J,this._containerInstance=D,this.id=S,this.disableClose=this._containerInstance._config.disableClose,this._afterOpened=new U.x,this._afterClosed=new U.x,this._beforeClosed=new U.x,this._state=0,D._id=S,D._animationStateChanged.pipe((0,Se.h)(z=>"opened"===z.state),(0,ve.q)(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),D._animationStateChanged.pipe((0,Se.h)(z=>"closed"===z.state),(0,ve.q)(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),J.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._afterClosed.next(this._result),this._afterClosed.complete(),this.componentInstance=null,this._overlayRef.dispose()}),J.keydownEvents().pipe((0,Se.h)(z=>z.keyCode===Be.hY&&!this.disableClose&&!(0,Be.Vb)(z))).subscribe(z=>{z.preventDefault(),T(this,"keyboard")}),J.backdropClick().subscribe(()=>{this.disableClose?this._containerInstance._recaptureFocus():T(this,"mouse")})}close(J){this._result=J,this._containerInstance._animationStateChanged.pipe((0,Se.h)(D=>"closing"===D.state),(0,ve.q)(1)).subscribe(D=>{this._beforeClosed.next(J),this._beforeClosed.complete(),this._overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),D.totalTime+100)}),this._state=1,this._containerInstance._startExitAnimation()}afterOpened(){return this._afterOpened}afterClosed(){return this._afterClosed}beforeClosed(){return this._beforeClosed}backdropClick(){return this._overlayRef.backdropClick()}keydownEvents(){return this._overlayRef.keydownEvents()}updatePosition(J){let D=this._getPositionStrategy();return J&&(J.left||J.right)?J.left?D.left(J.left):D.right(J.right):D.centerHorizontally(),J&&(J.top||J.bottom)?J.top?D.top(J.top):D.bottom(J.bottom):D.centerVertically(),this._overlayRef.updatePosition(),this}updateSize(J="",D=""){return this._overlayRef.updateSize({width:J,height:D}),this._overlayRef.updatePosition(),this}addPanelClass(J){return this._overlayRef.addPanelClass(J),this}removePanelClass(J){return this._overlayRef.removePanelClass(J),this}getState(){return this._state}_finishDialogClose(){this._state=2,this._overlayRef.dispose()}_getPositionStrategy(){return this._overlayRef.getConfig().positionStrategy}}function T(j,J,D){return void 0!==j._containerInstance&&(j._containerInstance._closeInteractionType=J),j.close(D)}const ge=new g.OlP("MatDialogData"),re=new g.OlP("mat-dialog-default-options"),Mt=new g.OlP("mat-dialog-scroll-strategy"),Jn={provide:Mt,deps:[v.aV],useFactory:function Ut(j){return()=>j.scrollStrategies.block()}};let Pt=(()=>{class j{constructor(D,S,z,E,V,ue,be,$e,Bt,sn){this._overlay=D,this._injector=S,this._defaultOptions=z,this._parentDialog=E,this._overlayContainer=V,this._dialogRefConstructor=be,this._dialogContainerType=$e,this._dialogDataToken=Bt,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new U.x,this._afterOpenedAtThisLevel=new U.x,this._ariaHiddenElements=new Map,this.afterAllClosed=(0,Ie.P)(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe((0,Ee.O)(void 0))),this._scrollStrategy=ue}get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}_getAfterAllClosed(){const D=this._parentDialog;return D?D._getAfterAllClosed():this._afterAllClosedAtThisLevel}open(D,S){S=function Xn(j,J){return Object.assign(Object.assign({},J),j)}(S,this._defaultOptions||new k),S.id&&this.getDialogById(S.id);const z=this._createOverlay(S),E=this._attachDialogContainer(z,S),V=this._attachDialogContent(D,E,z,S);return this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(V),V.afterClosed().subscribe(()=>this._removeOpenDialog(V)),this.afterOpened.next(V),E._initializeWithAttachedContent(),V}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(D){return this.openDialogs.find(S=>S.id===D)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_createOverlay(D){const S=this._getOverlayConfig(D);return this._overlay.create(S)}_getOverlayConfig(D){const S=new v.X_({positionStrategy:this._overlay.position().global(),scrollStrategy:D.scrollStrategy||this._scrollStrategy(),panelClass:D.panelClass,hasBackdrop:D.hasBackdrop,direction:D.direction,minWidth:D.minWidth,minHeight:D.minHeight,maxWidth:D.maxWidth,maxHeight:D.maxHeight,disposeOnNavigation:D.closeOnNavigation});return D.backdropClass&&(S.backdropClass=D.backdropClass),S}_attachDialogContainer(D,S){const E=g.zs3.create({parent:S&&S.viewContainerRef&&S.viewContainerRef.injector||this._injector,providers:[{provide:k,useValue:S}]}),V=new N.C5(this._dialogContainerType,S.viewContainerRef,E,S.componentFactoryResolver);return D.attach(V).instance}_attachDialogContent(D,S,z,E){const V=new this._dialogRefConstructor(z,S,E.id);if(D instanceof g.Rgc)S.attachTemplatePortal(new N.UE(D,null,{$implicit:E.data,dialogRef:V}));else{const ue=this._createInjector(E,V,S),be=S.attachComponentPortal(new N.C5(D,E.viewContainerRef,ue,E.componentFactoryResolver));V.componentInstance=be.instance}return V.updateSize(E.width,E.height).updatePosition(E.position),V}_createInjector(D,S,z){const E=D&&D.viewContainerRef&&D.viewContainerRef.injector,V=[{provide:this._dialogContainerType,useValue:z},{provide:this._dialogDataToken,useValue:D.data},{provide:this._dialogRefConstructor,useValue:S}];return D.direction&&(!E||!E.get(he.Is,null,g.XFs.Optional))&&V.push({provide:he.Is,useValue:{value:D.direction,change:(0,ze.of)()}}),g.zs3.create({parent:E||this._injector,providers:V})}_removeOpenDialog(D){const S=this.openDialogs.indexOf(D);S>-1&&(this.openDialogs.splice(S,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((z,E)=>{z?E.setAttribute("aria-hidden",z):E.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),this._getAfterAllClosed().next()))}_hideNonDialogContentFromAssistiveTechnology(){const D=this._overlayContainer.getContainerElement();if(D.parentElement){const S=D.parentElement.children;for(let z=S.length-1;z>-1;z--){let E=S[z];E!==D&&"SCRIPT"!==E.nodeName&&"STYLE"!==E.nodeName&&!E.hasAttribute("aria-live")&&(this._ariaHiddenElements.set(E,E.getAttribute("aria-hidden")),E.setAttribute("aria-hidden","true"))}}}_closeDialogs(D){let S=D.length;for(;S--;)D[S].close()}}return j.\u0275fac=function(D){g.$Z()},j.\u0275dir=g.lG2({type:j}),j})(),Vt=(()=>{class j extends Pt{constructor(D,S,z,E,V,ue,be,$e){super(D,S,E,ue,be,V,$,Q,ge,$e)}}return j.\u0275fac=function(D){return new(D||j)(g.LFG(v.aV),g.LFG(g.zs3),g.LFG(oe.Ye,8),g.LFG(re,8),g.LFG(Mt),g.LFG(j,12),g.LFG(v.Xj),g.LFG(l.Qb,8))},j.\u0275prov=g.Yz7({token:j,factory:j.\u0275fac}),j})(),ei=0,Lt=(()=>{class j{constructor(D,S,z){this._dialogRef=D,this._elementRef=S,this._dialog=z,this.id="mat-dialog-title-"+ei++}ngOnInit(){this._dialogRef||(this._dialogRef=function On(j,J){let D=j.nativeElement.parentElement;for(;D&&!D.classList.contains("mat-dialog-container");)D=D.parentElement;return D?J.find(S=>S.id===D.id):null}(this._elementRef,this._dialog.openDialogs)),this._dialogRef&&Promise.resolve().then(()=>{const D=this._dialogRef._containerInstance;D&&!D._ariaLabelledBy&&(D._ariaLabelledBy=this.id)})}}return j.\u0275fac=function(D){return new(D||j)(g.Y36($,8),g.Y36(g.SBq),g.Y36(Vt))},j.\u0275dir=g.lG2({type:j,selectors:[["","mat-dialog-title",""],["","matDialogTitle",""]],hostAttrs:[1,"mat-dialog-title"],hostVars:1,hostBindings:function(D,S){2&D&&g.Ikx("id",S.id)},inputs:{id:"id"},exportAs:["matDialogTitle"]}),j})(),Ze=(()=>{class j{}return j.\u0275fac=function(D){return new(D||j)},j.\u0275dir=g.lG2({type:j,selectors:[["","mat-dialog-content",""],["mat-dialog-content"],["","matDialogContent",""]],hostAttrs:[1,"mat-dialog-content"]}),j})(),dt=(()=>{class j{}return j.\u0275fac=function(D){return new(D||j)},j.\u0275mod=g.oAB({type:j}),j.\u0275inj=g.cJS({providers:[Vt,Jn],imports:[[v.U8,N.eL,de.BQ],de.BQ]}),j})()},2638:(Yt,Ke,R)=>{R.d(Ke,{JX:()=>j,Rh:()=>dt,SJ:()=>D,TM:()=>J});var v=R(8962),N=R(9808),g=R(5e3),de=R(508),he=R(3191),U=R(1159),Ie=R(7579),ze=R(4968),Se=R(6451),ve=R(9300),Ee=R(4004),Te=R(9718),oe=R(2722),me=R(1884),xe=R(5698),Be=R(8675),l=R(8372),te=R(1777),k=R(6360),P=R(8255),W=R(925),ae=R(226);const Q=["*"],qe=["content"];function $(S,z){if(1&S){const E=g.EpF();g.TgZ(0,"div",2),g.NdJ("click",function(){return g.CHM(E),g.oxw()._onBackdropClicked()}),g.qZA()}if(2&S){const E=g.oxw();g.ekj("mat-drawer-shown",E._isShowingBackdrop())}}function T(S,z){1&S&&(g.TgZ(0,"mat-drawer-content"),g.Hsn(1,2),g.qZA())}const ge=[[["mat-drawer"]],[["mat-drawer-content"]],"*"],re=["mat-drawer","mat-drawer-content","*"];function Mt(S,z){if(1&S){const E=g.EpF();g.TgZ(0,"div",2),g.NdJ("click",function(){return g.CHM(E),g.oxw()._onBackdropClicked()}),g.qZA()}if(2&S){const E=g.oxw();g.ekj("mat-drawer-shown",E._isShowingBackdrop())}}function Ve(S,z){1&S&&(g.TgZ(0,"mat-sidenav-content"),g.Hsn(1,2),g.qZA())}const Ut=[[["mat-sidenav"]],[["mat-sidenav-content"]],"*"],Jn=["mat-sidenav","mat-sidenav-content","*"],Vt={transformDrawer:(0,te.X$)("transform",[(0,te.SB)("open, open-instant",(0,te.oB)({transform:"none",visibility:"visible"})),(0,te.SB)("void",(0,te.oB)({"box-shadow":"none",visibility:"hidden"})),(0,te.eR)("void => open-instant",(0,te.jt)("0ms")),(0,te.eR)("void <=> open, open-instant => void",(0,te.jt)("400ms cubic-bezier(0.25, 0.8, 0.25, 1)"))])},ei=new g.OlP("MAT_DRAWER_DEFAULT_AUTOSIZE",{providedIn:"root",factory:function Lt(){return!1}}),We=new g.OlP("MAT_DRAWER_CONTAINER");let Ze=(()=>{class S extends v.PQ{constructor(E,V,ue,be,$e){super(ue,be,$e),this._changeDetectorRef=E,this._container=V}ngAfterContentInit(){this._container._contentMarginChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})}}return S.\u0275fac=function(E){return new(E||S)(g.Y36(g.sBO),g.Y36((0,g.Gpc)(()=>On)),g.Y36(g.SBq),g.Y36(v.mF),g.Y36(g.R0b))},S.\u0275cmp=g.Xpm({type:S,selectors:[["mat-drawer-content"]],hostAttrs:[1,"mat-drawer-content"],hostVars:4,hostBindings:function(E,V){2&E&&g.Udp("margin-left",V._container._contentMargins.left,"px")("margin-right",V._container._contentMargins.right,"px")},features:[g._Bn([{provide:v.PQ,useExisting:S}]),g.qOj],ngContentSelectors:Q,decls:1,vars:0,template:function(E,V){1&E&&(g.F$t(),g.Hsn(0))},encapsulation:2,changeDetection:0}),S})(),xt=(()=>{class S{constructor(E,V,ue,be,$e,Bt,sn,on){this._elementRef=E,this._focusTrapFactory=V,this._focusMonitor=ue,this._platform=be,this._ngZone=$e,this._interactivityChecker=Bt,this._doc=sn,this._container=on,this._elementFocusedBeforeDrawerWasOpened=null,this._enableAnimations=!1,this._position="start",this._mode="over",this._disableClose=!1,this._opened=!1,this._animationStarted=new Ie.x,this._animationEnd=new Ie.x,this._animationState="void",this.openedChange=new g.vpe(!0),this._openedStream=this.openedChange.pipe((0,ve.h)(Le=>Le),(0,Ee.U)(()=>{})),this.openedStart=this._animationStarted.pipe((0,ve.h)(Le=>Le.fromState!==Le.toState&&0===Le.toState.indexOf("open")),(0,Te.h)(void 0)),this._closedStream=this.openedChange.pipe((0,ve.h)(Le=>!Le),(0,Ee.U)(()=>{})),this.closedStart=this._animationStarted.pipe((0,ve.h)(Le=>Le.fromState!==Le.toState&&"void"===Le.toState),(0,Te.h)(void 0)),this._destroyed=new Ie.x,this.onPositionChanged=new g.vpe,this._modeChanged=new Ie.x,this.openedChange.subscribe(Le=>{Le?(this._doc&&(this._elementFocusedBeforeDrawerWasOpened=this._doc.activeElement),this._takeFocus()):this._isFocusWithinDrawer()&&this._restoreFocus(this._openedVia||"program")}),this._ngZone.runOutsideAngular(()=>{(0,ze.R)(this._elementRef.nativeElement,"keydown").pipe((0,ve.h)(Le=>Le.keyCode===U.hY&&!this.disableClose&&!(0,U.Vb)(Le)),(0,oe.R)(this._destroyed)).subscribe(Le=>this._ngZone.run(()=>{this.close(),Le.stopPropagation(),Le.preventDefault()}))}),this._animationEnd.pipe((0,me.x)((Le,an)=>Le.fromState===an.fromState&&Le.toState===an.toState)).subscribe(Le=>{const{fromState:an,toState:En}=Le;(0===En.indexOf("open")&&"void"===an||"void"===En&&0===an.indexOf("open"))&&this.openedChange.emit(this._opened)})}get position(){return this._position}set position(E){(E="end"===E?"end":"start")!==this._position&&(this._isAttached&&this._updatePositionInParent(E),this._position=E,this.onPositionChanged.emit())}get mode(){return this._mode}set mode(E){this._mode=E,this._updateFocusTrapState(),this._modeChanged.next()}get disableClose(){return this._disableClose}set disableClose(E){this._disableClose=(0,he.Ig)(E)}get autoFocus(){const E=this._autoFocus;return null==E?"side"===this.mode?"dialog":"first-tabbable":E}set autoFocus(E){("true"===E||"false"===E||null==E)&&(E=(0,he.Ig)(E)),this._autoFocus=E}get opened(){return this._opened}set opened(E){this.toggle((0,he.Ig)(E))}_forceFocus(E,V){this._interactivityChecker.isFocusable(E)||(E.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const ue=()=>{E.removeEventListener("blur",ue),E.removeEventListener("mousedown",ue),E.removeAttribute("tabindex")};E.addEventListener("blur",ue),E.addEventListener("mousedown",ue)})),E.focus(V)}_focusByCssSelector(E,V){let ue=this._elementRef.nativeElement.querySelector(E);ue&&this._forceFocus(ue,V)}_takeFocus(){if(!this._focusTrap)return;const E=this._elementRef.nativeElement;switch(this.autoFocus){case!1:case"dialog":return;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(V=>{!V&&"function"==typeof this._elementRef.nativeElement.focus&&E.focus()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this.autoFocus)}}_restoreFocus(E){"dialog"!==this.autoFocus&&(this._elementFocusedBeforeDrawerWasOpened?this._focusMonitor.focusVia(this._elementFocusedBeforeDrawerWasOpened,E):this._elementRef.nativeElement.blur(),this._elementFocusedBeforeDrawerWasOpened=null)}_isFocusWithinDrawer(){const E=this._doc.activeElement;return!!E&&this._elementRef.nativeElement.contains(E)}ngAfterViewInit(){this._isAttached=!0,this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._updateFocusTrapState(),"end"===this._position&&this._updatePositionInParent("end")}ngAfterContentChecked(){this._platform.isBrowser&&(this._enableAnimations=!0)}ngOnDestroy(){var E;this._focusTrap&&this._focusTrap.destroy(),null===(E=this._anchor)||void 0===E||E.remove(),this._anchor=null,this._animationStarted.complete(),this._animationEnd.complete(),this._modeChanged.complete(),this._destroyed.next(),this._destroyed.complete()}open(E){return this.toggle(!0,E)}close(){return this.toggle(!1)}_closeViaBackdropClick(){return this._setOpen(!1,!0,"mouse")}toggle(E=!this.opened,V){E&&V&&(this._openedVia=V);const ue=this._setOpen(E,!E&&this._isFocusWithinDrawer(),this._openedVia||"program");return E||(this._openedVia=null),ue}_setOpen(E,V,ue){return this._opened=E,E?this._animationState=this._enableAnimations?"open":"open-instant":(this._animationState="void",V&&this._restoreFocus(ue)),this._updateFocusTrapState(),new Promise(be=>{this.openedChange.pipe((0,xe.q)(1)).subscribe($e=>be($e?"open":"close"))})}_getWidth(){return this._elementRef.nativeElement&&this._elementRef.nativeElement.offsetWidth||0}_updateFocusTrapState(){this._focusTrap&&(this._focusTrap.enabled=this.opened&&"side"!==this.mode)}_updatePositionInParent(E){const V=this._elementRef.nativeElement,ue=V.parentNode;"end"===E?(this._anchor||(this._anchor=this._doc.createComment("mat-drawer-anchor"),ue.insertBefore(this._anchor,V)),ue.appendChild(V)):this._anchor&&this._anchor.parentNode.insertBefore(V,this._anchor)}}return S.\u0275fac=function(E){return new(E||S)(g.Y36(g.SBq),g.Y36(P.qV),g.Y36(P.tE),g.Y36(W.t4),g.Y36(g.R0b),g.Y36(P.ic),g.Y36(N.K0,8),g.Y36(We,8))},S.\u0275cmp=g.Xpm({type:S,selectors:[["mat-drawer"]],viewQuery:function(E,V){if(1&E&&g.Gf(qe,5),2&E){let ue;g.iGM(ue=g.CRH())&&(V._content=ue.first)}},hostAttrs:["tabIndex","-1",1,"mat-drawer"],hostVars:12,hostBindings:function(E,V){1&E&&g.WFA("@transform.start",function(be){return V._animationStarted.next(be)})("@transform.done",function(be){return V._animationEnd.next(be)}),2&E&&(g.uIk("align",null),g.d8E("@transform",V._animationState),g.ekj("mat-drawer-end","end"===V.position)("mat-drawer-over","over"===V.mode)("mat-drawer-push","push"===V.mode)("mat-drawer-side","side"===V.mode)("mat-drawer-opened",V.opened))},inputs:{position:"position",mode:"mode",disableClose:"disableClose",autoFocus:"autoFocus",opened:"opened"},outputs:{openedChange:"openedChange",_openedStream:"opened",openedStart:"openedStart",_closedStream:"closed",closedStart:"closedStart",onPositionChanged:"positionChanged"},exportAs:["matDrawer"],ngContentSelectors:Q,decls:3,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"],["content",""]],template:function(E,V){1&E&&(g.F$t(),g.TgZ(0,"div",0,1),g.Hsn(2),g.qZA())},directives:[v.PQ],encapsulation:2,data:{animation:[Vt.transformDrawer]},changeDetection:0}),S})(),On=(()=>{class S{constructor(E,V,ue,be,$e,Bt=!1,sn){this._dir=E,this._element=V,this._ngZone=ue,this._changeDetectorRef=be,this._animationMode=sn,this._drawers=new g.n_E,this.backdropClick=new g.vpe,this._destroyed=new Ie.x,this._doCheckSubject=new Ie.x,this._contentMargins={left:null,right:null},this._contentMarginChanges=new Ie.x,E&&E.change.pipe((0,oe.R)(this._destroyed)).subscribe(()=>{this._validateDrawers(),this.updateContentMargins()}),$e.change().pipe((0,oe.R)(this._destroyed)).subscribe(()=>this.updateContentMargins()),this._autosize=Bt}get start(){return this._start}get end(){return this._end}get autosize(){return this._autosize}set autosize(E){this._autosize=(0,he.Ig)(E)}get hasBackdrop(){return null==this._backdropOverride?!this._start||"side"!==this._start.mode||!this._end||"side"!==this._end.mode:this._backdropOverride}set hasBackdrop(E){this._backdropOverride=null==E?null:(0,he.Ig)(E)}get scrollable(){return this._userContent||this._content}ngAfterContentInit(){this._allDrawers.changes.pipe((0,Be.O)(this._allDrawers),(0,oe.R)(this._destroyed)).subscribe(E=>{this._drawers.reset(E.filter(V=>!V._container||V._container===this)),this._drawers.notifyOnChanges()}),this._drawers.changes.pipe((0,Be.O)(null)).subscribe(()=>{this._validateDrawers(),this._drawers.forEach(E=>{this._watchDrawerToggle(E),this._watchDrawerPosition(E),this._watchDrawerMode(E)}),(!this._drawers.length||this._isDrawerOpen(this._start)||this._isDrawerOpen(this._end))&&this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),this._ngZone.runOutsideAngular(()=>{this._doCheckSubject.pipe((0,l.b)(10),(0,oe.R)(this._destroyed)).subscribe(()=>this.updateContentMargins())})}ngOnDestroy(){this._contentMarginChanges.complete(),this._doCheckSubject.complete(),this._drawers.destroy(),this._destroyed.next(),this._destroyed.complete()}open(){this._drawers.forEach(E=>E.open())}close(){this._drawers.forEach(E=>E.close())}updateContentMargins(){let E=0,V=0;if(this._left&&this._left.opened)if("side"==this._left.mode)E+=this._left._getWidth();else if("push"==this._left.mode){const ue=this._left._getWidth();E+=ue,V-=ue}if(this._right&&this._right.opened)if("side"==this._right.mode)V+=this._right._getWidth();else if("push"==this._right.mode){const ue=this._right._getWidth();V+=ue,E-=ue}E=E||null,V=V||null,(E!==this._contentMargins.left||V!==this._contentMargins.right)&&(this._contentMargins={left:E,right:V},this._ngZone.run(()=>this._contentMarginChanges.next(this._contentMargins)))}ngDoCheck(){this._autosize&&this._isPushed()&&this._ngZone.runOutsideAngular(()=>this._doCheckSubject.next())}_watchDrawerToggle(E){E._animationStarted.pipe((0,ve.h)(V=>V.fromState!==V.toState),(0,oe.R)(this._drawers.changes)).subscribe(V=>{"open-instant"!==V.toState&&"NoopAnimations"!==this._animationMode&&this._element.nativeElement.classList.add("mat-drawer-transition"),this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),"side"!==E.mode&&E.openedChange.pipe((0,oe.R)(this._drawers.changes)).subscribe(()=>this._setContainerClass(E.opened))}_watchDrawerPosition(E){!E||E.onPositionChanged.pipe((0,oe.R)(this._drawers.changes)).subscribe(()=>{this._ngZone.onMicrotaskEmpty.pipe((0,xe.q)(1)).subscribe(()=>{this._validateDrawers()})})}_watchDrawerMode(E){E&&E._modeChanged.pipe((0,oe.R)((0,Se.T)(this._drawers.changes,this._destroyed))).subscribe(()=>{this.updateContentMargins(),this._changeDetectorRef.markForCheck()})}_setContainerClass(E){const V=this._element.nativeElement.classList,ue="mat-drawer-container-has-open";E?V.add(ue):V.remove(ue)}_validateDrawers(){this._start=this._end=null,this._drawers.forEach(E=>{"end"==E.position?this._end=E:this._start=E}),this._right=this._left=null,this._dir&&"rtl"===this._dir.value?(this._left=this._end,this._right=this._start):(this._left=this._start,this._right=this._end)}_isPushed(){return this._isDrawerOpen(this._start)&&"over"!=this._start.mode||this._isDrawerOpen(this._end)&&"over"!=this._end.mode}_onBackdropClicked(){this.backdropClick.emit(),this._closeModalDrawersViaBackdrop()}_closeModalDrawersViaBackdrop(){[this._start,this._end].filter(E=>E&&!E.disableClose&&this._canHaveBackdrop(E)).forEach(E=>E._closeViaBackdropClick())}_isShowingBackdrop(){return this._isDrawerOpen(this._start)&&this._canHaveBackdrop(this._start)||this._isDrawerOpen(this._end)&&this._canHaveBackdrop(this._end)}_canHaveBackdrop(E){return"side"!==E.mode||!!this._backdropOverride}_isDrawerOpen(E){return null!=E&&E.opened}}return S.\u0275fac=function(E){return new(E||S)(g.Y36(ae.Is,8),g.Y36(g.SBq),g.Y36(g.R0b),g.Y36(g.sBO),g.Y36(v.rL),g.Y36(ei),g.Y36(k.Qb,8))},S.\u0275cmp=g.Xpm({type:S,selectors:[["mat-drawer-container"]],contentQueries:function(E,V,ue){if(1&E&&(g.Suo(ue,Ze,5),g.Suo(ue,xt,5)),2&E){let be;g.iGM(be=g.CRH())&&(V._content=be.first),g.iGM(be=g.CRH())&&(V._allDrawers=be)}},viewQuery:function(E,V){if(1&E&&g.Gf(Ze,5),2&E){let ue;g.iGM(ue=g.CRH())&&(V._userContent=ue.first)}},hostAttrs:[1,"mat-drawer-container"],hostVars:2,hostBindings:function(E,V){2&E&&g.ekj("mat-drawer-container-explicit-backdrop",V._backdropOverride)},inputs:{autosize:"autosize",hasBackdrop:"hasBackdrop"},outputs:{backdropClick:"backdropClick"},exportAs:["matDrawerContainer"],features:[g._Bn([{provide:We,useExisting:S}])],ngContentSelectors:re,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(E,V){1&E&&(g.F$t(ge),g.YNc(0,$,1,2,"div",0),g.Hsn(1),g.Hsn(2,1),g.YNc(3,T,2,0,"mat-drawer-content",1)),2&E&&(g.Q6J("ngIf",V.hasBackdrop),g.xp6(3),g.Q6J("ngIf",!V._content))},directives:[Ze,N.O5],styles:['.mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer[style*="visibility: hidden"]{display:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}\n'],encapsulation:2,changeDetection:0}),S})(),dt=(()=>{class S extends Ze{constructor(E,V,ue,be,$e){super(E,V,ue,be,$e)}}return S.\u0275fac=function(E){return new(E||S)(g.Y36(g.sBO),g.Y36((0,g.Gpc)(()=>J)),g.Y36(g.SBq),g.Y36(v.mF),g.Y36(g.R0b))},S.\u0275cmp=g.Xpm({type:S,selectors:[["mat-sidenav-content"]],hostAttrs:[1,"mat-drawer-content","mat-sidenav-content"],hostVars:4,hostBindings:function(E,V){2&E&&g.Udp("margin-left",V._container._contentMargins.left,"px")("margin-right",V._container._contentMargins.right,"px")},features:[g._Bn([{provide:v.PQ,useExisting:S}]),g.qOj],ngContentSelectors:Q,decls:1,vars:0,template:function(E,V){1&E&&(g.F$t(),g.Hsn(0))},encapsulation:2,changeDetection:0}),S})(),j=(()=>{class S extends xt{constructor(){super(...arguments),this._fixedInViewport=!1,this._fixedTopGap=0,this._fixedBottomGap=0}get fixedInViewport(){return this._fixedInViewport}set fixedInViewport(E){this._fixedInViewport=(0,he.Ig)(E)}get fixedTopGap(){return this._fixedTopGap}set fixedTopGap(E){this._fixedTopGap=(0,he.su)(E)}get fixedBottomGap(){return this._fixedBottomGap}set fixedBottomGap(E){this._fixedBottomGap=(0,he.su)(E)}}return S.\u0275fac=function(){let z;return function(V){return(z||(z=g.n5z(S)))(V||S)}}(),S.\u0275cmp=g.Xpm({type:S,selectors:[["mat-sidenav"]],hostAttrs:["tabIndex","-1",1,"mat-drawer","mat-sidenav"],hostVars:17,hostBindings:function(E,V){2&E&&(g.uIk("align",null),g.Udp("top",V.fixedInViewport?V.fixedTopGap:null,"px")("bottom",V.fixedInViewport?V.fixedBottomGap:null,"px"),g.ekj("mat-drawer-end","end"===V.position)("mat-drawer-over","over"===V.mode)("mat-drawer-push","push"===V.mode)("mat-drawer-side","side"===V.mode)("mat-drawer-opened",V.opened)("mat-sidenav-fixed",V.fixedInViewport))},inputs:{fixedInViewport:"fixedInViewport",fixedTopGap:"fixedTopGap",fixedBottomGap:"fixedBottomGap"},exportAs:["matSidenav"],features:[g.qOj],ngContentSelectors:Q,decls:3,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"],["content",""]],template:function(E,V){1&E&&(g.F$t(),g.TgZ(0,"div",0,1),g.Hsn(2),g.qZA())},directives:[v.PQ],encapsulation:2,data:{animation:[Vt.transformDrawer]},changeDetection:0}),S})(),J=(()=>{class S extends On{}return S.\u0275fac=function(){let z;return function(V){return(z||(z=g.n5z(S)))(V||S)}}(),S.\u0275cmp=g.Xpm({type:S,selectors:[["mat-sidenav-container"]],contentQueries:function(E,V,ue){if(1&E&&(g.Suo(ue,dt,5),g.Suo(ue,j,5)),2&E){let be;g.iGM(be=g.CRH())&&(V._content=be.first),g.iGM(be=g.CRH())&&(V._allDrawers=be)}},hostAttrs:[1,"mat-drawer-container","mat-sidenav-container"],hostVars:2,hostBindings:function(E,V){2&E&&g.ekj("mat-drawer-container-explicit-backdrop",V._backdropOverride)},exportAs:["matSidenavContainer"],features:[g._Bn([{provide:We,useExisting:S}]),g.qOj],ngContentSelectors:Jn,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(E,V){1&E&&(g.F$t(Ut),g.YNc(0,Mt,1,2,"div",0),g.Hsn(1),g.Hsn(2,1),g.YNc(3,Ve,2,0,"mat-sidenav-content",1)),2&E&&(g.Q6J("ngIf",V.hasBackdrop),g.xp6(3),g.Q6J("ngIf",!V._content))},directives:[dt,N.O5],styles:['.mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer[style*="visibility: hidden"]{display:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}\n'],encapsulation:2,changeDetection:0}),S})(),D=(()=>{class S{}return S.\u0275fac=function(E){return new(E||S)},S.\u0275mod=g.oAB({type:S}),S.\u0275inj=g.cJS({imports:[[N.ez,de.BQ,v.ZD],v.ZD,de.BQ]}),S})()},9169:(Yt,Ke,R)=>{R.r(Ke);var v=R(5861),N=R(3942),g=R(2090),de=R(9681),he=R(1877),U=R(655),Ie=R(4859);const xe=function oe(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}},Be=function me(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},l=new g.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),k=new he.Yd("@firebase/auth");function P(c,...o){k.logLevel<=he.in.ERROR&&k.error(`Auth (${de.SDK_VERSION}): ${c}`,...o)}function W(c,...o){throw $(c,...o)}function ae(c,...o){return $(c,...o)}function Q(c,o,a){const h=Object.assign(Object.assign({},Be()),{[o]:a});return new g.LL("auth","Firebase",h).create(o,{appName:c.name})}function qe(c,o,a){if(!(o instanceof a))throw a.name!==o.constructor.name&&W(c,"argument-error"),Q(c,"argument-error",`Type of ${o.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function $(c,...o){if("string"!=typeof c){const a=o[0],h=[...o.slice(1)];return h[0]&&(h[0].appName=c.name),c._errorFactory.create(a,...h)}return l.create(c,...o)}function T(c,o,...a){if(!c)throw $(o,...a)}function ge(c){const o="INTERNAL ASSERTION FAILED: "+c;throw P(o),new Error(o)}function re(c,o){c||ge(o)}const Mt=new Map;function Ve(c){re(c instanceof Function,"Expected a class definition");let o=Mt.get(c);return o?(re(o instanceof c,"Instance stored in cache mismatched with class"),o):(o=new c,Mt.set(c,o),o)}function Pt(){var c;return"undefined"!=typeof self&&(null===(c=self.location)||void 0===c?void 0:c.href)||""}function Vt(){return"http:"===Xn()||"https:"===Xn()}function Xn(){var c;return"undefined"!=typeof self&&(null===(c=self.location)||void 0===c?void 0:c.protocol)||null}class Lt{constructor(o,a){this.shortDelay=o,this.longDelay=a,re(a>o,"Short delay should be less than long delay!"),this.isMobile=(0,g.uI)()||(0,g.b$)()}get(){return function ei(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(Vt()||(0,g.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Ze(c,o){re(c.emulator,"Emulator should always be set here");const{url:a}=c.emulator;return o?`${a}${o.startsWith("/")?o.slice(1):o}`:a}class xt{static initialize(o,a,h){this.fetchImpl=o,a&&(this.headersImpl=a),h&&(this.responseImpl=h)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void ge("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void ge("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void ge("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const On={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},dt=new Lt(3e4,6e4);function j(c,o){return c.tenantId&&!o.tenantId?Object.assign(Object.assign({},o),{tenantId:c.tenantId}):o}function J(c,o,a,h){return D.apply(this,arguments)}function D(){return(D=(0,v.Z)(function*(c,o,a,h,p={}){return S(c,p,(0,v.Z)(function*(){let _={},A={};h&&("GET"===o?A=h:_={body:JSON.stringify(h)});const L=(0,g.xO)(Object.assign({key:c.config.apiKey},A)).slice(1),H=yield c._getAdditionalHeaders();return H["Content-Type"]="application/json",c.languageCode&&(H["X-Firebase-Locale"]=c.languageCode),xt.fetch()(ue(c,c.config.apiHost,a,L),Object.assign({method:o,headers:H,referrerPolicy:"no-referrer"},_))}))})).apply(this,arguments)}function S(c,o,a){return z.apply(this,arguments)}function z(){return(z=(0,v.Z)(function*(c,o,a){c._canInitEmulator=!1;const h=Object.assign(Object.assign({},On),o);try{const p=new be(c),_=yield Promise.race([a(),p.promise]);p.clearNetworkTimeout();const A=yield _.json();if("needConfirmation"in A)throw $e(c,"account-exists-with-different-credential",A);if(_.ok&&!("errorMessage"in A))return A;{const L=_.ok?A.errorMessage:A.error.message,[H,se]=L.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===H)throw $e(c,"credential-already-in-use",A);if("EMAIL_EXISTS"===H)throw $e(c,"email-already-in-use",A);if("USER_DISABLED"===H)throw $e(c,"user-disabled",A);const _e=h[H]||H.toLowerCase().replace(/[_\s]+/g,"-");if(se)throw Q(c,_e,se);W(c,_e)}}catch(p){if(p instanceof g.ZR)throw p;W(c,"network-request-failed")}})).apply(this,arguments)}function E(c,o,a,h){return V.apply(this,arguments)}function V(){return(V=(0,v.Z)(function*(c,o,a,h,p={}){const _=yield J(c,o,a,h,p);return"mfaPendingCredential"in _&&W(c,"multi-factor-auth-required",{_serverResponse:_}),_})).apply(this,arguments)}function ue(c,o,a,h){const p=`${o}${a}?${h}`;return c.config.emulator?Ze(c.config,p):`${c.config.apiScheme}://${p}`}class be{constructor(o){this.auth=o,this.timer=null,this.promise=new Promise((a,h)=>{this.timer=setTimeout(()=>h(ae(this.auth,"network-request-failed")),dt.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function $e(c,o,a){const h={appName:c.name};a.email&&(h.email=a.email),a.phoneNumber&&(h.phoneNumber=a.phoneNumber);const p=ae(c,o,h);return p.customData._tokenResponse=a,p}function sn(){return(sn=(0,v.Z)(function*(c,o){return J(c,"POST","/v1/accounts:delete",o)})).apply(this,arguments)}function on(c,o){return Le.apply(this,arguments)}function Le(){return(Le=(0,v.Z)(function*(c,o){return J(c,"POST","/v1/accounts:update",o)})).apply(this,arguments)}function an(c,o){return En.apply(this,arguments)}function En(){return(En=(0,v.Z)(function*(c,o){return J(c,"POST","/v1/accounts:lookup",o)})).apply(this,arguments)}function ti(c){if(c)try{const o=new Date(Number(c));if(!isNaN(o.getTime()))return o.toUTCString()}catch(o){}}function F(){return(F=(0,v.Z)(function*(c,o=!1){const a=(0,g.m9)(c),h=yield a.getIdToken(o),p=I(h);T(p&&p.exp&&p.auth_time&&p.iat,a.auth,"internal-error");const _="object"==typeof p.firebase?p.firebase:void 0,A=null==_?void 0:_.sign_in_provider;return{claims:p,token:h,authTime:ti(b(p.auth_time)),issuedAtTime:ti(b(p.iat)),expirationTime:ti(b(p.exp)),signInProvider:A||null,signInSecondFactor:(null==_?void 0:_.sign_in_second_factor)||null}})).apply(this,arguments)}function b(c){return 1e3*Number(c)}function I(c){const[o,a,h]=c.split(".");if(void 0===o||void 0===a||void 0===h)return P("JWT malformed, contained fewer than 3 sections"),null;try{const p=(0,g.tV)(a);return p?JSON.parse(p):(P("Failed to decode base64 JWT payload"),null)}catch(p){return P("Caught error parsing JWT payload as JSON",null==p?void 0:p.toString()),null}}function X(c,o){return ye.apply(this,arguments)}function ye(){return(ye=(0,v.Z)(function*(c,o,a=!1){if(a)return o;try{return yield o}catch(h){throw h instanceof g.ZR&&zt(h)&&c.auth.currentUser===c&&(yield c.auth.signOut()),h}})).apply(this,arguments)}function zt({code:c}){return"auth/user-disabled"===c||"auth/user-token-expired"===c}class Zl{constructor(o){this.user=o,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(o){var a;if(o){const h=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),h}{this.errorBackoff=3e4;const p=(null!==(a=this.user.stsTokenManager.expirationTime)&&void 0!==a?a:0)-Date.now()-3e5;return Math.max(0,p)}}schedule(o=!1){var a=this;if(!this.isRunning)return;const h=this.getInterval(o);this.timerId=setTimeout((0,v.Z)(function*(){yield a.iteration()}),h)}iteration(){var o=this;return(0,v.Z)(function*(){try{yield o.user.getIdToken(!0)}catch(a){return void("auth/network-request-failed"===(null==a?void 0:a.code)&&o.schedule(!0))}o.schedule()})()}}class Ci{constructor(o,a){this.createdAt=o,this.lastLoginAt=a,this._initializeTime()}_initializeTime(){this.lastSignInTime=ti(this.lastLoginAt),this.creationTime=ti(this.createdAt)}_copy(o){this.createdAt=o.createdAt,this.lastLoginAt=o.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function _r(c){return ni.apply(this,arguments)}function ni(){return(ni=(0,v.Z)(function*(c){var o;const a=c.auth,h=yield c.getIdToken(),p=yield X(c,an(a,{idToken:h}));T(null==p?void 0:p.users.length,a,"internal-error");const _=p.users[0];c._notifyReloadListener(_);const A=(null===(o=_.providerUserInfo)||void 0===o?void 0:o.length)?Ho(_.providerUserInfo):[],L=ys(c.providerData,A),_e=!!c.isAnonymous&&!(c.email&&_.passwordHash||(null==L?void 0:L.length)),pe={uid:_.localId,displayName:_.displayName||null,photoURL:_.photoUrl||null,email:_.email||null,emailVerified:_.emailVerified||!1,phoneNumber:_.phoneNumber||null,tenantId:_.tenantId||null,providerData:L,metadata:new Ci(_.createdAt,_.lastLoginAt),isAnonymous:_e};Object.assign(c,pe)})).apply(this,arguments)}function $o(){return($o=(0,v.Z)(function*(c){const o=(0,g.m9)(c);yield _r(o),yield o.auth._persistUserIfCurrent(o),o.auth._notifyListenersIfCurrent(o)})).apply(this,arguments)}function ys(c,o){return[...c.filter(h=>!o.some(p=>p.providerId===h.providerId)),...o]}function Ho(c){return c.map(o=>{var{providerId:a}=o,h=(0,U._T)(o,["providerId"]);return{providerId:a,uid:h.rawId||"",displayName:h.displayName||null,email:h.email||null,phoneNumber:h.phoneNumber||null,photoURL:h.photoUrl||null}})}function vs(){return(vs=(0,v.Z)(function*(c,o){const a=yield S(c,{},(0,v.Z)(function*(){const h=(0,g.xO)({grant_type:"refresh_token",refresh_token:o}).slice(1),{tokenApiHost:p,apiKey:_}=c.config,A=ue(c,p,"/v1/token",`key=${_}`),L=yield c._getAdditionalHeaders();return L["Content-Type"]="application/x-www-form-urlencoded",xt.fetch()(A,{method:"POST",headers:L,body:h})}));return{accessToken:a.access_token,expiresIn:a.expires_in,refreshToken:a.refresh_token}})).apply(this,arguments)}class Di{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(o){T(o.idToken,"internal-error"),T(void 0!==o.idToken,"internal-error"),T(void 0!==o.refreshToken,"internal-error");const a="expiresIn"in o&&void 0!==o.expiresIn?Number(o.expiresIn):function Z(c){const o=I(c);return T(o,"internal-error"),T(void 0!==o.exp,"internal-error"),T(void 0!==o.iat,"internal-error"),Number(o.exp)-Number(o.iat)}(o.idToken);this.updateTokensAndExpiration(o.idToken,o.refreshToken,a)}getToken(o,a=!1){var h=this;return(0,v.Z)(function*(){return T(!h.accessToken||h.refreshToken,o,"user-token-expired"),a||!h.accessToken||h.isExpired?h.refreshToken?(yield h.refresh(o,h.refreshToken),h.accessToken):null:h.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(o,a){var h=this;return(0,v.Z)(function*(){const{accessToken:p,refreshToken:_,expiresIn:A}=yield function Mu(c,o){return vs.apply(this,arguments)}(o,a);h.updateTokensAndExpiration(p,_,Number(A))})()}updateTokensAndExpiration(o,a,h){this.refreshToken=a||null,this.accessToken=o||null,this.expirationTime=Date.now()+1e3*h}static fromJSON(o,a){const{refreshToken:h,accessToken:p,expirationTime:_}=a,A=new Di;return h&&(T("string"==typeof h,"internal-error",{appName:o}),A.refreshToken=h),p&&(T("string"==typeof p,"internal-error",{appName:o}),A.accessToken=p),_&&(T("number"==typeof _,"internal-error",{appName:o}),A.expirationTime=_),A}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(o){this.accessToken=o.accessToken,this.refreshToken=o.refreshToken,this.expirationTime=o.expirationTime}_clone(){return Object.assign(new Di,this.toJSON())}_performRefresh(){return ge("not implemented")}}function Qt(c,o){T("string"==typeof c||void 0===c,"internal-error",{appName:o})}class Tn{constructor(o){var{uid:a,auth:h,stsTokenManager:p}=o,_=(0,U._T)(o,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Zl(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=a,this.auth=h,this.stsTokenManager=p,this.accessToken=p.accessToken,this.displayName=_.displayName||null,this.email=_.email||null,this.emailVerified=_.emailVerified||!1,this.phoneNumber=_.phoneNumber||null,this.photoURL=_.photoURL||null,this.isAnonymous=_.isAnonymous||!1,this.tenantId=_.tenantId||null,this.providerData=_.providerData?[..._.providerData]:[],this.metadata=new Ci(_.createdAt||void 0,_.lastLoginAt||void 0)}getIdToken(o){var a=this;return(0,v.Z)(function*(){const h=yield X(a,a.stsTokenManager.getToken(a.auth,o));return T(h,a.auth,"internal-error"),a.accessToken!==h&&(a.accessToken=h,yield a.auth._persistUserIfCurrent(a),a.auth._notifyListenersIfCurrent(a)),h})()}getIdTokenResult(o){return function x(c){return F.apply(this,arguments)}(this,o)}reload(){return function ql(c){return $o.apply(this,arguments)}(this)}_assign(o){this!==o&&(T(this.uid===o.uid,this.auth,"internal-error"),this.displayName=o.displayName,this.photoURL=o.photoURL,this.email=o.email,this.emailVerified=o.emailVerified,this.phoneNumber=o.phoneNumber,this.isAnonymous=o.isAnonymous,this.tenantId=o.tenantId,this.providerData=o.providerData.map(a=>Object.assign({},a)),this.metadata._copy(o.metadata),this.stsTokenManager._assign(o.stsTokenManager))}_clone(o){return new Tn(Object.assign(Object.assign({},this),{auth:o,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(o){T(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=o,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(o){this.reloadListener?this.reloadListener(o):this.reloadUserInfo=o}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(o,a=!1){var h=this;return(0,v.Z)(function*(){let p=!1;o.idToken&&o.idToken!==h.stsTokenManager.accessToken&&(h.stsTokenManager.updateFromServerResponse(o),p=!0),a&&(yield _r(h)),yield h.auth._persistUserIfCurrent(h),p&&h.auth._notifyListenersIfCurrent(h)})()}delete(){var o=this;return(0,v.Z)(function*(){const a=yield o.getIdToken();return yield X(o,function Bt(c,o){return sn.apply(this,arguments)}(o.auth,{idToken:a})),o.stsTokenManager.clearRefreshToken(),o.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(o=>Object.assign({},o)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(o,a){var h,p,_,A,L,H,se,_e;const pe=null!==(h=a.displayName)&&void 0!==h?h:void 0,ct=null!==(p=a.email)&&void 0!==p?p:void 0,rn=null!==(_=a.phoneNumber)&&void 0!==_?_:void 0,Co=null!==(A=a.photoURL)&&void 0!==A?A:void 0,Xc=null!==(L=a.tenantId)&&void 0!==L?L:void 0,Hn=null!==(H=a._redirectEventId)&&void 0!==H?H:void 0,Ei=null!==(se=a.createdAt)&&void 0!==se?se:void 0,ou=null!==(_e=a.lastLoginAt)&&void 0!==_e?_e:void 0,{uid:au,emailVerified:uu,isAnonymous:Et,providerData:cu,stsTokenManager:lu}=a;T(au&&lu,o,"internal-error");const bn=Di.fromJSON(this.name,lu);T("string"==typeof au,o,"internal-error"),Qt(pe,o.name),Qt(ct,o.name),T("boolean"==typeof uu,o,"internal-error"),T("boolean"==typeof Et,o,"internal-error"),Qt(rn,o.name),Qt(Co,o.name),Qt(Xc,o.name),Qt(Hn,o.name),Qt(Ei,o.name),Qt(ou,o.name);const Do=new Tn({uid:au,auth:o,email:ct,emailVerified:uu,displayName:pe,isAnonymous:Et,photoURL:Co,phoneNumber:rn,tenantId:Xc,stsTokenManager:bn,createdAt:Ei,lastLoginAt:ou});return cu&&Array.isArray(cu)&&(Do.providerData=cu.map(So=>Object.assign({},So))),Hn&&(Do._redirectEventId=Hn),Do}static _fromIdTokenResponse(o,a,h=!1){return(0,v.Z)(function*(){const p=new Di;p.updateFromServerResponse(a);const _=new Tn({uid:a.localId,auth:o,stsTokenManager:p,isAnonymous:h});return yield _r(_),_})()}}const Nn=(()=>{class c{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,v.Z)(function*(){return!0})()}_set(a,h){var p=this;return(0,v.Z)(function*(){p.storage[a]=h})()}_get(a){var h=this;return(0,v.Z)(function*(){const p=h.storage[a];return void 0===p?null:p})()}_remove(a){var h=this;return(0,v.Z)(function*(){delete h.storage[a]})()}_addListener(a,h){}_removeListener(a,h){}}return c.type="NONE",c})();function An(c,o,a){return`firebase:${c}:${o}:${a}`}class ii{constructor(o,a,h){this.persistence=o,this.auth=a,this.userKey=h;const{config:p,name:_}=this.auth;this.fullUserKey=An(this.userKey,p.apiKey,_),this.fullPersistenceKey=An("persistence",p.apiKey,_),this.boundEventHandler=a._onStorageEvent.bind(a),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(o){return this.persistence._set(this.fullUserKey,o.toJSON())}getCurrentUser(){var o=this;return(0,v.Z)(function*(){const a=yield o.persistence._get(o.fullUserKey);return a?Tn._fromJSON(o.auth,a):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(o){var a=this;return(0,v.Z)(function*(){if(a.persistence===o)return;const h=yield a.getCurrentUser();return yield a.removeCurrentUser(),a.persistence=o,h?a.setCurrentUser(h):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(o,a,h="authUser"){return(0,v.Z)(function*(){if(!a.length)return new ii(Ve(Nn),o,h);const p=(yield Promise.all(a.map(function(){var se=(0,v.Z)(function*(_e){if(yield _e._isAvailable())return _e});return function(_e){return se.apply(this,arguments)}}()))).filter(se=>se);let _=p[0]||Ve(Nn);const A=An(h,o.config.apiKey,o.name);let L=null;for(const se of a)try{const _e=yield se._get(A);if(_e){const pe=Tn._fromJSON(o,_e);se!==_&&(L=pe),_=se;break}}catch(_e){}const H=p.filter(se=>se._shouldAllowMigration);return _._shouldAllowMigration&&H.length?(_=H[0],L&&(yield _._set(A,L.toJSON())),yield Promise.all(a.map(function(){var se=(0,v.Z)(function*(_e){if(_e!==_)try{yield _e._remove(A)}catch(pe){}});return function(_e){return se.apply(this,arguments)}}())),new ii(_,o,h)):new ii(_,o,h)})()}}function Yo(c){const o=c.toLowerCase();if(o.includes("opera/")||o.includes("opr/")||o.includes("opios/"))return"Opera";if(bs(o))return"IEMobile";if(o.includes("msie")||o.includes("trident/"))return"IE";if(o.includes("edge/"))return"Edge";if(Lu(o))return"Firefox";if(o.includes("silk/"))return"Silk";if(Fu(o))return"Blackberry";if(ws(o))return"Webos";if(Is(o))return"Safari";if((o.includes("chrome/")||Qo(o))&&!o.includes("edge/"))return"Chrome";if(Si(o))return"Android";{const h=c.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===(null==h?void 0:h.length))return h[1]}return"Other"}function Lu(c=(0,g.z$)()){return/firefox\//i.test(c)}function Is(c=(0,g.z$)()){const o=c.toLowerCase();return o.includes("safari/")&&!o.includes("chrome/")&&!o.includes("crios/")&&!o.includes("android")}function Qo(c=(0,g.z$)()){return/crios\//i.test(c)}function bs(c=(0,g.z$)()){return/iemobile/i.test(c)}function Si(c=(0,g.z$)()){return/android/i.test(c)}function Fu(c=(0,g.z$)()){return/blackberry/i.test(c)}function ws(c=(0,g.z$)()){return/webos/i.test(c)}function Mn(c=(0,g.z$)()){return/iphone|ipad|ipod/i.test(c)||/macintosh/i.test(c)&&/mobile/i.test(c)}function yr(c=(0,g.z$)()){return Mn(c)||Si(c)||ws(c)||Fu(c)||/windows phone/i.test(c)||bs(c)}function Uu(c,o=[]){let a;switch(c){case"Browser":a=Yo((0,g.z$)());break;case"Worker":a=`${Yo((0,g.z$)())}-${c}`;break;default:a=c}const h=o.length?o.join(","):"FirebaseCore-web";return`${a}/JsCore/${de.SDK_VERSION}/${h}`}class Gl{constructor(o){this.auth=o,this.queue=[]}pushCallback(o,a){const h=_=>new Promise((A,L)=>{try{A(o(_))}catch(H){L(H)}});h.onAbort=a,this.queue.push(h);const p=this.queue.length-1;return()=>{this.queue[p]=()=>Promise.resolve()}}runMiddleware(o){var a=this;return(0,v.Z)(function*(){if(a.auth.currentUser===o)return;const h=[];try{for(const p of a.queue)yield p(o),p.onAbort&&h.push(p.onAbort)}catch(p){h.reverse();for(const _ of h)try{_()}catch(A){}throw a.auth._errorFactory.create("login-blocked",{originalMessage:null==p?void 0:p.message})}})()}}class Vu{constructor(o,a,h){this.app=o,this.heartbeatServiceProvider=a,this.config=h,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Bu(this),this.idTokenSubscription=new Bu(this),this.beforeStateQueue=new Gl(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=l,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=o.name,this.clientVersion=h.sdkClientVersion}_initializeWithPersistence(o,a){var h=this;return a&&(this._popupRedirectResolver=Ve(a)),this._initializationPromise=this.queue((0,v.Z)(function*(){var p,_;if(!h._deleted&&(h.persistenceManager=yield ii.create(h,o),!h._deleted)){if(null===(p=h._popupRedirectResolver)||void 0===p?void 0:p._shouldInitProactively)try{yield h._popupRedirectResolver._initialize(h)}catch(A){}yield h.initializeCurrentUser(a),h.lastNotifiedUid=(null===(_=h.currentUser)||void 0===_?void 0:_.uid)||null,!h._deleted&&(h._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var o=this;return(0,v.Z)(function*(){if(o._deleted)return;const a=yield o.assertedPersistence.getCurrentUser();if(o.currentUser||a){if(o.currentUser&&a&&o.currentUser.uid===a.uid)return o._currentUser._assign(a),void(yield o.currentUser.getIdToken());yield o._updateCurrentUser(a,!0)}})()}initializeCurrentUser(o){var a=this;return(0,v.Z)(function*(){var h;const p=yield a.assertedPersistence.getCurrentUser();let _=p,A=!1;if(o&&a.config.authDomain){yield a.getOrInitRedirectPersistenceManager();const L=null===(h=a.redirectUser)||void 0===h?void 0:h._redirectEventId,H=null==_?void 0:_._redirectEventId,se=yield a.tryRedirectSignIn(o);(!L||L===H)&&(null==se?void 0:se.user)&&(_=se.user,A=!0)}if(!_)return a.directlySetCurrentUser(null);if(!_._redirectEventId){if(A)try{yield a.beforeStateQueue.runMiddleware(_)}catch(L){_=p,a._popupRedirectResolver._overrideRedirectResult(a,()=>Promise.reject(L))}return _?a.reloadAndSetCurrentUserOrClear(_):a.directlySetCurrentUser(null)}return T(a._popupRedirectResolver,a,"argument-error"),yield a.getOrInitRedirectPersistenceManager(),a.redirectUser&&a.redirectUser._redirectEventId===_._redirectEventId?a.directlySetCurrentUser(_):a.reloadAndSetCurrentUserOrClear(_)})()}tryRedirectSignIn(o){var a=this;return(0,v.Z)(function*(){let h=null;try{h=yield a._popupRedirectResolver._completeRedirectFn(a,o,!0)}catch(p){yield a._setRedirectUser(null)}return h})()}reloadAndSetCurrentUserOrClear(o){var a=this;return(0,v.Z)(function*(){try{yield _r(o)}catch(h){if("auth/network-request-failed"!==(null==h?void 0:h.code))return a.directlySetCurrentUser(null)}return a.directlySetCurrentUser(o)})()}useDeviceLanguage(){this.languageCode=function We(){if("undefined"==typeof navigator)return null;const c=navigator;return c.languages&&c.languages[0]||c.language||null}()}_delete(){var o=this;return(0,v.Z)(function*(){o._deleted=!0})()}updateCurrentUser(o){var a=this;return(0,v.Z)(function*(){const h=o?(0,g.m9)(o):null;return h&&T(h.auth.config.apiKey===a.config.apiKey,a,"invalid-user-token"),a._updateCurrentUser(h&&h._clone(a))})()}_updateCurrentUser(o,a=!1){var h=this;return(0,v.Z)(function*(){if(!h._deleted)return o&&T(h.tenantId===o.tenantId,h,"tenant-id-mismatch"),a||(yield h.beforeStateQueue.runMiddleware(o)),h.queue((0,v.Z)(function*(){yield h.directlySetCurrentUser(o),h.notifyAuthListeners()}))})()}signOut(){var o=this;return(0,v.Z)(function*(){return yield o.beforeStateQueue.runMiddleware(null),(o.redirectPersistenceManager||o._popupRedirectResolver)&&(yield o._setRedirectUser(null)),o._updateCurrentUser(null,!0)})()}setPersistence(o){var a=this;return this.queue((0,v.Z)(function*(){yield a.assertedPersistence.setPersistence(Ve(o))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(o){this._errorFactory=new g.LL("auth","Firebase",o())}onAuthStateChanged(o,a,h){return this.registerStateListener(this.authStateSubscription,o,a,h)}beforeAuthStateChanged(o,a){return this.beforeStateQueue.pushCallback(o,a)}onIdTokenChanged(o,a,h){return this.registerStateListener(this.idTokenSubscription,o,a,h)}toJSON(){var o;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(o=this._currentUser)||void 0===o?void 0:o.toJSON()}}_setRedirectUser(o,a){var h=this;return(0,v.Z)(function*(){const p=yield h.getOrInitRedirectPersistenceManager(a);return null===o?p.removeCurrentUser():p.setCurrentUser(o)})()}getOrInitRedirectPersistenceManager(o){var a=this;return(0,v.Z)(function*(){if(!a.redirectPersistenceManager){const h=o&&Ve(o)||a._popupRedirectResolver;T(h,a,"argument-error"),a.redirectPersistenceManager=yield ii.create(a,[Ve(h._redirectPersistence)],"redirectUser"),a.redirectUser=yield a.redirectPersistenceManager.getCurrentUser()}return a.redirectPersistenceManager})()}_redirectUserForId(o){var a=this;return(0,v.Z)(function*(){var h,p;return a._isInitialized&&(yield a.queue((0,v.Z)(function*(){}))),(null===(h=a._currentUser)||void 0===h?void 0:h._redirectEventId)===o?a._currentUser:(null===(p=a.redirectUser)||void 0===p?void 0:p._redirectEventId)===o?a.redirectUser:null})()}_persistUserIfCurrent(o){var a=this;return(0,v.Z)(function*(){if(o===a.currentUser)return a.queue((0,v.Z)(function*(){return a.directlySetCurrentUser(o)}))})()}_notifyListenersIfCurrent(o){o===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var o,a;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const h=null!==(a=null===(o=this.currentUser)||void 0===o?void 0:o.uid)&&void 0!==a?a:null;this.lastNotifiedUid!==h&&(this.lastNotifiedUid=h,this.authStateSubscription.next(this.currentUser))}registerStateListener(o,a,h,p){if(this._deleted)return()=>{};const _="function"==typeof a?a:a.next.bind(a),A=this._isInitialized?Promise.resolve():this._initializationPromise;return T(A,this,"internal-error"),A.then(()=>_(this.currentUser)),"function"==typeof a?o.addObserver(a,h,p):o.addObserver(a)}directlySetCurrentUser(o){var a=this;return(0,v.Z)(function*(){a.currentUser&&a.currentUser!==o&&a._currentUser._stopProactiveRefresh(),o&&a.isProactiveRefreshEnabled&&o._startProactiveRefresh(),a.currentUser=o,o?yield a.assertedPersistence.setCurrentUser(o):yield a.assertedPersistence.removeCurrentUser()})()}queue(o){return this.operations=this.operations.then(o,o),this.operations}get assertedPersistence(){return T(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(o){!o||this.frameworks.includes(o)||(this.frameworks.push(o),this.frameworks.sort(),this.clientVersion=Uu(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var o=this;return(0,v.Z)(function*(){var a;const h={"X-Client-Version":o.clientVersion};o.app.options.appId&&(h["X-Firebase-gmpid"]=o.app.options.appId);const p=yield null===(a=o.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===a?void 0:a.getHeartbeatsHeader();return p&&(h["X-Firebase-Client"]=p),h})()}}function pt(c){return(0,g.m9)(c)}class Bu{constructor(o){this.auth=o,this.observer=null,this.addObserver=(0,g.ne)(a=>this.observer=a)}get next(){return T(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Es(c){const o=c.indexOf(":");return o<0?"":c.substr(0,o+1)}function Ts(c){if(!c)return null;const o=Number(c);return isNaN(o)?null:o}class Ri{constructor(o,a){this.providerId=o,this.signInMethod=a}toJSON(){return ge("not implemented")}_getIdTokenResponse(o){return ge("not implemented")}_linkToIdToken(o,a){return ge("not implemented")}_getReauthenticationResolver(o){return ge("not implemented")}}function vr(c,o){return Ir.apply(this,arguments)}function Ir(){return(Ir=(0,v.Z)(function*(c,o){return J(c,"POST","/v1/accounts:resetPassword",j(c,o))})).apply(this,arguments)}function As(c,o){return xs.apply(this,arguments)}function xs(){return(xs=(0,v.Z)(function*(c,o){return J(c,"POST","/v1/accounts:update",o)})).apply(this,arguments)}function Kl(c,o){return ri.apply(this,arguments)}function ri(){return(ri=(0,v.Z)(function*(c,o){return J(c,"POST","/v1/accounts:update",j(c,o))})).apply(this,arguments)}function ks(){return(ks=(0,v.Z)(function*(c,o){return E(c,"POST","/v1/accounts:signInWithPassword",j(c,o))})).apply(this,arguments)}function br(c,o){return Oi.apply(this,arguments)}function Oi(){return(Oi=(0,v.Z)(function*(c,o){return J(c,"POST","/v1/accounts:sendOobCode",j(c,o))})).apply(this,arguments)}function jl(c,o){return ta.apply(this,arguments)}function ta(){return(ta=(0,v.Z)(function*(c,o){return br(c,o)})).apply(this,arguments)}function Ni(c,o){return na.apply(this,arguments)}function na(){return(na=(0,v.Z)(function*(c,o){return br(c,o)})).apply(this,arguments)}function zl(c,o){return xn.apply(this,arguments)}function xn(){return(xn=(0,v.Z)(function*(c,o){return br(c,o)})).apply(this,arguments)}function Gu(c,o){return Mi.apply(this,arguments)}function Mi(){return(Mi=(0,v.Z)(function*(c,o){return br(c,o)})).apply(this,arguments)}function si(){return(si=(0,v.Z)(function*(c,o){return E(c,"POST","/v1/accounts:signInWithEmailLink",j(c,o))})).apply(this,arguments)}function yt(){return(yt=(0,v.Z)(function*(c,o){return E(c,"POST","/v1/accounts:signInWithEmailLink",j(c,o))})).apply(this,arguments)}class Pi extends Ri{constructor(o,a,h,p=null){super("password",h),this._email=o,this._password=a,this._tenantId=p}static _fromEmailAndPassword(o,a){return new Pi(o,a,"password")}static _fromEmailAndCode(o,a,h=null){return new Pi(o,a,"emailLink",h)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(o){const a="string"==typeof o?JSON.parse(o):o;if((null==a?void 0:a.email)&&(null==a?void 0:a.password)){if("password"===a.signInMethod)return this._fromEmailAndPassword(a.email,a.password);if("emailLink"===a.signInMethod)return this._fromEmailAndCode(a.email,a.password,a.tenantId)}return null}_getIdTokenResponse(o){var a=this;return(0,v.Z)(function*(){switch(a.signInMethod){case"password":return function qu(c,o){return ks.apply(this,arguments)}(o,{returnSecureToken:!0,email:a._email,password:a._password});case"emailLink":return function Wu(c,o){return si.apply(this,arguments)}(o,{email:a._email,oobCode:a._password});default:W(o,"internal-error")}})()}_linkToIdToken(o,a){var h=this;return(0,v.Z)(function*(){switch(h.signInMethod){case"password":return As(o,{idToken:a,returnSecureToken:!0,email:h._email,password:h._password});case"emailLink":return function Ku(c,o){return yt.apply(this,arguments)}(o,{idToken:a,email:h._email,oobCode:h._password});default:W(o,"internal-error")}})()}_getReauthenticationResolver(o){return this._getIdTokenResponse(o)}}function Zt(c,o){return Li.apply(this,arguments)}function Li(){return(Li=(0,v.Z)(function*(c,o){return E(c,"POST","/v1/accounts:signInWithIdp",j(c,o))})).apply(this,arguments)}class $t extends Ri{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(o){const a=new $t(o.providerId,o.signInMethod);return o.idToken||o.accessToken?(o.idToken&&(a.idToken=o.idToken),o.accessToken&&(a.accessToken=o.accessToken),o.nonce&&!o.pendingToken&&(a.nonce=o.nonce),o.pendingToken&&(a.pendingToken=o.pendingToken)):o.oauthToken&&o.oauthTokenSecret?(a.accessToken=o.oauthToken,a.secret=o.oauthTokenSecret):W("argument-error"),a}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(o){const a="string"==typeof o?JSON.parse(o):o,{providerId:h,signInMethod:p}=a,_=(0,U._T)(a,["providerId","signInMethod"]);if(!h||!p)return null;const A=new $t(h,p);return A.idToken=_.idToken||void 0,A.accessToken=_.accessToken||void 0,A.secret=_.secret,A.nonce=_.nonce,A.pendingToken=_.pendingToken||null,A}_getIdTokenResponse(o){return Zt(o,this.buildRequest())}_linkToIdToken(o,a){const h=this.buildRequest();return h.idToken=a,Zt(o,h)}_getReauthenticationResolver(o){const a=this.buildRequest();return a.autoCreate=!1,Zt(o,a)}buildRequest(){const o={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)o.pendingToken=this.pendingToken;else{const a={};this.idToken&&(a.id_token=this.idToken),this.accessToken&&(a.access_token=this.accessToken),this.secret&&(a.oauth_token_secret=this.secret),a.providerId=this.providerId,this.nonce&&!this.pendingToken&&(a.nonce=this.nonce),o.postBody=(0,g.xO)(a)}return o}}function zu(c,o){return Cs.apply(this,arguments)}function Cs(){return(Cs=(0,v.Z)(function*(c,o){return J(c,"POST","/v1/accounts:sendVerificationCode",j(c,o))})).apply(this,arguments)}function Er(){return(Er=(0,v.Z)(function*(c,o){return E(c,"POST","/v1/accounts:signInWithPhoneNumber",j(c,o))})).apply(this,arguments)}function Tr(){return(Tr=(0,v.Z)(function*(c,o){const a=yield E(c,"POST","/v1/accounts:signInWithPhoneNumber",j(c,o));if(a.temporaryProof)throw $e(c,"account-exists-with-different-credential",a);return a})).apply(this,arguments)}const Ds={USER_NOT_FOUND:"user-not-found"};function Ss(){return(Ss=(0,v.Z)(function*(c,o){return E(c,"POST","/v1/accounts:signInWithPhoneNumber",j(c,Object.assign(Object.assign({},o),{operation:"REAUTH"})),Ds)})).apply(this,arguments)}class oi extends Ri{constructor(o){super("phone","phone"),this.params=o}static _fromVerification(o,a){return new oi({verificationId:o,verificationCode:a})}static _fromTokenResponse(o,a){return new oi({phoneNumber:o,temporaryProof:a})}_getIdTokenResponse(o){return function wr(c,o){return Er.apply(this,arguments)}(o,this._makeVerificationRequest())}_linkToIdToken(o,a){return function ia(c,o){return Tr.apply(this,arguments)}(o,Object.assign({idToken:a},this._makeVerificationRequest()))}_getReauthenticationResolver(o){return function Ar(c,o){return Ss.apply(this,arguments)}(o,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:o,phoneNumber:a,verificationId:h,verificationCode:p}=this.params;return o&&a?{temporaryProof:o,phoneNumber:a}:{sessionInfo:h,code:p}}toJSON(){const o={providerId:this.providerId};return this.params.phoneNumber&&(o.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(o.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(o.verificationCode=this.params.verificationCode),this.params.verificationId&&(o.verificationId=this.params.verificationId),o}static fromJSON(o){"string"==typeof o&&(o=JSON.parse(o));const{verificationId:a,verificationCode:h,phoneNumber:p,temporaryProof:_}=o;return h||a||p||_?new oi({verificationId:a,verificationCode:h,phoneNumber:p,temporaryProof:_}):null}}class ai{constructor(o){var a,h,p,_,A,L;const H=(0,g.zd)((0,g.pd)(o)),se=null!==(a=H.apiKey)&&void 0!==a?a:null,_e=null!==(h=H.oobCode)&&void 0!==h?h:null,pe=function ra(c){switch(c){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(p=H.mode)&&void 0!==p?p:null);T(se&&_e&&pe,"argument-error"),this.apiKey=se,this.operation=pe,this.code=_e,this.continueUrl=null!==(_=H.continueUrl)&&void 0!==_?_:null,this.languageCode=null!==(A=H.languageCode)&&void 0!==A?A:null,this.tenantId=null!==(L=H.tenantId)&&void 0!==L?L:null}static parseLink(o){const a=function Rs(c){const o=(0,g.zd)((0,g.pd)(c)).link,a=o?(0,g.zd)((0,g.pd)(o)).deep_link_id:null,h=(0,g.zd)((0,g.pd)(c)).deep_link_id;return(h?(0,g.zd)((0,g.pd)(h)).link:null)||h||a||o||c}(o);try{return new ai(a)}catch(h){return null}}}let Os=(()=>{class c{constructor(){this.providerId=c.PROVIDER_ID}static credential(a,h){return Pi._fromEmailAndPassword(a,h)}static credentialWithLink(a,h){const p=ai.parseLink(h);return T(p,"argument-error"),Pi._fromEmailAndCode(a,p.code,p.tenantId)}}return c.PROVIDER_ID="password",c.EMAIL_PASSWORD_SIGN_IN_METHOD="password",c.EMAIL_LINK_SIGN_IN_METHOD="emailLink",c})();class un{constructor(o){this.providerId=o,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(o){this.defaultLanguageCode=o}setCustomParameters(o){return this.customParameters=o,this}getCustomParameters(){return this.customParameters}}class Fi extends un{constructor(){super(...arguments),this.scopes=[]}addScope(o){return this.scopes.includes(o)||this.scopes.push(o),this}getScopes(){return[...this.scopes]}}class cn extends Fi{static credentialFromJSON(o){const a="string"==typeof o?JSON.parse(o):o;return T("providerId"in a&&"signInMethod"in a,"argument-error"),$t._fromParams(a)}credential(o){return this._credential(Object.assign(Object.assign({},o),{nonce:o.rawNonce}))}_credential(o){return T(o.idToken||o.accessToken,"argument-error"),$t._fromParams(Object.assign(Object.assign({},o),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(o){return cn.oauthCredentialFromTaggedObject(o)}static credentialFromError(o){return cn.oauthCredentialFromTaggedObject(o.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:o}){if(!o)return null;const{oauthIdToken:a,oauthAccessToken:h,oauthTokenSecret:p,pendingToken:_,nonce:A,providerId:L}=o;if(!h&&!p&&!a&&!_||!L)return null;try{return new cn(L)._credential({idToken:a,accessToken:h,nonce:A,pendingToken:_})}catch(H){return null}}}let sa=(()=>{class c extends Fi{constructor(){super("facebook.com")}static credential(a){return $t._fromParams({providerId:c.PROVIDER_ID,signInMethod:c.FACEBOOK_SIGN_IN_METHOD,accessToken:a})}static credentialFromResult(a){return c.credentialFromTaggedObject(a)}static credentialFromError(a){return c.credentialFromTaggedObject(a.customData||{})}static credentialFromTaggedObject({_tokenResponse:a}){if(!a||!("oauthAccessToken"in a)||!a.oauthAccessToken)return null;try{return c.credential(a.oauthAccessToken)}catch(h){return null}}}return c.FACEBOOK_SIGN_IN_METHOD="facebook.com",c.PROVIDER_ID="facebook.com",c})(),xr=(()=>{class c extends Fi{constructor(){super("google.com"),this.addScope("profile")}static credential(a,h){return $t._fromParams({providerId:c.PROVIDER_ID,signInMethod:c.GOOGLE_SIGN_IN_METHOD,idToken:a,accessToken:h})}static credentialFromResult(a){return c.credentialFromTaggedObject(a)}static credentialFromError(a){return c.credentialFromTaggedObject(a.customData||{})}static credentialFromTaggedObject({_tokenResponse:a}){if(!a)return null;const{oauthIdToken:h,oauthAccessToken:p}=a;if(!h&&!p)return null;try{return c.credential(h,p)}catch(_){return null}}}return c.GOOGLE_SIGN_IN_METHOD="google.com",c.PROVIDER_ID="google.com",c})(),Ui=(()=>{class c extends Fi{constructor(){super("github.com")}static credential(a){return $t._fromParams({providerId:c.PROVIDER_ID,signInMethod:c.GITHUB_SIGN_IN_METHOD,accessToken:a})}static credentialFromResult(a){return c.credentialFromTaggedObject(a)}static credentialFromError(a){return c.credentialFromTaggedObject(a.customData||{})}static credentialFromTaggedObject({_tokenResponse:a}){if(!a||!("oauthAccessToken"in a)||!a.oauthAccessToken)return null;try{return c.credential(a.oauthAccessToken)}catch(h){return null}}}return c.GITHUB_SIGN_IN_METHOD="github.com",c.PROVIDER_ID="github.com",c})();class Pn extends Ri{constructor(o,a){super(o,o),this.pendingToken=a}_getIdTokenResponse(o){return Zt(o,this.buildRequest())}_linkToIdToken(o,a){const h=this.buildRequest();return h.idToken=a,Zt(o,h)}_getReauthenticationResolver(o){const a=this.buildRequest();return a.autoCreate=!1,Zt(o,a)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(o){const a="string"==typeof o?JSON.parse(o):o,{providerId:h,signInMethod:p,pendingToken:_}=a;return h&&p&&_&&h===p?new Pn(h,_):null}static _create(o,a){return new Pn(o,a)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class Ns extends un{constructor(o){T(o.startsWith("saml."),"argument-error"),super(o)}static credentialFromResult(o){return Ns.samlCredentialFromTaggedObject(o)}static credentialFromError(o){return Ns.samlCredentialFromTaggedObject(o.customData||{})}static credentialFromJSON(o){const a=Pn.fromJSON(o);return T(a,"argument-error"),a}static samlCredentialFromTaggedObject({_tokenResponse:o}){if(!o)return null;const{pendingToken:a,providerId:h}=o;if(!a||!h)return null;try{return Pn._create(h,a)}catch(p){return null}}}let oa=(()=>{class c extends Fi{constructor(){super("twitter.com")}static credential(a,h){return $t._fromParams({providerId:c.PROVIDER_ID,signInMethod:c.TWITTER_SIGN_IN_METHOD,oauthToken:a,oauthTokenSecret:h})}static credentialFromResult(a){return c.credentialFromTaggedObject(a)}static credentialFromError(a){return c.credentialFromTaggedObject(a.customData||{})}static credentialFromTaggedObject({_tokenResponse:a}){if(!a)return null;const{oauthAccessToken:h,oauthTokenSecret:p}=a;if(!h||!p)return null;try{return c.credential(h,p)}catch(_){return null}}}return c.TWITTER_SIGN_IN_METHOD="twitter.com",c.PROVIDER_ID="twitter.com",c})();function aa(c,o){return ua.apply(this,arguments)}function ua(){return(ua=(0,v.Z)(function*(c,o){return E(c,"POST","/v1/accounts:signUp",j(c,o))})).apply(this,arguments)}class mt{constructor(o){this.user=o.user,this.providerId=o.providerId,this._tokenResponse=o._tokenResponse,this.operationType=o.operationType}static _fromIdTokenResponse(o,a,h,p=!1){return(0,v.Z)(function*(){const _=yield Tn._fromIdTokenResponse(o,h,p),A=ln(h);return new mt({user:_,providerId:A,_tokenResponse:h,operationType:a})})()}static _forOperation(o,a,h){return(0,v.Z)(function*(){yield o._updateTokensIfNecessary(h,!0);const p=ln(h);return new mt({user:o,providerId:p,_tokenResponse:h,operationType:a})})()}}function ln(c){return c.providerId?c.providerId:"phoneNumber"in c?"phone":null}function Vi(){return(Vi=(0,v.Z)(function*(c){var o;const a=pt(c);if(yield a._initializationPromise,null===(o=a.currentUser)||void 0===o?void 0:o.isAnonymous)return new mt({user:a.currentUser,providerId:null,operationType:"signIn"});const h=yield aa(a,{returnSecureToken:!0}),p=yield mt._fromIdTokenResponse(a,"signIn",h,!0);return yield a._updateCurrentUser(p.user),p})).apply(this,arguments)}class kr extends g.ZR{constructor(o,a,h,p){var _;super(a.code,a.message),this.operationType=h,this.user=p,Object.setPrototypeOf(this,kr.prototype),this.customData={appName:o.name,tenantId:null!==(_=o.tenantId)&&void 0!==_?_:void 0,_serverResponse:a.customData._serverResponse,operationType:h}}static _fromErrorAndOperation(o,a,h,p){return new kr(o,a,h,p)}}function He(c,o,a,h){return("reauthenticate"===o?a._getReauthenticationResolver(c):a._getIdTokenResponse(c)).catch(_=>{throw"auth/multi-factor-auth-required"===_.code?kr._fromErrorAndOperation(c,_,o,h):_})}function Cr(c){return new Set(c.map(({providerId:o})=>o).filter(o=>!!o))}function ci(){return(ci=(0,v.Z)(function*(c,o){const a=(0,g.m9)(c);yield Ls(!0,a,o);const{providerUserInfo:h}=yield on(a.auth,{idToken:yield a.getIdToken(),deleteProvider:[o]}),p=Cr(h||[]);return a.providerData=a.providerData.filter(_=>p.has(_.providerId)),p.has("phone")||(a.phoneNumber=null),yield a.auth._persistUserIfCurrent(a),a})).apply(this,arguments)}function ca(c,o){return Ps.apply(this,arguments)}function Ps(){return(Ps=(0,v.Z)(function*(c,o,a=!1){const h=yield X(c,o._linkToIdToken(c.auth,yield c.getIdToken()),a);return mt._forOperation(c,"link",h)})).apply(this,arguments)}function Ls(c,o,a){return la.apply(this,arguments)}function la(){return(la=(0,v.Z)(function*(c,o,a){yield _r(o);const p=!1===c?"provider-already-linked":"no-such-provider";T(Cr(o.providerData).has(a)===c,o.auth,p)})).apply(this,arguments)}function $u(c,o){return ha.apply(this,arguments)}function ha(){return(ha=(0,v.Z)(function*(c,o,a=!1){const{auth:h}=c,p="reauthenticate";try{const _=yield X(c,He(h,p,o,c),a);T(_.idToken,h,"internal-error");const A=I(_.idToken);T(A,h,"internal-error");const{sub:L}=A;return T(c.uid===L,h,"user-mismatch"),mt._forOperation(c,p,_)}catch(_){throw"auth/user-not-found"===(null==_?void 0:_.code)&&W(h,"user-mismatch"),_}})).apply(this,arguments)}function Bi(c,o){return hn.apply(this,arguments)}function hn(){return(hn=(0,v.Z)(function*(c,o,a=!1){const h="signIn",p=yield He(c,h,o),_=yield mt._fromIdTokenResponse(c,h,p);return a||(yield c._updateCurrentUser(_.user)),_})).apply(this,arguments)}function Sr(c,o){return Fs.apply(this,arguments)}function Fs(){return(Fs=(0,v.Z)(function*(c,o){return Bi(pt(c),o)})).apply(this,arguments)}function da(c,o){return Ln.apply(this,arguments)}function Ln(){return(Ln=(0,v.Z)(function*(c,o){const a=(0,g.m9)(c);return yield Ls(!1,a,o.providerId),ca(a,o)})).apply(this,arguments)}function Hu(c,o){return fa.apply(this,arguments)}function fa(){return(fa=(0,v.Z)(function*(c,o){return $u((0,g.m9)(c),o)})).apply(this,arguments)}function Yu(c,o){return pa.apply(this,arguments)}function pa(){return(pa=(0,v.Z)(function*(c,o){return E(c,"POST","/v1/accounts:signInWithCustomToken",j(c,o))})).apply(this,arguments)}function Us(){return(Us=(0,v.Z)(function*(c,o){const a=pt(c),h=yield Yu(a,{token:o,returnSecureToken:!0}),p=yield mt._fromIdTokenResponse(a,"signIn",h);return yield a._updateCurrentUser(p.user),p})).apply(this,arguments)}class Zi{constructor(o,a){this.factorId=o,this.uid=a.mfaEnrollmentId,this.enrollmentTime=new Date(a.enrolledAt).toUTCString(),this.displayName=a.displayName}static _fromServerResponse(o,a){return"phoneInfo"in a?Rr._fromServerResponse(o,a):W(o,"internal-error")}}class Rr extends Zi{constructor(o){super("phone",o),this.phoneNumber=o.phoneInfo}static _fromServerResponse(o,a){return new Rr(a)}}function Or(c,o,a){var h;T((null===(h=a.url)||void 0===h?void 0:h.length)>0,c,"invalid-continue-uri"),T(void 0===a.dynamicLinkDomain||a.dynamicLinkDomain.length>0,c,"invalid-dynamic-link-domain"),o.continueUrl=a.url,o.dynamicLinkDomain=a.dynamicLinkDomain,o.canHandleCodeInApp=a.handleCodeInApp,a.iOS&&(T(a.iOS.bundleId.length>0,c,"missing-ios-bundle-id"),o.iOSBundleId=a.iOS.bundleId),a.android&&(T(a.android.packageName.length>0,c,"missing-android-pkg-name"),o.androidInstallApp=a.android.installApp,o.androidMinimumVersionCode=a.android.minimumVersion,o.androidPackageName=a.android.packageName)}function Nr(){return(Nr=(0,v.Z)(function*(c,o,a){const h=(0,g.m9)(c),p={requestType:"PASSWORD_RESET",email:o};a&&Or(h,p,a),yield Ni(h,p)})).apply(this,arguments)}function ma(){return(ma=(0,v.Z)(function*(c,o,a){yield vr((0,g.m9)(c),{oobCode:o,newPassword:a})})).apply(this,arguments)}function qi(){return(qi=(0,v.Z)(function*(c,o){yield Kl((0,g.m9)(c),{oobCode:o})})).apply(this,arguments)}function Gi(c,o){return Wi.apply(this,arguments)}function Wi(){return(Wi=(0,v.Z)(function*(c,o){const a=(0,g.m9)(c),h=yield vr(a,{oobCode:o}),p=h.requestType;switch(T(p,a,"internal-error"),p){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":T(h.newEmail,a,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":T(h.mfaInfo,a,"internal-error");default:T(h.email,a,"internal-error")}let _=null;return h.mfaInfo&&(_=Zi._fromServerResponse(pt(a),h.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===h.requestType?h.newEmail:h.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===h.requestType?h.email:h.newEmail)||null,multiFactorInfo:_},operation:p}})).apply(this,arguments)}function Vs(){return(Vs=(0,v.Z)(function*(c,o){const{data:a}=yield Gi((0,g.m9)(c),o);return a.email})).apply(this,arguments)}function li(){return(li=(0,v.Z)(function*(c,o,a){const h=pt(c),p=yield aa(h,{returnSecureToken:!0,email:o,password:a}),_=yield mt._fromIdTokenResponse(h,"signIn",p);return yield h._updateCurrentUser(_.user),_})).apply(this,arguments)}function Bs(){return(Bs=(0,v.Z)(function*(c,o,a){const h=(0,g.m9)(c),p={requestType:"EMAIL_SIGNIN",email:o};T(a.handleCodeInApp,h,"argument-error"),a&&Or(h,p,a),yield zl(h,p)})).apply(this,arguments)}function _a(){return(_a=(0,v.Z)(function*(c,o,a){const h=(0,g.m9)(c),p=Os.credentialWithLink(o,a||Pt());return T(p._tenantId===(h.tenantId||null),h,"tenant-id-mismatch"),Sr(h,p)})).apply(this,arguments)}function Xu(c,o){return Zs.apply(this,arguments)}function Zs(){return(Zs=(0,v.Z)(function*(c,o){return J(c,"POST","/v1/accounts:createAuthUri",j(c,o))})).apply(this,arguments)}function Ki(){return(Ki=(0,v.Z)(function*(c,o){const h={identifier:o,continueUri:Vt()?Pt():"http://localhost"},{signinMethods:p}=yield Xu((0,g.m9)(c),h);return p||[]})).apply(this,arguments)}function Jt(){return(Jt=(0,v.Z)(function*(c,o){const a=(0,g.m9)(c),p={requestType:"VERIFY_EMAIL",idToken:yield c.getIdToken()};o&&Or(a.auth,p,o);const{email:_}=yield jl(a.auth,p);_!==c.email&&(yield c.reload())})).apply(this,arguments)}function qs(){return(qs=(0,v.Z)(function*(c,o,a){const h=(0,g.m9)(c),_={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield c.getIdToken(),newEmail:o};a&&Or(h.auth,_,a);const{email:A}=yield Gu(h.auth,_);A!==c.email&&(yield c.reload())})).apply(this,arguments)}function ya(c,o){return hi.apply(this,arguments)}function hi(){return(hi=(0,v.Z)(function*(c,o){return J(c,"POST","/v1/accounts:update",o)})).apply(this,arguments)}function Pr(){return(Pr=(0,v.Z)(function*(c,{displayName:o,photoURL:a}){if(void 0===o&&void 0===a)return;const h=(0,g.m9)(c),_={idToken:yield h.getIdToken(),displayName:o,photoUrl:a,returnSecureToken:!0},A=yield X(h,ya(h.auth,_));h.displayName=A.displayName||null,h.photoURL=A.photoUrl||null;const L=h.providerData.find(({providerId:H})=>"password"===H);L&&(L.displayName=h.displayName,L.photoURL=h.photoURL),yield h._updateTokensIfNecessary(A)})).apply(this,arguments)}function Lr(c,o,a){return va.apply(this,arguments)}function va(){return(va=(0,v.Z)(function*(c,o,a){const{auth:h}=c,_={idToken:yield c.getIdToken(),returnSecureToken:!0};o&&(_.email=o),a&&(_.password=a);const A=yield X(c,As(h,_));yield c._updateTokensIfNecessary(A,!0)})).apply(this,arguments)}class dn{constructor(o,a,h={}){this.isNewUser=o,this.providerId=a,this.profile=h}}class Ia extends dn{constructor(o,a,h,p){super(o,a,h),this.username=p}}class oc extends dn{constructor(o,a){super(o,"facebook.com",a)}}class ba extends Ia{constructor(o,a){super(o,"github.com",a,"string"==typeof(null==a?void 0:a.login)?null==a?void 0:a.login:null)}}class wa extends dn{constructor(o,a){super(o,"google.com",a)}}class ac extends Ia{constructor(o,a,h){super(o,"twitter.com",a,h)}}function Ws(c){const{user:o,_tokenResponse:a}=c;return o.isAnonymous&&!a?{providerId:null,isNewUser:!1,profile:null}:function sc(c){var o,a;if(!c)return null;const{providerId:h}=c,p=c.rawUserInfo?JSON.parse(c.rawUserInfo):{},_=c.isNewUser||"identitytoolkit#SignupNewUserResponse"===c.kind;if(!h&&(null==c?void 0:c.idToken)){const A=null===(a=null===(o=I(c.idToken))||void 0===o?void 0:o.firebase)||void 0===a?void 0:a.sign_in_provider;if(A)return new dn(_,"anonymous"!==A&&"custom"!==A?A:null)}if(!h)return null;switch(h){case"facebook.com":return new oc(_,p);case"github.com":return new ba(_,p);case"google.com":return new wa(_,p);case"twitter.com":return new ac(_,p,c.screenName||null);case"custom":case"anonymous":return new dn(_,null);default:return new dn(_,h,p)}}(a)}class Fn{constructor(o,a,h){this.type=o,this.credential=a,this.auth=h}static _fromIdtoken(o,a){return new Fn("enroll",o,a)}static _fromMfaPendingCredential(o){return new Fn("signin",o)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(o){var a,h;if(null==o?void 0:o.multiFactorSession){if(null===(a=o.multiFactorSession)||void 0===a?void 0:a.pendingCredential)return Fn._fromMfaPendingCredential(o.multiFactorSession.pendingCredential);if(null===(h=o.multiFactorSession)||void 0===h?void 0:h.idToken)return Fn._fromIdtoken(o.multiFactorSession.idToken)}return null}}class Ks{constructor(o,a,h){this.session=o,this.hints=a,this.signInResolver=h}static _fromError(o,a){const h=pt(o),p=a.customData._serverResponse,_=(p.mfaInfo||[]).map(L=>Zi._fromServerResponse(h,L));T(p.mfaPendingCredential,h,"internal-error");const A=Fn._fromMfaPendingCredential(p.mfaPendingCredential);return new Ks(A,_,function(){var L=(0,v.Z)(function*(H){const se=yield H._process(h,A);delete p.mfaInfo,delete p.mfaPendingCredential;const _e=Object.assign(Object.assign({},p),{idToken:se.idToken,refreshToken:se.refreshToken});switch(a.operationType){case"signIn":const pe=yield mt._fromIdTokenResponse(h,a.operationType,_e);return yield h._updateCurrentUser(pe.user),pe;case"reauthenticate":return T(a.user,h,"internal-error"),mt._forOperation(a.user,a.operationType,_e);default:W(h,"internal-error")}});return function(H){return L.apply(this,arguments)}}())}resolveSignIn(o){var a=this;return(0,v.Z)(function*(){return a.signInResolver(o)})()}}function oh(c,o){return J(c,"POST","/v2/accounts/mfaEnrollment:start",j(c,o))}class Aa{constructor(o){this.user=o,this.enrolledFactors=[],o._onReload(a=>{a.mfaInfo&&(this.enrolledFactors=a.mfaInfo.map(h=>Zi._fromServerResponse(o.auth,h)))})}static _fromUser(o){return new Aa(o)}getSession(){var o=this;return(0,v.Z)(function*(){return Fn._fromIdtoken(yield o.user.getIdToken(),o.user.auth)})()}enroll(o,a){var h=this;return(0,v.Z)(function*(){const p=o,_=yield h.getSession(),A=yield X(h.user,p._process(h.user.auth,_,a));return yield h.user._updateTokensIfNecessary(A),h.user.reload()})()}unenroll(o){var a=this;return(0,v.Z)(function*(){const h="string"==typeof o?o:o.uid,p=yield a.user.getIdToken(),_=yield X(a.user,function Ta(c,o){return J(c,"POST","/v2/accounts/mfaEnrollment:withdraw",j(c,o))}(a.user.auth,{idToken:p,mfaEnrollmentId:h}));a.enrolledFactors=a.enrolledFactors.filter(({uid:A})=>A!==h),yield a.user._updateTokensIfNecessary(_);try{yield a.user.reload()}catch(A){if("auth/user-token-expired"!==(null==A?void 0:A.code))throw A}})()}}const xa=new WeakMap,js="__sak";class Fr{constructor(o,a){this.storageRetriever=o,this.type=a}_isAvailable(){try{return this.storage?(this.storage.setItem(js,"1"),this.storage.removeItem(js),Promise.resolve(!0)):Promise.resolve(!1)}catch(o){return Promise.resolve(!1)}}_set(o,a){return this.storage.setItem(o,JSON.stringify(a)),Promise.resolve()}_get(o){const a=this.storage.getItem(o);return Promise.resolve(a?JSON.parse(a):null)}_remove(o){return this.storage.removeItem(o),Promise.resolve()}get storage(){return this.storageRetriever()}}const Xt=(()=>{class c extends Fr{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(a,h)=>this.onStorageEvent(a,h),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function uh(){const c=(0,g.z$)();return Is(c)||Mn(c)}()&&function Xo(){try{return!(!window||window===window.top)}catch(c){return!1}}(),this.fallbackToPolling=yr(),this._shouldAllowMigration=!0}forAllChangedKeys(a){for(const h of Object.keys(this.listeners)){const p=this.storage.getItem(h),_=this.localCache[h];p!==_&&a(h,_,p)}}onStorageEvent(a,h=!1){if(!a.key)return void this.forAllChangedKeys((L,H,se)=>{this.notifyListeners(L,se)});const p=a.key;if(h?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const L=this.storage.getItem(p);if(a.newValue!==L)null!==a.newValue?this.storage.setItem(p,a.newValue):this.storage.removeItem(p);else if(this.localCache[p]===a.newValue&&!h)return}const _=()=>{const L=this.storage.getItem(p);!h&&this.localCache[p]===L||this.notifyListeners(p,L)},A=this.storage.getItem(p);!function _t(){return(0,g.w1)()&&10===document.documentMode}()||A===a.newValue||a.newValue===a.oldValue?_():setTimeout(_,10)}notifyListeners(a,h){this.localCache[a]=h;const p=this.listeners[a];if(p)for(const _ of Array.from(p))_(h&&JSON.parse(h))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((a,h,p)=>{this.onStorageEvent(new StorageEvent("storage",{key:a,oldValue:h,newValue:p}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(a,h){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[a]||(this.listeners[a]=new Set,this.localCache[a]=this.storage.getItem(a)),this.listeners[a].add(h)}_removeListener(a,h){this.listeners[a]&&(this.listeners[a].delete(h),0===this.listeners[a].size&&delete this.listeners[a]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(a,h){var p=()=>super._set,_=this;return(0,v.Z)(function*(){yield p().call(_,a,h),_.localCache[a]=JSON.stringify(h)})()}_get(a){var h=()=>super._get,p=this;return(0,v.Z)(function*(){const _=yield h().call(p,a);return p.localCache[a]=JSON.stringify(_),_})()}_remove(a){var h=()=>super._remove,p=this;return(0,v.Z)(function*(){yield h().call(p,a),delete p.localCache[a]})()}}return c.type="LOCAL",c})(),Un=(()=>{class c extends Fr{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(a,h){}_removeListener(a,h){}}return c.type="SESSION",c})();let ot=(()=>{class c{constructor(a){this.eventTarget=a,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(a){const h=this.receivers.find(_=>_.isListeningto(a));if(h)return h;const p=new c(a);return this.receivers.push(p),p}isListeningto(a){return this.eventTarget===a}handleEvent(a){var h=this;return(0,v.Z)(function*(){const p=a,{eventId:_,eventType:A,data:L}=p.data,H=h.handlersMap[A];if(!(null==H?void 0:H.size))return;p.ports[0].postMessage({status:"ack",eventId:_,eventType:A});const se=Array.from(H).map(function(){var pe=(0,v.Z)(function*(ct){return ct(p.origin,L)});return function(ct){return pe.apply(this,arguments)}}()),_e=yield function K(c){return Promise.all(c.map(function(){var o=(0,v.Z)(function*(a){try{return{fulfilled:!0,value:yield a}}catch(h){return{fulfilled:!1,reason:h}}});return function(a){return o.apply(this,arguments)}}()))}(se);p.ports[0].postMessage({status:"done",eventId:_,eventType:A,response:_e})})()}_subscribe(a,h){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[a]||(this.handlersMap[a]=new Set),this.handlersMap[a].add(h)}_unsubscribe(a,h){this.handlersMap[a]&&h&&this.handlersMap[a].delete(h),(!h||0===this.handlersMap[a].size)&&delete this.handlersMap[a],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return c.receivers=[],c})();function en(c="",o=10){let a="";for(let h=0;h<o;h++)a+=Math.floor(10*Math.random());return c+a}class ka{constructor(o){this.target=o,this.handlers=new Set}removeMessageHandler(o){o.messageChannel&&(o.messageChannel.port1.removeEventListener("message",o.onMessage),o.messageChannel.port1.close()),this.handlers.delete(o)}_send(o,a,h=50){var p=this;return(0,v.Z)(function*(){const _="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!_)throw new Error("connection_unavailable");let A,L;return new Promise((H,se)=>{const _e=en("",20);_.port1.start();const pe=setTimeout(()=>{se(new Error("unsupported_event"))},h);L={messageChannel:_,onMessage(ct){const rn=ct;if(rn.data.eventId===_e)switch(rn.data.status){case"ack":clearTimeout(pe),A=setTimeout(()=>{se(new Error("timeout"))},3e3);break;case"done":clearTimeout(A),H(rn.data.response);break;default:clearTimeout(pe),clearTimeout(A),se(new Error("invalid_response"))}}},p.handlers.add(L),_.port1.addEventListener("message",L.onMessage),p.target.postMessage({eventType:o,eventId:_e,data:a},[_.port2])}).finally(()=>{L&&p.removeMessageHandler(L)})})()}}function Y(){return window}function Ca(){return void 0!==Y().WorkerGlobalScope&&"function"==typeof Y().importScripts}function M(){return(M=(0,v.Z)(function*(){if(!(null==navigator?void 0:navigator.serviceWorker))return null;try{return(yield navigator.serviceWorker.ready).active}catch(c){return null}})).apply(this,arguments)}const Da="firebaseLocalStorageDb",zs="firebaseLocalStorage",dc="fbase_key";class Vr{constructor(o){this.request=o}toPromise(){return new Promise((o,a)=>{this.request.addEventListener("success",()=>{o(this.request.result)}),this.request.addEventListener("error",()=>{a(this.request.error)})})}}function $s(c,o){return c.transaction([zs],o?"readwrite":"readonly").objectStore(zs)}function Sa(){const c=indexedDB.open(Da,1);return new Promise((o,a)=>{c.addEventListener("error",()=>{a(c.error)}),c.addEventListener("upgradeneeded",()=>{const h=c.result;try{h.createObjectStore(zs,{keyPath:dc})}catch(p){a(p)}}),c.addEventListener("success",(0,v.Z)(function*(){const h=c.result;h.objectStoreNames.contains(zs)?o(h):(h.close(),yield function fc(){const c=indexedDB.deleteDatabase(Da);return new Vr(c).toPromise()}(),o(yield Sa()))}))})}function lh(c,o,a){return Ra.apply(this,arguments)}function Ra(){return(Ra=(0,v.Z)(function*(c,o,a){const h=$s(c,!0).put({[dc]:o,value:a});return new Vr(h).toPromise()})).apply(this,arguments)}function we(){return(we=(0,v.Z)(function*(c,o){const a=$s(c,!1).get(o),h=yield new Vr(a).toPromise();return void 0===h?null:h.value})).apply(this,arguments)}function fi(c,o){const a=$s(c,!0).delete(o);return new Vr(a).toPromise()}const fn=(()=>{class c{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var a=this;return(0,v.Z)(function*(){return a.db||(a.db=yield Sa()),a.db})()}_withRetries(a){var h=this;return(0,v.Z)(function*(){let p=0;for(;;)try{const _=yield h._openDb();return yield a(_)}catch(_){if(p++>3)throw _;h.db&&(h.db.close(),h.db=void 0)}})()}initializeServiceWorkerMessaging(){var a=this;return(0,v.Z)(function*(){return Ca()?a.initializeReceiver():a.initializeSender()})()}initializeReceiver(){var a=this;return(0,v.Z)(function*(){a.receiver=ot._getInstance(function lt(){return Ca()?self:null}()),a.receiver._subscribe("keyChanged",function(){var h=(0,v.Z)(function*(p,_){return{keyProcessed:(yield a._poll()).includes(_.key)}});return function(p,_){return h.apply(this,arguments)}}()),a.receiver._subscribe("ping",function(){var h=(0,v.Z)(function*(p,_){return["keyChanged"]});return function(p,_){return h.apply(this,arguments)}}())})()}initializeSender(){var a=this;return(0,v.Z)(function*(){var h,p;if(a.activeServiceWorker=yield function ie(){return M.apply(this,arguments)}(),!a.activeServiceWorker)return;a.sender=new ka(a.activeServiceWorker);const _=yield a.sender._send("ping",{},800);!_||(null===(h=_[0])||void 0===h?void 0:h.fulfilled)&&(null===(p=_[0])||void 0===p?void 0:p.value.includes("keyChanged"))&&(a.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(a){var h=this;return(0,v.Z)(function*(){if(h.sender&&h.activeServiceWorker&&function q(){var c;return(null===(c=null==navigator?void 0:navigator.serviceWorker)||void 0===c?void 0:c.controller)||null}()===h.activeServiceWorker)try{yield h.sender._send("keyChanged",{key:a},h.serviceWorkerReceiverAvailable?800:50)}catch(p){}})()}_isAvailable(){return(0,v.Z)(function*(){try{if(!indexedDB)return!1;const a=yield Sa();return yield lh(a,js,"1"),yield fi(a,js),!0}catch(a){}return!1})()}_withPendingWrite(a){var h=this;return(0,v.Z)(function*(){h.pendingWrites++;try{yield a()}finally{h.pendingWrites--}})()}_set(a,h){var p=this;return(0,v.Z)(function*(){return p._withPendingWrite((0,v.Z)(function*(){return yield p._withRetries(_=>lh(_,a,h)),p.localCache[a]=h,p.notifyServiceWorker(a)}))})()}_get(a){var h=this;return(0,v.Z)(function*(){const p=yield h._withRetries(_=>function pc(c,o){return we.apply(this,arguments)}(_,a));return h.localCache[a]=p,p})()}_remove(a){var h=this;return(0,v.Z)(function*(){return h._withPendingWrite((0,v.Z)(function*(){return yield h._withRetries(p=>fi(p,a)),delete h.localCache[a],h.notifyServiceWorker(a)}))})()}_poll(){var a=this;return(0,v.Z)(function*(){const h=yield a._withRetries(A=>{const L=$s(A,!1).getAll();return new Vr(L).toPromise()});if(!h)return[];if(0!==a.pendingWrites)return[];const p=[],_=new Set;for(const{fbase_key:A,value:L}of h)_.add(A),JSON.stringify(a.localCache[A])!==JSON.stringify(L)&&(a.notifyListeners(A,L),p.push(A));for(const A of Object.keys(a.localCache))a.localCache[A]&&!_.has(A)&&(a.notifyListeners(A,null),p.push(A));return p})()}notifyListeners(a,h){this.localCache[a]=h;const p=this.listeners[a];if(p)for(const _ of Array.from(p))_(h)}startPolling(){var a=this;this.stopPolling(),this.pollTimer=setInterval((0,v.Z)(function*(){return a._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(a,h){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[a]||(this.listeners[a]=new Set,this._get(a)),this.listeners[a].add(h)}_removeListener(a,h){this.listeners[a]&&(this.listeners[a].delete(h),0===this.listeners[a].size&&delete this.listeners[a]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return c.type="LOCAL",c})();function Me(c,o){return J(c,"POST","/v2/accounts/mfaSignIn:start",j(c,o))}function ee(){return(ee=(0,v.Z)(function*(c){return(yield J(c,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function Ys(c){return new Promise((o,a)=>{const h=document.createElement("script");h.setAttribute("src",c),h.onload=o,h.onerror=p=>{const _=ae("internal-error");_.customData=p,a(_)},h.type="text/javascript",h.charset="UTF-8",function Hs(){var c,o;return null!==(o=null===(c=document.getElementsByTagName("head"))||void 0===c?void 0:c[0])&&void 0!==o?o:document}().appendChild(h)})}function Vn(c){return`__${c}${Math.floor(1e6*Math.random())}`}const Js=1e12;class Br{constructor(o){this.auth=o,this.counter=Js,this._widgets=new Map}render(o,a){const h=this.counter;return this._widgets.set(h,new gc(o,this.auth.name,a||{})),this.counter++,h}reset(o){var a;const h=o||Js;null===(a=this._widgets.get(h))||void 0===a||a.delete(),this._widgets.delete(h)}getResponse(o){var a;return(null===(a=this._widgets.get(o||Js))||void 0===a?void 0:a.getResponse())||""}execute(o){var a=this;return(0,v.Z)(function*(){var h;return null===(h=a._widgets.get(o||Js))||void 0===h||h.execute(),""})()}}class gc{constructor(o,a,h){this.params=h,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const p="string"==typeof o?document.getElementById(o):o;T(p,"argument-error",{appName:a}),this.container=p,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function _c(c){const o=[],a="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let h=0;h<c;h++)o.push(a.charAt(Math.floor(Math.random()*a.length)));return o.join("")}(50);const{callback:o,"expired-callback":a}=this.params;if(o)try{o(this.responseToken)}catch(h){}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,a)try{a()}catch(h){}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const Ct=Vn("rcb"),Oa=new Lt(3e4,6e4);class vc{constructor(){var o;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(null===(o=Y().grecaptcha)||void 0===o?void 0:o.render)}load(o,a=""){return T(function Bn(c){return c.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(c)}(a),o,"argument-error"),this.shouldResolveImmediately(a)?Promise.resolve(Y().grecaptcha):new Promise((h,p)=>{const _=Y().setTimeout(()=>{p(ae(o,"network-request-failed"))},Oa.get());Y()[Ct]=()=>{Y().clearTimeout(_),delete Y()[Ct];const L=Y().grecaptcha;if(!L)return void p(ae(o,"internal-error"));const H=L.render;L.render=(se,_e)=>{const pe=H(se,_e);return this.counter++,pe},this.hostLanguage=a,h(L)},Ys(`https://www.google.com/recaptcha/api.js??${(0,g.xO)({onload:Ct,render:"explicit",hl:a})}`).catch(()=>{clearTimeout(_),p(ae(o,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(o){var a;return!!(null===(a=Y().grecaptcha)||void 0===a?void 0:a.render)&&(o===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class Na{load(o){return(0,v.Z)(function*(){return new Br(o)})()}clearedOneInstance(){}}const O="recaptcha",Xs={theme:"light",type:"image"};class tn{constructor(o,a=Object.assign({},Xs),h){this.parameters=a,this.type=O,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=pt(h),this.isInvisible="invisible"===this.parameters.size,T("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment");const p="string"==typeof o?document.getElementById(o):o;T(p,this.auth,"argument-error"),this.container=p,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Na:new vc,this.validateStartingState()}verify(){var o=this;return(0,v.Z)(function*(){o.assertNotDestroyed();const a=yield o.render(),h=o.getAssertedRecaptcha();return h.getResponse(a)||new Promise(_=>{const A=L=>{!L||(o.tokenChangeListeners.delete(A),_(L))};o.tokenChangeListeners.add(A),o.isInvisible&&h.execute(a)})})()}render(){try{this.assertNotDestroyed()}catch(o){return Promise.reject(o)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(o=>{throw this.renderPromise=null,o})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(o=>{this.container.removeChild(o)})}validateStartingState(){T(!this.parameters.sitekey,this.auth,"argument-error"),T(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),T("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(o){return a=>{if(this.tokenChangeListeners.forEach(h=>h(a)),"function"==typeof o)o(a);else if("string"==typeof o){const h=Y()[o];"function"==typeof h&&h(a)}}}assertNotDestroyed(){T(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var o=this;return(0,v.Z)(function*(){if(yield o.init(),!o.widgetId){let a=o.container;if(!o.isInvisible){const h=document.createElement("div");a.appendChild(h),a=h}o.widgetId=o.getAssertedRecaptcha().render(a,o.parameters)}return o.widgetId})()}init(){var o=this;return(0,v.Z)(function*(){T(Vt()&&!Ca(),o.auth,"internal-error"),yield function fh(){let c=null;return new Promise(o=>{"complete"!==document.readyState?(c=()=>o(),window.addEventListener("load",c)):o()}).catch(o=>{throw c&&window.removeEventListener("load",c),o})}(),o.recaptcha=yield o._recaptchaLoader.load(o.auth,o.auth.languageCode||void 0);const a=yield function it(c){return ee.apply(this,arguments)}(o.auth);T(a,o.auth,"internal-error"),o.parameters.sitekey=a})()}getAssertedRecaptcha(){return T(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class pi{constructor(o,a){this.verificationId=o,this.onConfirmation=a}confirm(o){const a=oi._fromVerification(this.verificationId,o);return this.onConfirmation(a)}}function Ma(){return(Ma=(0,v.Z)(function*(c,o,a){const h=pt(c),p=yield to(h,o,(0,g.m9)(a));return new pi(p,_=>Sr(h,_))})).apply(this,arguments)}function eo(){return(eo=(0,v.Z)(function*(c,o,a){const h=(0,g.m9)(c);yield Ls(!1,h,"phone");const p=yield to(h.auth,o,(0,g.m9)(a));return new pi(p,_=>da(h,_))})).apply(this,arguments)}function La(){return(La=(0,v.Z)(function*(c,o,a){const h=(0,g.m9)(c),p=yield to(h.auth,o,(0,g.m9)(a));return new pi(p,_=>Hu(h,_))})).apply(this,arguments)}function to(c,o,a){return Dt.apply(this,arguments)}function Dt(){return(Dt=(0,v.Z)(function*(c,o,a){var h;const p=yield a.verify();try{let _;if(T("string"==typeof p,c,"argument-error"),T(a.type===O,c,"argument-error"),_="string"==typeof o?{phoneNumber:o}:o,"session"in _){const A=_.session;if("phoneNumber"in _)return T("enroll"===A.type,c,"internal-error"),(yield oh(c,{idToken:A.credential,phoneEnrollmentInfo:{phoneNumber:_.phoneNumber,recaptchaToken:p}})).phoneSessionInfo.sessionInfo;{T("signin"===A.type,c,"internal-error");const L=(null===(h=_.multiFactorHint)||void 0===h?void 0:h.uid)||_.multiFactorUid;return T(L,c,"missing-multi-factor-info"),(yield Me(c,{mfaPendingCredential:A.credential,mfaEnrollmentId:L,phoneSignInInfo:{recaptchaToken:p}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:A}=yield zu(c,{phoneNumber:_.phoneNumber,recaptchaToken:p});return A}}finally{a._reset()}})).apply(this,arguments)}function pn(){return(pn=(0,v.Z)(function*(c,o){yield ca((0,g.m9)(c),o)})).apply(this,arguments)}let zi=(()=>{class c{constructor(a){this.providerId=c.PROVIDER_ID,this.auth=pt(a)}verifyPhoneNumber(a,h){return to(this.auth,a,(0,g.m9)(h))}static credential(a,h){return oi._fromVerification(a,h)}static credentialFromResult(a){return c.credentialFromTaggedObject(a)}static credentialFromError(a){return c.credentialFromTaggedObject(a.customData||{})}static credentialFromTaggedObject({_tokenResponse:a}){if(!a)return null;const{phoneNumber:h,temporaryProof:p}=a;return h&&p?oi._fromTokenResponse(h,p):null}}return c.PROVIDER_ID="phone",c.PHONE_SIGN_IN_METHOD="phone",c})();function qt(c,o){return o?Ve(o):(T(c._popupRedirectResolver,c,"argument-error"),c._popupRedirectResolver)}class no extends Ri{constructor(o){super("custom","custom"),this.params=o}_getIdTokenResponse(o){return Zt(o,this._buildIdpRequest())}_linkToIdToken(o,a){return Zt(o,this._buildIdpRequest(a))}_getReauthenticationResolver(o){return Zt(o,this._buildIdpRequest())}_buildIdpRequest(o){const a={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return o&&(a.idToken=o),a}}function Zr(c){return Bi(c.auth,new no(c),c.bypassAuthState)}function qr(c){const{auth:o,user:a}=c;return T(a,o,"internal-error"),$u(a,new no(c),c.bypassAuthState)}function Ic(c){return Fa.apply(this,arguments)}function Fa(){return(Fa=(0,v.Z)(function*(c){const{auth:o,user:a}=c;return T(a,o,"internal-error"),ca(a,new no(c),c.bypassAuthState)})).apply(this,arguments)}class at{constructor(o,a,h,p,_=!1){this.auth=o,this.resolver=h,this.user=p,this.bypassAuthState=_,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(a)?a:[a]}execute(){var o=this;return new Promise(function(){var a=(0,v.Z)(function*(h,p){o.pendingPromise={resolve:h,reject:p};try{o.eventManager=yield o.resolver._initialize(o.auth),yield o.onExecution(),o.eventManager.registerConsumer(o)}catch(_){o.reject(_)}});return function(h,p){return a.apply(this,arguments)}}())}onAuthEvent(o){var a=this;return(0,v.Z)(function*(){const{urlResponse:h,sessionId:p,postBody:_,tenantId:A,error:L,type:H}=o;if(L)return void a.reject(L);const se={auth:a.auth,requestUri:h,sessionId:p,tenantId:A||void 0,postBody:_||void 0,user:a.user,bypassAuthState:a.bypassAuthState};try{a.resolve(yield a.getIdpTask(H)(se))}catch(_e){a.reject(_e)}})()}onError(o){this.reject(o)}getIdpTask(o){switch(o){case"signInViaPopup":case"signInViaRedirect":return Zr;case"linkViaPopup":case"linkViaRedirect":return Ic;case"reauthViaPopup":case"reauthViaRedirect":return qr;default:W(this.auth,"internal-error")}}resolve(o){re(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(o),this.unregisterAndCleanUp()}reject(o){re(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(o),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const mh=new Lt(2e3,1e4);function Je(){return(Je=(0,v.Z)(function*(c,o,a){const h=pt(c);qe(c,o,un);const p=qt(h,a);return new mn(h,"signInViaPopup",o,p).executeNotNull()})).apply(this,arguments)}function Gr(){return(Gr=(0,v.Z)(function*(c,o,a){const h=(0,g.m9)(c);qe(h.auth,o,un);const p=qt(h.auth,a);return new mn(h.auth,"reauthViaPopup",o,p,h).executeNotNull()})).apply(this,arguments)}function _i(){return(_i=(0,v.Z)(function*(c,o,a){const h=(0,g.m9)(c);qe(h.auth,o,un);const p=qt(h.auth,a);return new mn(h.auth,"linkViaPopup",o,p,h).executeNotNull()})).apply(this,arguments)}let mn=(()=>{class c extends at{constructor(a,h,p,_,A){super(a,h,_,A),this.provider=p,this.authWindow=null,this.pollId=null,c.currentPopupAction&&c.currentPopupAction.cancel(),c.currentPopupAction=this}executeNotNull(){var a=this;return(0,v.Z)(function*(){const h=yield a.execute();return T(h,a.auth,"internal-error"),h})()}onExecution(){var a=this;return(0,v.Z)(function*(){re(1===a.filter.length,"Popup operations only handle one event");const h=en();a.authWindow=yield a.resolver._openPopup(a.auth,a.provider,a.filter[0],h),a.authWindow.associatedEvent=h,a.resolver._originValidation(a.auth).catch(p=>{a.reject(p)}),a.resolver._isIframeWebStorageSupported(a.auth,p=>{p||a.reject(ae(a.auth,"web-storage-unsupported"))}),a.pollUserCancellation()})()}get eventId(){var a;return(null===(a=this.authWindow)||void 0===a?void 0:a.associatedEvent)||null}cancel(){this.reject(ae(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,c.currentPopupAction=null}pollUserCancellation(){const a=()=>{var h,p;this.pollId=(null===(p=null===(h=this.authWindow)||void 0===h?void 0:h.window)||void 0===p?void 0:p.closed)?window.setTimeout(()=>{this.pollId=null,this.reject(ae(this.auth,"popup-closed-by-user"))},2e3):window.setTimeout(a,mh.get())};a()}}return c.currentPopupAction=null,c})();const nn=new Map;class gn extends at{constructor(o,a,h=!1){super(o,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],a,void 0,h),this.eventId=null}execute(){var o=()=>super.execute,a=this;return(0,v.Z)(function*(){let h=nn.get(a.auth._key());if(!h){try{const _=(yield function Wr(c,o){return _n.apply(this,arguments)}(a.resolver,a.auth))?yield o().call(a):null;h=()=>Promise.resolve(_)}catch(p){h=()=>Promise.reject(p)}nn.set(a.auth._key(),h)}return a.bypassAuthState||nn.set(a.auth._key(),()=>Promise.resolve(null)),h()})()}onAuthEvent(o){var a=()=>super.onAuthEvent,h=this;return(0,v.Z)(function*(){if("signInViaRedirect"===o.type)return a().call(h,o);if("unknown"!==o.type){if(o.eventId){const p=yield h.auth._redirectUserForId(o.eventId);if(p)return h.user=p,a().call(h,o);h.resolve(null)}}else h.resolve(null)})()}onExecution(){return(0,v.Z)(function*(){})()}cleanUp(){}}function _n(){return(_n=(0,v.Z)(function*(c,o){const a=$i(o),h=so(c);if(!(yield h._isAvailable()))return!1;const p="true"===(yield h._get(a));return yield h._remove(a),p})).apply(this,arguments)}function ro(c,o){return Gn.apply(this,arguments)}function Gn(){return(Gn=(0,v.Z)(function*(c,o){return so(c)._set($i(o),"true")})).apply(this,arguments)}function kn(c,o){nn.set(c._key(),o)}function so(c){return Ve(c._redirectPersistence)}function $i(c){return An("pendingRedirect",c.config.apiKey,c.name)}function Hi(){return(Hi=(0,v.Z)(function*(c,o,a){const h=pt(c);qe(c,o,un);const p=qt(h,a);return yield ro(p,h),p._openRedirect(h,o,"signInViaRedirect")})).apply(this,arguments)}function Va(){return(Va=(0,v.Z)(function*(c,o,a){const h=(0,g.m9)(c);qe(h.auth,o,un);const p=qt(h.auth,a);yield ro(p,h.auth);const _=yield Re(h);return p._openRedirect(h.auth,o,"reauthViaRedirect",_)})).apply(this,arguments)}function oo(){return(oo=(0,v.Z)(function*(c,o,a){const h=(0,g.m9)(c);qe(h.auth,o,un);const p=qt(h.auth,a);yield Ls(!1,h,o.providerId),yield ro(p,h.auth);const _=yield Re(h);return p._openRedirect(h.auth,o,"linkViaRedirect",_)})).apply(this,arguments)}function ao(){return(ao=(0,v.Z)(function*(c,o){return yield pt(c)._initializationPromise,jr(c,o,!1)})).apply(this,arguments)}function jr(c,o){return uo.apply(this,arguments)}function uo(){return(uo=(0,v.Z)(function*(c,o,a=!1){const h=pt(c),p=qt(h,o),A=yield new gn(h,p,a).execute();return A&&!a&&(delete A.user._redirectEventId,yield h._persistUserIfCurrent(A.user),yield h._setRedirectUser(null,o)),A})).apply(this,arguments)}function Re(c){return Fe.apply(this,arguments)}function Fe(){return(Fe=(0,v.Z)(function*(c){const o=en(`${c.uid}:::`);return c._redirectEventId=o,yield c.auth._setRedirectUser(c),yield c.auth._persistUserIfCurrent(c),o})).apply(this,arguments)}class co{constructor(o){this.auth=o,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(o){this.consumers.add(o),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,o)&&(this.sendToConsumer(this.queuedRedirectEvent,o),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(o){this.consumers.delete(o)}onEvent(o){if(this.hasEventBeenHandled(o))return!1;let a=!1;return this.consumers.forEach(h=>{this.isEventForConsumer(o,h)&&(a=!0,this.sendToConsumer(o,h),this.saveEventToCache(o))}),this.hasHandledPotentialRedirect||!function xc(c){switch(c.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Za(c);default:return!1}}(o)||(this.hasHandledPotentialRedirect=!0,a||(this.queuedRedirectEvent=o,a=!0)),a}sendToConsumer(o,a){var h;if(o.error&&!Za(o)){const p=(null===(h=o.error.code)||void 0===h?void 0:h.split("auth/")[1])||"internal-error";a.onError(ae(this.auth,p))}else a.onAuthEvent(o)}isEventForConsumer(o,a){const h=null===a.eventId||!!o.eventId&&o.eventId===a.eventId;return a.filter.includes(o.type)&&h}hasEventBeenHandled(o){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ba(o))}saveEventToCache(o){this.cachedEventUids.add(Ba(o)),this.lastProcessedEventTime=Date.now()}}function Ba(c){return[c.type,c.eventId,c.sessionId,c.tenantId].filter(o=>o).join("-")}function Za({type:c,error:o}){return"unknown"===c&&"auth/no-auth-event"===(null==o?void 0:o.code)}function qa(c){return lo.apply(this,arguments)}function lo(){return(lo=(0,v.Z)(function*(c,o={}){return J(c,"GET","/v1/projects",o)})).apply(this,arguments)}const kc=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,_h=/^https?/;function Ga(){return(Ga=(0,v.Z)(function*(c){if(c.config.emulator)return;const{authorizedDomains:o}=yield qa(c);for(const a of o)try{if(Cc(a))return}catch(h){}W(c,"unauthorized-domain")})).apply(this,arguments)}function Cc(c){const o=Pt(),{protocol:a,hostname:h}=new URL(o);if(c.startsWith("chrome-extension://")){const A=new URL(c);return""===A.hostname&&""===h?"chrome-extension:"===a&&c.replace("chrome-extension://","")===o.replace("chrome-extension://",""):"chrome-extension:"===a&&A.hostname===h}if(!_h.test(a))return!1;if(kc.test(c))return h===c;const p=c.replace(/\./g,"\\.");return new RegExp("^(.+\\."+p+"|"+p+")$","i").test(h)}const vh=new Lt(3e4,6e4);function Wa(){const c=Y().___jsl;if(null==c?void 0:c.H)for(const o of Object.keys(c.H))if(c.H[o].r=c.H[o].r||[],c.H[o].L=c.H[o].L||[],c.H[o].r=[...c.H[o].L],c.CP)for(let a=0;a<c.CP.length;a++)c.CP[a]=null}let ho=null;function Qi(c){return ho=ho||function Ih(c){return new Promise((o,a)=>{var h,p,_;function A(){Wa(),gapi.load("gapi.iframes",{callback:()=>{o(gapi.iframes.getContext())},ontimeout:()=>{Wa(),a(ae(c,"network-request-failed"))},timeout:vh.get()})}if(null===(p=null===(h=Y().gapi)||void 0===h?void 0:h.iframes)||void 0===p?void 0:p.Iframe)o(gapi.iframes.getContext());else{if(!(null===(_=Y().gapi)||void 0===_?void 0:_.load)){const L=Vn("iframefcb");return Y()[L]=()=>{gapi.load?A():a(ae(c,"network-request-failed"))},Ys(`https://apis.google.com/js/api.js?onload=${L}`).catch(H=>a(H))}A()}}).catch(o=>{throw ho=null,o})}(c),ho}const bh=new Lt(5e3,15e3),vt={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Ge=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Dc(c){const o=c.config;T(o.authDomain,c,"auth-domain-config-required");const a=o.emulator?Ze(o,"emulator/auth/iframe"):`https://${c.config.authDomain}/__/auth/iframe`,h={apiKey:o.apiKey,appName:c.name,v:de.SDK_VERSION},p=Ge.get(c.config.apiHost);p&&(h.eid=p);const _=c._getFrameworks();return _.length&&(h.fw=_.join(",")),`${a}?${(0,g.xO)(h).slice(1)}`}function St(){return St=(0,v.Z)(function*(c){const o=yield Qi(c),a=Y().gapi;return T(a,c,"internal-error"),o.open({where:document.body,url:Dc(c),messageHandlersFilter:a.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:vt,dontclear:!0},h=>new Promise(function(){var p=(0,v.Z)(function*(_,A){yield h.restyle({setHideOnLeave:!1});const L=ae(c,"network-request-failed"),H=Y().setTimeout(()=>{A(L)},bh.get());function se(){Y().clearTimeout(H),_(h)}h.ping(se).then(se,()=>{A(L)})});return function(_,A){return p.apply(this,arguments)}}()))}),St.apply(this,arguments)}const It={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Kn{constructor(o){this.window=o,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(o){}}}function go(c,o,a,h,p,_){T(c.config.authDomain,c,"auth-domain-config-required"),T(c.config.apiKey,c,"invalid-api-key");const A={apiKey:c.config.apiKey,appName:c.name,authType:a,redirectUrl:h,v:de.SDK_VERSION,eventId:p};if(o instanceof un){o.setDefaultLanguage(c.languageCode),A.providerId=o.providerId||"",(0,g.xb)(o.getCustomParameters())||(A.customParameters=JSON.stringify(o.getCustomParameters()));for(const[H,se]of Object.entries(_||{}))A[H]=se}if(o instanceof Fi){const H=o.getScopes().filter(se=>""!==se);H.length>0&&(A.scopes=H.join(","))}c.tenantId&&(A.tid=c.tenantId);const L=A;for(const H of Object.keys(L))void 0===L[H]&&delete L[H];return`${function Cn({config:c}){return c.emulator?Ze(c,"emulator/auth/handler"):`https://${c.authDomain}/__/auth/handler`}(c)}?${(0,g.xO)(L).slice(1)}`}const _o="webStorageSupport";class er extends class za{constructor(o){this.factorId=o}_process(o,a,h){switch(a.type){case"enroll":return this._finalizeEnroll(o,a.credential,h);case"signin":return this._finalizeSignIn(o,a.credential);default:return ge("unexpected MultiFactorSessionType")}}}{constructor(o){super("phone"),this.credential=o}static _fromCredential(o){return new er(o)}_finalizeEnroll(o,a,h){return function ah(c,o){return J(c,"POST","/v2/accounts/mfaEnrollment:finalize",j(c,o))}(o,{idToken:a,displayName:h,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(o,a){return function hh(c,o){return J(c,"POST","/v2/accounts/mfaSignIn:finalize",j(c,o))}(o,{mfaPendingCredential:a,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let $a=(()=>{class c{constructor(){}static assertion(a){return er._fromCredential(a)}}return c.FACTOR_ID="phone",c})();var jn="@firebase/auth";class Ha{constructor(o){this.auth=o,this.internalListeners=new Map}getUid(){var o;return this.assertAuthConfigured(),(null===(o=this.auth.currentUser)||void 0===o?void 0:o.uid)||null}getToken(o){var a=this;return(0,v.Z)(function*(){return a.assertAuthConfigured(),yield a.auth._initializationPromise,a.auth.currentUser?{accessToken:yield a.auth.currentUser.getIdToken(o)}:null})()}addAuthTokenListener(o){if(this.assertAuthConfigured(),this.internalListeners.has(o))return;const a=this.auth.onIdTokenChanged(h=>{o((null==h?void 0:h.stsTokenManager.accessToken)||null)});this.internalListeners.set(o,a),this.updateProactiveRefresh()}removeAuthTokenListener(o){this.assertAuthConfigured();const a=this.internalListeners.get(o);!a||(this.internalListeners.delete(o),a(),this.updateProactiveRefresh())}assertAuthConfigured(){T(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function yi(){return window}function Io(){return(Io=(0,v.Z)(function*(c,o,a){var h;const{BuildInfo:p}=yi();re(o.sessionId,"AuthEvent did not contain a session ID");const _=yield Fc(o.sessionId),A={};return Mn()?A.ibi=p.packageName:Si()?A.apn=p.packageName:W(c,"operation-not-supported-in-this-environment"),p.displayName&&(A.appDisplayName=p.displayName),A.sessionId=_,go(c,a,o.type,void 0,null!==(h=o.eventId)&&void 0!==h?h:void 0,A)})).apply(this,arguments)}function Qa(){return(Qa=(0,v.Z)(function*(c){const{BuildInfo:o}=yi(),a={};Mn()?a.iosBundleId=o.packageName:Si()?a.androidPackageName=o.packageName:W(c,"operation-not-supported-in-this-environment"),yield qa(c,a)})).apply(this,arguments)}function zn(){return(zn=(0,v.Z)(function*(c,o,a){const{cordova:h}=yi();let p=()=>{};try{yield new Promise((_,A)=>{let L=null;function H(){var pe;_();const ct=null===(pe=h.plugins.browsertab)||void 0===pe?void 0:pe.close;"function"==typeof ct&&ct(),"function"==typeof(null==a?void 0:a.close)&&a.close()}function se(){L||(L=window.setTimeout(()=>{A(ae(c,"redirect-cancelled-by-user"))},2e3))}function _e(){"visible"===(null==document?void 0:document.visibilityState)&&se()}o.addPassiveListener(H),document.addEventListener("resume",se,!1),Si()&&document.addEventListener("visibilitychange",_e,!1),p=()=>{o.removePassiveListener(H),document.removeEventListener("resume",se,!1),document.removeEventListener("visibilitychange",_e,!1),L&&window.clearTimeout(L)}})}finally{p()}})).apply(this,arguments)}function Fc(c){return Dn.apply(this,arguments)}function Dn(){return(Dn=(0,v.Z)(function*(c){const o=Uc(c),a=yield crypto.subtle.digest("SHA-256",o);return Array.from(new Uint8Array(a)).map(p=>p.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}function Uc(c){if(re(/[0-9a-zA-Z]+/.test(c),"Can only convert alpha-numeric strings"),"undefined"!=typeof TextEncoder)return(new TextEncoder).encode(c);const o=new ArrayBuffer(c.length),a=new Uint8Array(o);for(let h=0;h<c.length;h++)a[h]=c.charCodeAt(h);return a}(0,g.Pz)("authIdTokenMaxAge"),function $r(c){(0,de._registerComponent)(new Ie.wA("auth",(o,{options:a})=>{const h=o.getProvider("app").getImmediate(),p=o.getProvider("heartbeat"),{apiKey:_,authDomain:A}=h.options;return((L,H)=>{T(_&&!_.includes(":"),"invalid-api-key",{appName:L.name}),T(!(null==A?void 0:A.includes(":")),"argument-error",{appName:L.name});const se={apiKey:_,authDomain:A,clientPlatform:c,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Uu(c)},_e=new Vu(L,H,se);return function Jn(c,o){const a=(null==o?void 0:o.persistence)||[],h=(Array.isArray(a)?a:[a]).map(Ve);(null==o?void 0:o.errorMap)&&c._updateErrorMap(o.errorMap),c._initializeWithPersistence(h,null==o?void 0:o.popupRedirectResolver)}(_e,a),_e})(h,p)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((o,a,h)=>{o.getProvider("auth-internal").initialize()})),(0,de._registerComponent)(new Ie.wA("auth-internal",o=>{const a=pt(o.getProvider("auth").getImmediate());return new Ha(a)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,de.registerVersion)(jn,"0.21.0",function yo(c){switch(c){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(c)),(0,de.registerVersion)(jn,"0.21.0","esm2017")}("Browser");class Vc extends co{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(o=>{this.resolveInialized=o})}addPassiveListener(o){this.passiveListeners.add(o)}removePassiveListener(o){this.passiveListeners.delete(o)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(o){return this.resolveInialized(),this.passiveListeners.forEach(a=>a(o)),super.onEvent(o)}initialized(){var o=this;return(0,v.Z)(function*(){yield o.initPromise})()}}function Zc(c){return Ja.apply(this,arguments)}function Ja(){return(Ja=(0,v.Z)(function*(c){const o=yield nr()._get(Eo(c));return o&&(yield nr()._remove(Eo(c))),o})).apply(this,arguments)}function wo(){const c=[],o="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let a=0;a<20;a++){const h=Math.floor(Math.random()*o.length);c.push(o.charAt(h))}return c.join("")}function nr(){return Ve(Xt)}function Eo(c){return An("authEvent",c.config.apiKey,c.name)}function To(c){if(!(null==c?void 0:c.includes("?")))return{};const[o,...a]=c.split("?");return(0,g.zd)(a.join("?"))}function Xa(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:ae("no-auth-event")}}function Qr(){var c;return(null===(c=null==self?void 0:self.location)||void 0===c?void 0:c.protocol)||null}function Ne(c=(0,g.z$)()){return!("file:"!==Qr()&&"ionic:"!==Qr()&&"capacitor:"!==Qr()||!c.toLowerCase().match(/iphone|ipad|ipod|android/))}function Rt(){try{const c=self.localStorage,o=en();if(c)return c.setItem(o,"1"),c.removeItem(o),!function xh(c=(0,g.z$)()){return function jc(){return(0,g.w1)()&&11===(null==document?void 0:document.documentMode)}()||function $n(c=(0,g.z$)()){return/Edge\/\d+/.test(c)}(c)}()||(0,g.hl)()}catch(c){return Ao()&&(0,g.hl)()}return!1}function Ao(){return"undefined"!=typeof global&&"WorkerGlobalScope"in global&&"importScripts"in global}function Ii(){return(function ut(){return"http:"===Qr()||"https:"===Qr()}()||(0,g.ru)()||Ne())&&!function Kc(){return(0,g.b$)()||(0,g.UG)()}()&&Rt()&&!Ao()}function tu(){return Ne()&&"undefined"!=typeof document}function xo(){return(xo=(0,v.Z)(function*(){return!!tu()&&new Promise(c=>{const o=setTimeout(()=>{c(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(o),c(!0)})})})).apply(this,arguments)}const Gt={LOCAL:"local",NONE:"none",SESSION:"session"},Xr=T,Ae="persistence";function sr(c){return bi.apply(this,arguments)}function bi(){return(bi=(0,v.Z)(function*(c){yield c._initializationPromise;const o=ts(),a=An(Ae,c.config.apiKey,c.name);o&&o.setItem(a,c._getPersistence())})).apply(this,arguments)}function ts(){var c;try{return(null===(c=function Jr(){return"undefined"!=typeof window?window:null}())||void 0===c?void 0:c.sessionStorage)||null}catch(o){return null}}const zc=T;class Rn{constructor(){this.browserResolver=Ve(class Xi{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Un,this._completeRedirectFn=jr,this._overrideRedirectResult=kn}_openPopup(o,a,h,p){var _=this;return(0,v.Z)(function*(){var A;re(null===(A=_.eventManagers[o._key()])||void 0===A?void 0:A.manager,"_initialize() not called before _openPopup()");const L=go(o,a,h,Pt(),p);return function zr(c,o,a,h=500,p=600){const _=Math.max((window.screen.availHeight-p)/2,0).toString(),A=Math.max((window.screen.availWidth-h)/2,0).toString();let L="";const H=Object.assign(Object.assign({},It),{width:h.toString(),height:p.toString(),top:_,left:A}),se=(0,g.z$)().toLowerCase();a&&(L=Qo(se)?"_blank":a),Lu(se)&&(o=o||"http://localhost",H.scrollbars="yes");const _e=Object.entries(H).reduce((ct,[rn,Co])=>`${ct}${rn}=${Co},`,"");if(function ft(c=(0,g.z$)()){var o;return Mn(c)&&!!(null===(o=window.navigator)||void 0===o?void 0:o.standalone)}(se)&&"_self"!==L)return function po(c,o){const a=document.createElement("a");a.href=c,a.target=o;const h=document.createEvent("MouseEvent");h.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),a.dispatchEvent(h)}(o||"",L),new Kn(null);const pe=window.open(o||"",L,_e);T(pe,c,"popup-blocked");try{pe.focus()}catch(ct){}return new Kn(pe)}(o,L,en())})()}_openRedirect(o,a,h,p){var _=this;return(0,v.Z)(function*(){return yield _._originValidation(o),function le(c){Y().location.href=c}(go(o,a,h,Pt(),p)),new Promise(()=>{})})()}_initialize(o){const a=o._key();if(this.eventManagers[a]){const{manager:p,promise:_}=this.eventManagers[a];return p?Promise.resolve(p):(re(_,"If manager is not set, promise should be"),_)}const h=this.initAndGetManager(o);return this.eventManagers[a]={promise:h},h.catch(()=>{delete this.eventManagers[a]}),h}initAndGetManager(o){var a=this;return(0,v.Z)(function*(){const h=yield function Ji(c){return St.apply(this,arguments)}(o),p=new co(o);return h.register("authEvent",_=>(T(null==_?void 0:_.authEvent,o,"invalid-auth-event"),{status:p.onEvent(_.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),a.eventManagers[o._key()]={manager:p},a.iframes[o._key()]=h,p})()}_isIframeWebStorageSupported(o,a){this.iframes[o._key()].send(_o,{type:_o},p=>{var _;const A=null===(_=null==p?void 0:p[0])||void 0===_?void 0:_[_o];void 0!==A&&a(!!A),W(o,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(o){const a=o._key();return this.originValidationPromises[a]||(this.originValidationPromises[a]=function yh(c){return Ga.apply(this,arguments)}(o)),this.originValidationPromises[a]}get _shouldInitProactively(){return yr()||Is()||Mn()}}),this.cordovaResolver=Ve(class ir{constructor(){this._redirectPersistence=Un,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=jr,this._overrideRedirectResult=kn}_initialize(o){var a=this;return(0,v.Z)(function*(){const h=o._key();let p=a.eventManagers.get(h);return p||(p=new Vc(o),a.eventManagers.set(h,p),a.attachCallbackListeners(o,p)),p})()}_openPopup(o){W(o,"operation-not-supported-in-this-environment")}_openRedirect(o,a,h,p){var _=this;return(0,v.Z)(function*(){!function vi(c){var o,a,h,p,_,A,L,H,se,_e;const pe=yi();T("function"==typeof(null===(o=null==pe?void 0:pe.universalLinks)||void 0===o?void 0:o.subscribe),c,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),T(void 0!==(null===(a=null==pe?void 0:pe.BuildInfo)||void 0===a?void 0:a.packageName),c,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),T("function"==typeof(null===(_=null===(p=null===(h=null==pe?void 0:pe.cordova)||void 0===h?void 0:h.plugins)||void 0===p?void 0:p.browsertab)||void 0===_?void 0:_.openUrl),c,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),T("function"==typeof(null===(H=null===(L=null===(A=null==pe?void 0:pe.cordova)||void 0===A?void 0:A.plugins)||void 0===L?void 0:L.browsertab)||void 0===H?void 0:H.isAvailable),c,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),T("function"==typeof(null===(_e=null===(se=null==pe?void 0:pe.cordova)||void 0===se?void 0:se.InAppBrowser)||void 0===_e?void 0:_e.open),c,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(o);const A=yield _._initialize(o);yield A.initialized(),A.resetRedirect(),function Ua(){nn.clear()}(),yield _._originValidation(o);const L=function Bc(c,o,a=null){return{type:o,eventId:a,urlResponse:null,sessionId:wo(),postBody:null,tenantId:c.tenantId,error:ae(c,"no-auth-event")}}(o,h,p);yield function Hr(c,o){return nr()._set(Eo(c),o)}(o,L);const H=yield function Pc(c,o,a){return Io.apply(this,arguments)}(o,L,a),se=yield function Th(c){const{cordova:o}=yi();return new Promise(a=>{o.plugins.browsertab.isAvailable(h=>{let p=null;h?o.plugins.browsertab.openUrl(c):p=o.InAppBrowser.open(c,function Jo(c=(0,g.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(c)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(c)}()?"_blank":"_system","location=yes"),a(p)})})}(H);return function Lc(c,o,a){return zn.apply(this,arguments)}(o,A,se)})()}_isIframeWebStorageSupported(o,a){throw new Error("Method not implemented.")}_originValidation(o){const a=o._key();return this.originValidationPromises[a]||(this.originValidationPromises[a]=function bo(c){return Qa.apply(this,arguments)}(o)),this.originValidationPromises[a]}attachCallbackListeners(o,a){const{universalLinks:h,handleOpenURL:p,BuildInfo:_}=yi(),A=setTimeout((0,v.Z)(function*(){yield Zc(o),a.onEvent(Xa())}),500),L=function(){var _e=(0,v.Z)(function*(pe){clearTimeout(A);const ct=yield Zc(o);let rn=null;ct&&(null==pe?void 0:pe.url)&&(rn=function Xe(c,o){var a,h;const p=function Yr(c){const o=To(c),a=o.link?decodeURIComponent(o.link):void 0,h=To(a).link,p=o.deep_link_id?decodeURIComponent(o.deep_link_id):void 0;return To(p).link||p||h||a||c}(o);if(p.includes("/__/auth/callback")){const _=To(p),A=_.firebaseError?function Ah(c){try{return JSON.parse(c)}catch(o){return null}}(decodeURIComponent(_.firebaseError)):null,L=null===(h=null===(a=null==A?void 0:A.code)||void 0===a?void 0:a.split("auth/"))||void 0===h?void 0:h[1],H=L?ae(L):null;return H?{type:c.type,eventId:c.eventId,tenantId:c.tenantId,error:H,urlResponse:null,sessionId:null,postBody:null}:{type:c.type,eventId:c.eventId,tenantId:c.tenantId,sessionId:c.sessionId,urlResponse:p,postBody:null}}return null}(ct,pe.url)),a.onEvent(rn||Xa())});return function(ct){return _e.apply(this,arguments)}}();void 0!==h&&"function"==typeof h.subscribe&&h.subscribe(null,L);const H=p,se=`${_.packageName.toLowerCase()}://`;yi().handleOpenURL=function(){var _e=(0,v.Z)(function*(pe){if(pe.toLowerCase().startsWith(se)&&L({url:pe}),"function"==typeof H)try{H(pe)}catch(ct){console.error(ct)}});return function(pe){return _e.apply(this,arguments)}}()}}),this.underlyingResolver=null,this._redirectPersistence=Un,this._completeRedirectFn=jr,this._overrideRedirectResult=kn}_initialize(o){var a=this;return(0,v.Z)(function*(){return yield a.selectUnderlyingResolver(),a.assertedUnderlyingResolver._initialize(o)})()}_openPopup(o,a,h,p){var _=this;return(0,v.Z)(function*(){return yield _.selectUnderlyingResolver(),_.assertedUnderlyingResolver._openPopup(o,a,h,p)})()}_openRedirect(o,a,h,p){var _=this;return(0,v.Z)(function*(){return yield _.selectUnderlyingResolver(),_.assertedUnderlyingResolver._openRedirect(o,a,h,p)})()}_isIframeWebStorageSupported(o,a){this.assertedUnderlyingResolver._isIframeWebStorageSupported(o,a)}_originValidation(o){return this.assertedUnderlyingResolver._originValidation(o)}get _shouldInitProactively(){return tu()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return zc(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var o=this;return(0,v.Z)(function*(){if(o.underlyingResolver)return;const a=yield function yn(){return xo.apply(this,arguments)}();o.underlyingResolver=a?o.cordovaResolver:o.browserResolver})()}}function nu(c){return c.unwrap()}function $c(c){return Yc(c)}function Yc(c){const{_tokenResponse:o}=c instanceof g.ZR?c.customData:c;if(!o)return null;if(!(c instanceof g.ZR)&&"temporaryProof"in o&&"phoneNumber"in o)return zi.credentialFromResult(c);const a=o.providerId;if(!a||"password"===a)return null;let h;switch(a){case"google.com":h=xr;break;case"facebook.com":h=sa;break;case"github.com":h=Ui;break;case"twitter.com":h=oa;break;default:const{oauthIdToken:p,oauthAccessToken:_,oauthTokenSecret:A,pendingToken:L,nonce:H}=o;return _||A||p||L?L?a.startsWith("saml.")?Pn._create(a,L):$t._fromParams({providerId:a,signInMethod:a,pendingToken:L,idToken:p,accessToken:_}):new cn(a).credential({idToken:p,accessToken:_,rawNonce:H}):null}return c instanceof g.ZR?h.credentialFromError(c):h.credentialFromResult(c)}function Ft(c,o){return o.catch(a=>{throw a instanceof g.ZR&&function Hc(c,o){var a;const h=null===(a=o.customData)||void 0===a?void 0:a._tokenResponse;if("auth/multi-factor-auth-required"===(null==o?void 0:o.code))o.resolver=new or(c,function ji(c,o){var a;const h=(0,g.m9)(c),p=o;return T(o.customData.operationType,h,"argument-error"),T(null===(a=p.customData._serverResponse)||void 0===a?void 0:a.mfaPendingCredential,h,"argument-error"),Ks._fromError(h,p)}(c,o));else if(h){const p=Yc(o),_=o;p&&(_.credential=p,_.tenantId=h.tenantId||void 0,_.email=h.email||void 0,_.phoneNumber=h.phoneNumber||void 0)}}(c,a),a}).then(a=>{const p=a.user;return{operationType:a.operationType,credential:$c(a),additionalUserInfo:Ws(a),user:vn.getOrCreate(p)}})}function iu(c,o){return ru.apply(this,arguments)}function ru(){return(ru=(0,v.Z)(function*(c,o){const a=yield o;return{verificationId:a.verificationId,confirm:h=>Ft(c,a.confirm(h))}})).apply(this,arguments)}class or{constructor(o,a){this.resolver=a,this.auth=function Ch(c){return c.wrapped()}(o)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(o){return Ft(nu(this.auth),this.resolver.resolveSignIn(o))}}class vn{constructor(o){this._delegate=o,this.multiFactor=function cc(c){const o=(0,g.m9)(c);return xa.has(o)||xa.set(o,Aa._fromUser(o)),xa.get(o)}(o)}static getOrCreate(o){return vn.USER_MAP.has(o)||vn.USER_MAP.set(o,new vn(o)),vn.USER_MAP.get(o)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(o){return this._delegate.getIdTokenResult(o)}getIdToken(o){return this._delegate.getIdToken(o)}linkAndRetrieveDataWithCredential(o){return this.linkWithCredential(o)}linkWithCredential(o){var a=this;return(0,v.Z)(function*(){return Ft(a.auth,da(a._delegate,o))})()}linkWithPhoneNumber(o,a){var h=this;return(0,v.Z)(function*(){return iu(h.auth,function mi(c,o,a){return eo.apply(this,arguments)}(h._delegate,o,a))})()}linkWithPopup(o){var a=this;return(0,v.Z)(function*(){return Ft(a.auth,function bc(c,o,a){return _i.apply(this,arguments)}(a._delegate,o,Rn))})()}linkWithRedirect(o){var a=this;return(0,v.Z)(function*(){return yield sr(pt(a.auth)),function gh(c,o,a){return function Ac(c,o,a){return oo.apply(this,arguments)}(c,o,a)}(a._delegate,o,Rn)})()}reauthenticateAndRetrieveDataWithCredential(o){return this.reauthenticateWithCredential(o)}reauthenticateWithCredential(o){var a=this;return(0,v.Z)(function*(){return Ft(a.auth,Hu(a._delegate,o))})()}reauthenticateWithPhoneNumber(o,a){return iu(this.auth,function Pa(c,o,a){return La.apply(this,arguments)}(this._delegate,o,a))}reauthenticateWithPopup(o){return Ft(this.auth,function gi(c,o,a){return Gr.apply(this,arguments)}(this._delegate,o,Rn))}reauthenticateWithRedirect(o){var a=this;return(0,v.Z)(function*(){return yield sr(pt(a.auth)),function Kr(c,o,a){return function Tc(c,o,a){return Va.apply(this,arguments)}(c,o,a)}(a._delegate,o,Rn)})()}sendEmailVerification(o){return function tc(c,o){return Jt.apply(this,arguments)}(this._delegate,o)}unlink(o){var a=this;return(0,v.Z)(function*(){return yield function Dr(c,o){return ci.apply(this,arguments)}(a._delegate,o),a})()}updateEmail(o){return function Gs(c,o){return Lr((0,g.m9)(c),o,null)}(this._delegate,o)}updatePassword(o){return function rc(c,o){return Lr((0,g.m9)(c),null,o)}(this._delegate,o)}updatePhoneNumber(o){return function ph(c,o){return pn.apply(this,arguments)}(this._delegate,o)}updateProfile(o){return function ic(c,o){return Pr.apply(this,arguments)}(this._delegate,o)}verifyBeforeUpdateEmail(o,a){return function nc(c,o,a){return qs.apply(this,arguments)}(this._delegate,o,a)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}vn.USER_MAP=new WeakMap;const ns=T;let st=(()=>{class c{constructor(a,h){if(this.app=a,h.isInitialized())return this._delegate=h.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:p}=a.options;ns(p,"invalid-api-key",{appName:a.name}),ns(p,"invalid-api-key",{appName:a.name});const _="undefined"!=typeof window?Rn:void 0;this._delegate=h.initialize({options:{persistence:Qc(p,a.name),popupRedirectResolver:_}}),this._delegate._updateErrorMap(xe),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?vn.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(a){this._delegate.languageCode=a}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(a){this._delegate.tenantId=a}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(a,h){!function ea(c,o,a){const h=pt(c);T(h._canInitEmulator,h,"emulator-config-failed"),T(/^https?:\/\//.test(o),h,"invalid-emulator-scheme");const p=!!(null==a?void 0:a.disableWarnings),_=Es(o),{host:A,port:L}=function Wl(c){const o=Es(c),a=/(\/\/)?([^?#/]+)/.exec(c.substr(o.length));if(!a)return{host:"",port:null};const h=a[2].split("@").pop()||"",p=/^(\[[^\]]+\])(:|$)/.exec(h);if(p){const _=p[1];return{host:_,port:Ts(h.substr(_.length+1))}}{const[_,A]=h.split(":");return{host:_,port:Ts(A)}}}(o);h.config.emulator={url:`${_}//${A}${null===L?"":`:${L}`}/`},h.settings.appVerificationDisabledForTesting=!0,h.emulatorConfig=Object.freeze({host:A,port:L,protocol:_.replace(":",""),options:Object.freeze({disableWarnings:p})}),p||function Zu(){function c(){const o=document.createElement("p"),a=o.style;o.innerText="Running in emulator mode. Do not use with production credentials.",a.position="fixed",a.width="100%",a.backgroundColor="#ffffff",a.border=".1em solid #000000",a.color="#b50000",a.bottom="0px",a.left="0px",a.margin="0px",a.zIndex="10000",a.textAlign="center",o.classList.add("firebase-emulator-warning"),document.body.appendChild(o)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",c):c())}()}(this._delegate,a,h)}applyActionCode(a){return function Ql(c,o){return qi.apply(this,arguments)}(this._delegate,a)}checkActionCode(a){return Gi(this._delegate,a)}confirmPasswordReset(a,h){return function Yl(c,o,a){return ma.apply(this,arguments)}(this._delegate,a,h)}createUserWithEmailAndPassword(a,h){var p=this;return(0,v.Z)(function*(){return Ft(p._delegate,function Mr(c,o,a){return li.apply(this,arguments)}(p._delegate,a,h))})()}fetchProvidersForEmail(a){return this.fetchSignInMethodsForEmail(a)}fetchSignInMethodsForEmail(a){return function ec(c,o){return Ki.apply(this,arguments)}(this._delegate,a)}isSignInWithEmailLink(a){return function Xl(c,o){const a=ai.parseLink(o);return"EMAIL_SIGNIN"===(null==a?void 0:a.operation)}(0,a)}getRedirectResult(){var a=this;return(0,v.Z)(function*(){ns(Ii(),a._delegate,"operation-not-supported-in-this-environment");const h=yield function Wn(c,o){return ao.apply(this,arguments)}(a._delegate,Rn);return h?Ft(a._delegate,Promise.resolve(h)):{credential:null,user:null}})()}addFrameworkForLogging(a){!function Gc(c,o){pt(c)._logFramework(o)}(this._delegate,a)}onAuthStateChanged(a,h,p){const{next:_,error:A,complete:L}=ko(a,h,p);return this._delegate.onAuthStateChanged(_,A,L)}onIdTokenChanged(a,h,p){const{next:_,error:A,complete:L}=ko(a,h,p);return this._delegate.onIdTokenChanged(_,A,L)}sendSignInLinkToEmail(a,h){return function nt(c,o,a){return Bs.apply(this,arguments)}(this._delegate,a,h)}sendPasswordResetEmail(a,h){return function Ju(c,o,a){return Nr.apply(this,arguments)}(this._delegate,a,h||void 0)}setPersistence(a){var h=this;return(0,v.Z)(function*(){let p;switch(function kh(c,o){Xr(Object.values(Gt).includes(o),c,"invalid-persistence-type"),(0,g.b$)()?Xr(o!==Gt.SESSION,c,"unsupported-persistence-type"):(0,g.UG)()?Xr(o===Gt.NONE,c,"unsupported-persistence-type"):Ao()?Xr(o===Gt.NONE||o===Gt.LOCAL&&(0,g.hl)(),c,"unsupported-persistence-type"):Xr(o===Gt.NONE||Rt(),c,"unsupported-persistence-type")}(h._delegate,a),a){case Gt.SESSION:p=Un;break;case Gt.LOCAL:p=(yield Ve(fn)._isAvailable())?fn:Xt;break;case Gt.NONE:p=Nn;break;default:return W("argument-error",{appName:h._delegate.name})}return h._delegate.setPersistence(p)})()}signInAndRetrieveDataWithCredential(a){return this.signInWithCredential(a)}signInAnonymously(){return Ft(this._delegate,function Ms(c){return Vi.apply(this,arguments)}(this._delegate))}signInWithCredential(a){return Ft(this._delegate,Sr(this._delegate,a))}signInWithCustomToken(a){return Ft(this._delegate,function Qu(c,o){return Us.apply(this,arguments)}(this._delegate,a))}signInWithEmailAndPassword(a,h){return Ft(this._delegate,function Jl(c,o,a){return Sr((0,g.m9)(c),Os.credential(o,a))}(this._delegate,a,h))}signInWithEmailLink(a,h){return Ft(this._delegate,function eh(c,o,a){return _a.apply(this,arguments)}(this._delegate,a,h))}signInWithPhoneNumber(a,h){return iu(this._delegate,function Zn(c,o,a){return Ma.apply(this,arguments)}(this._delegate,a,h))}signInWithPopup(a){var h=this;return(0,v.Z)(function*(){return ns(Ii(),h._delegate,"operation-not-supported-in-this-environment"),Ft(h._delegate,function qn(c,o,a){return Je.apply(this,arguments)}(h._delegate,a,Rn))})()}signInWithRedirect(a){var h=this;return(0,v.Z)(function*(){return ns(Ii(),h._delegate,"operation-not-supported-in-this-environment"),yield sr(h._delegate),function wc(c,o,a){return function Ec(c,o,a){return Hi.apply(this,arguments)}(c,o,a)}(h._delegate,a,Rn)})()}updateCurrentUser(a){return this._delegate.updateCurrentUser(a)}verifyPasswordResetCode(a){return function ga(c,o){return Vs.apply(this,arguments)}(this._delegate,a)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return c.Persistence=Gt,c})();function ko(c,o,a){let h=c;"function"!=typeof c&&({next:h,error:o,complete:a}=c);const p=h;return{next:A=>p(A&&vn.getOrCreate(A)),error:o,complete:a}}function Qc(c,o){const a=function es(c,o){const a=ts();if(!a)return[];const h=An(Ae,c,o);switch(a.getItem(h)){case Gt.NONE:return[Nn];case Gt.LOCAL:return[fn,Un];case Gt.SESSION:return[Un];default:return[]}}(c,o);if("undefined"!=typeof self&&!a.includes(fn)&&a.push(fn),"undefined"!=typeof window)for(const h of[Xt,Un])a.includes(h)||a.push(h);return a.includes(Nn)||a.push(Nn),a}class wi{constructor(){this.providerId="phone",this._delegate=new zi(nu(N.Z.auth()))}static credential(o,a){return zi.credential(o,a)}verifyPhoneNumber(o,a){return this._delegate.verifyPhoneNumber(o,a)}unwrap(){return this._delegate}}wi.PHONE_SIGN_IN_METHOD=zi.PHONE_SIGN_IN_METHOD,wi.PROVIDER_ID=zi.PROVIDER_ID;const In=T;class su{constructor(o,a,h=N.Z.app()){var p;In(null===(p=h.options)||void 0===p?void 0:p.apiKey,"invalid-api-key",{appName:h.name}),this._delegate=new tn(o,a,h.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function is(c){c.INTERNAL.registerComponent(new Ie.wA("auth-compat",o=>{const a=o.getProvider("app-compat").getImmediate(),h=o.getProvider("auth");return new st(a,h)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"}},EmailAuthProvider:Os,FacebookAuthProvider:sa,GithubAuthProvider:Ui,GoogleAuthProvider:xr,OAuthProvider:cn,SAMLAuthProvider:Ns,PhoneAuthProvider:wi,PhoneMultiFactorGenerator:$a,RecaptchaVerifier:su,TwitterAuthProvider:oa,Auth:st,AuthCredential:Ri,Error:g.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),c.registerVersion("@firebase/auth-compat","0.3.0")}(N.Z)}}]);